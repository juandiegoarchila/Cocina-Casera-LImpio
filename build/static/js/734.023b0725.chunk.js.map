{"version":3,"file":"static/js/734.023b0725.chunk.js","mappings":"qIAIA,MAAMA,EAASC,IACb,MAAMC,EAAIC,KAAKC,MAAMC,OAAOJ,GAAK,IACjC,OAAOI,OAAOC,SAASJ,GAAKA,EAAI,GAG5BK,EAAWC,IAAOA,GAAK,IAAIC,WAAWC,OAAOC,cAE7CC,EAAsBC,IAC1B,GAAIC,MAAMC,QAAQF,IAAmBA,EAAeG,OAAQ,CAC1D,MAAMC,EAAQJ,EACXK,IAAKC,GAAoB,kBAANA,EAAiBA,GAAM,OAADA,QAAC,IAADA,OAAC,EAADA,EAAGC,QAAS,OAADD,QAAC,IAADA,OAAC,EAADA,EAAGE,QAAS,IAChEC,OAAOC,SACV,OAAOT,MAAMU,KAAK,IAAIC,IAAIR,GAC5B,CACA,MAAO,CAAC,WAAY,QAAS,cAGhB,SAASS,EAAkBC,GAOtC,IAPuC,MACzCC,EAAQ,QAAO,MACfC,EAAQ,EAAC,MACTC,EAAQ,GAAE,SACVC,EAAQ,eACRlB,EAAiB,GAAE,SACnBmB,GAAW,GACZL,EACC,MAAMM,GAAUC,EAAAA,EAAAA,SAAQ,IAAMtB,EAAmBC,GAAiB,CAACA,KAE5DsB,EAAMC,IAAWC,EAAAA,EAAAA,UAAS,KAC/B,MAAMC,EAAYxB,MAAMC,QAAQe,GAASA,EAAQ,GACjD,OAAIQ,EAAUtB,OACLsB,EAAUpB,IAAKqB,IAAC,IAAAC,EAAA,MAAM,CAC3BC,OAA4B,kBAAbF,EAAEE,OAAsBF,EAAEE,QAAW,OAADF,QAAC,IAADA,GAAS,QAARC,EAADD,EAAGE,cAAM,IAAAD,OAAR,EAADA,EAAWpB,OAAQ,GACtEsB,OAAQ1C,EAAMuC,EAAEG,QAChBC,KAAMJ,EAAEI,MAAQ,MAGb,CAAC,CAAEF,OAAQ,WAAYC,OAAQ1C,EAAM6B,GAAQc,KAAM,QAG5DC,EAAAA,EAAAA,WAAU,KACR,MAAMN,EAAYxB,MAAMC,QAAQe,GAASA,EAAQ,GAC7CQ,EAAUtB,QACZoB,EACEE,EAAUpB,IAAKqB,IAAC,IAAAM,EAAA,MAAM,CACpBJ,OAA4B,kBAAbF,EAAEE,OAAsBF,EAAEE,QAAW,OAADF,QAAC,IAADA,GAAS,QAARM,EAADN,EAAGE,cAAM,IAAAI,OAAR,EAADA,EAAWzB,OAAQ,GACtEsB,OAAQ1C,EAAMuC,EAAEG,QAChBC,KAAMJ,EAAEI,MAAQ,QAIrB,CAACb,IAEJ,MAAMgB,EAAMX,EAAKY,OAAO,CAACC,EAAKT,IAAMS,EAAMhD,EAAMuC,EAAEG,QAAS,GACrDO,EAAOjD,EAAM6B,GAASiB,EACtBI,EAAc,IAATD,EAELE,EAAQC,IACZhB,EAAQgB,GACRrB,GACEA,EACEqB,EAAKlC,IAAKqB,IAAC,CACTE,OAAQF,EAAEE,OACVC,OAAQ1C,EAAMuC,EAAEG,QAChBC,KAAMJ,EAAEI,MAAQ,QAKlBU,EAAeA,CAACC,EAAKC,EAAKC,KAC9B,MAAMJ,EAAOjB,EAAKjB,IAAI,CAACqB,EAAGkB,IAAOA,IAAMH,EAAM,IAAKf,EAAG,CAACgB,GAAc,WAARA,EAAmBvD,EAAMwD,GAAOA,GAAQjB,GACpGY,EAAKC,IAuCP,OACEM,EAAAA,EAAAA,MAAA,OAAKC,WAAWC,EAAAA,EAAAA,GAAW,wBAAmC,SAAVhC,EAAmB,8BAAgC,8BAA8BiC,SAAA,EACnIH,EAAAA,EAAAA,MAAA,OAAKC,UAAU,yDAAwDE,SAAA,EACrEC,EAAAA,EAAAA,KAAA,MAAIH,UAAU,wBAAuBE,SAAC,kBACtCH,EAAAA,EAAAA,MAAA,OAAKC,UAAU,uBAAsBE,SAAA,EACnCC,EAAAA,EAAAA,KAAA,UAAQC,KAAK,SAAS/B,SAAUA,EAAUgC,QA9BjCC,KACf,GAAIhC,EAAQjB,OAAS,EAAG,OACxB,MAAMkD,EAAO/D,KAAKC,MAAMJ,EAAM6B,GAAS,GACjCsC,EAAOnE,EAAM6B,GAASqC,EAC5Bf,EAAK,CACH,CAAEV,OAAQR,EAAQ,GAAIS,OAAQwB,EAAMvB,KAAM,IAC1C,CAAEF,OAAQR,EAAQ,GAAIS,OAAQyB,EAAMxB,KAAM,OAyBpCgB,WAAWC,EAAAA,EAAAA,GAAW,mCAA4C,SAARhC,EAAe,oCAAoC,kCAAkCiC,SAAC,aAGlJC,EAAAA,EAAAA,KAAA,UAAQC,KAAK,SAAS/B,SAAUA,EAAUgC,QAxBnCI,KACb,MAAMC,EAAIlE,KAAKC,MAAMJ,EAAM6B,GAAS,GAC9ByC,EAAInE,KAAKC,OAAOJ,EAAM6B,GAASwC,GAAK,GACpCE,EAAIvE,EAAM6B,GAASwC,EAAIC,EAC7BnB,EAAK,CACH,CAAEV,OAAQR,EAAQ,IAAM,WAAYS,OAAQ2B,EAAG1B,KAAM,IACrD,CAAEF,OAAQR,EAAQ,IAAM,QAASS,OAAQ4B,EAAG3B,KAAM,IAClD,CAAEF,OAAQR,EAAQ,IAAM,YAAaS,OAAQ6B,EAAG5B,KAAM,OAkBhDgB,WAAWC,EAAAA,EAAAA,GAAW,mCAA4C,SAARhC,EAAe,oCAAoC,kCAAkCiC,SAAC,iBAGjJ5B,EAAQf,IAAKC,IACZuC,EAAAA,EAAAA,MAAA,UAAgBK,KAAK,SAAS/B,SAAUA,EAAUgC,QAASA,IAlBnD7C,KAChBgC,EAAK,CAAC,CAAEV,OAAQtB,EAAGuB,OAAQ1C,EAAM6B,GAAQc,KAAM,OAiB0B6B,CAASrD,GACxEwC,WAAWC,EAAAA,EAAAA,GAAW,mCAA4C,SAARhC,EAAe,oCAAoC,kCAAkCiC,SAAA,CAAC,QAC1I1C,IAFKA,WAQnB2C,EAAAA,EAAAA,KAAA,OAAKH,UAAU,YAAWE,SACvB1B,EAAKjB,IAAI,CAACqB,EAAGe,KACZI,EAAAA,EAAAA,MAAA,OAAeC,UAAU,sDAAqDE,SAAA,EAC5EC,EAAAA,EAAAA,KAAA,UACE9B,SAAUA,EACVF,MAAOS,EAAEE,OACTV,SAAW0C,GAAMpB,EAAaC,EAAK,SAAUmB,EAAEC,OAAO5C,OACtD6B,WAAWC,EAAAA,EAAAA,GAAW,2CAAoD,SAARhC,EAAe,yCAAyC,4BAA4BiC,SAErJ5B,EAAQf,IAAKC,IACZ2C,EAAAA,EAAAA,KAAA,UAAgBhC,MAAOX,EAAE0C,SAAE1C,GAAdA,OAIjB2C,EAAAA,EAAAA,KAAA,SACE9B,SAAUA,EACV+B,KAAK,SACLY,IAAI,IACJC,KAAK,IACL9C,MAAOS,EAAEG,OACTX,SAAW0C,GAAMpB,EAAaC,EAAK,SAAUmB,EAAEC,OAAO5C,OACtD6B,WAAWC,EAAAA,EAAAA,GAAW,2CAAoD,SAARhC,EAAe,yCAAyC,4BAC1HiD,YAAY,kBAGdf,EAAAA,EAAAA,KAAA,SACE9B,SAAUA,EACV+B,KAAK,OACLjC,MAAOS,EAAEI,MAAQ,GACjBZ,SAAW0C,GAAMpB,EAAaC,EAAK,OAAQmB,EAAEC,OAAO5C,OACpD6B,WAAWC,EAAAA,EAAAA,GAAW,2CAAoD,SAARhC,EAAe,yCAAyC,4BAC1HiD,YAAY,qBAGdf,EAAAA,EAAAA,KAAA,OAAKH,UAAU,iCAAgCE,UAC7CC,EAAAA,EAAAA,KAAA,UAAQC,KAAK,SAAS/B,SAAUA,EAAUgC,QAASA,IAvF5CV,KACjB,MAAMF,EAAOjB,EAAKb,OAAO,CAACwD,EAAGrB,IAAMA,IAAMH,GACzCH,EAAKC,EAAKpC,OAASoC,EAAO,CAAC,CAAEX,OAAQ,WAAYC,OAAQ1C,EAAM6B,GAAQc,KAAM,OAqFVoC,CAAUzB,GACjEK,WAAWC,EAAAA,EAAAA,GAAW,mCAA4C,SAARhC,EAAe,oCAAoC,kCAAkCiC,SAAC,eAlC5IP,OA0CdI,EAAAA,EAAAA,MAAA,OAAKC,UAAU,iDAAgDE,SAAA,EAC7DC,EAAAA,EAAAA,KAAA,UAAQC,KAAK,SAAS/B,SAAUA,EAAUgC,QAvGjCgB,KACb,MAAMC,EAAShD,EAAQiD,KAAM/D,IAAOgB,EAAKgD,KAAM5C,GAAMhC,EAAQgC,EAAEE,UAAYlC,EAAQY,MAAQc,EAAQ,GAC7FmB,EAAO,IAAIjB,EAAM,CAAEM,OAAQwC,EAAQvC,OAAQvC,KAAKiF,IAAI,EAAGnC,GAAON,KAAM,KAC1EQ,EAAKC,IAqGCO,WAAWC,EAAAA,EAAAA,GAAW,2BAAoC,SAARhC,EAAe,oCAAoC,kCAAkCiC,SAAC,0BAI1IH,EAAAA,EAAAA,MAAA,OAAKC,UAAU,0BAAyBE,SAAA,EACtCC,EAAAA,EAAAA,KAAA,QAAAD,SAAM,mBACNH,EAAAA,EAAAA,MAAA,UAAAG,SAAA,CAAQ,IAAE7D,EAAM6B,GAAOwD,eAAe,mBAI1CvB,EAAAA,EAAAA,KAAA,OAAKH,UAAU,OAAME,SAClBX,GACCY,EAAAA,EAAAA,KAAA,QAAMH,WAAWC,EAAAA,EAAAA,GAAW,yCAAkD,SAARhC,EAAe,0BAA0B,+BAA+BiC,SAAC,uBAG7IZ,EAAO,GACTS,EAAAA,EAAAA,MAAA,QAAMC,WAAWC,EAAAA,EAAAA,GAAW,yCAAkD,SAARhC,EAAe,2BAA2B,iCAAiCiC,SAAA,CAAC,kBAChIZ,EAAKoC,eAAe,aAGtC3B,EAAAA,EAAAA,MAAA,QAAMC,WAAWC,EAAAA,EAAAA,GAAW,yCAAkD,SAARhC,EAAe,wBAAwB,2BAA2BiC,SAAA,CAAC,WAC9H1D,KAAKmF,IAAIrC,GAAMoC,eAAe,gBAMnD,C,8DC7MA,MAAME,EAAQ/E,IAAQ,OAADA,QAAC,IAADA,EAAAA,EAAK,IAAIC,WAAWC,OAAOC,cAEnC6E,EAA6BC,IACxC,MAAMC,EACkB,kBAAfD,EACHA,GACU,OAAVA,QAAU,IAAVA,OAAU,EAAVA,EAAYrE,QAAkB,OAAVqE,QAAU,IAAVA,OAAU,EAAVA,EAAYpE,SAAmB,OAAVoE,QAAU,IAAVA,OAAU,EAAVA,EAAYE,SAAmB,OAAVF,QAAU,IAAVA,OAAU,EAAVA,EAAYhD,UAAoB,OAAVgD,QAAU,IAAVA,OAAU,EAAVA,EAAY1B,QAAkB,OAAV0B,QAAU,IAAVA,OAAU,EAAVA,EAAYG,UAAW,GAC/HC,EAAIN,EAAKG,GACf,OAAIG,EAAEC,SAAS,UAAYD,EAAEC,SAAS,QAAgB,OAClDD,EAAEC,SAAS,SAAiB,QAC5BD,EAAEC,SAAS,QAAgB,YACxB,SAGHC,EAAmBN,GACG,kBAAfA,EAAgCA,GAE/B,OAAVA,QAAU,IAAVA,OAAU,EAAVA,EAAYrE,QACF,OAAVqE,QAAU,IAAVA,OAAU,EAAVA,EAAYpE,SACF,OAAVoE,QAAU,IAAVA,OAAU,EAAVA,EAAYE,SACF,OAAVF,QAAU,IAAVA,OAAU,EAAVA,EAAYhD,UACF,OAAVgD,QAAU,IAAVA,OAAU,EAAVA,EAAY1B,QACF,OAAV0B,QAAU,IAAVA,OAAU,EAAVA,EAAYG,UACZ,OAUSI,EAAwBC,IAAW,IAADC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAC7C,MAAM/E,EAAQ1B,KAAKC,MAAMC,QAAY,OAAL4F,QAAK,IAALA,OAAK,EAALA,EAAOpE,QAAS,KAAO,EAEvD,GAAIf,MAAMC,QAAa,OAALkF,QAAK,IAALA,OAAK,EAALA,EAAOY,WAAaZ,EAAMY,SAAS7F,OACnD,OAAOiF,EAAMY,SAAS3F,IAAK4F,IACzB,MAAMpE,EAASvC,KAAKC,MAAMC,QAAQ,OAADyG,QAAC,IAADA,OAAC,EAADA,EAAGpE,SAAU,KAAO,EACrD,MAAO,CACLqE,UAAWvB,EAA2B,OAADsB,QAAC,IAADA,OAAC,EAADA,EAAGrE,QACxCC,SACAsE,SAAUjB,EAAiB,OAADe,QAAC,IAADA,OAAC,EAADA,EAAGrE,WAKnC,MAAMwE,EAAgB,CACY,QADZf,EACf,OAALD,QAAK,IAALA,GAAY,QAAPE,EAALF,EAAOiB,aAAK,IAAAf,GAAK,QAALC,EAAZD,EAAe,UAAE,IAAAC,OAAZ,EAALA,EAAmBe,qBAAa,IAAAjB,EAAAA,EAAS,OAALD,QAAK,IAALA,GAAY,QAAPI,EAALJ,EAAOiB,aAAK,IAAAb,GAAK,QAALC,EAAZD,EAAe,UAAE,IAAAC,OAAZ,EAALA,EAAmBV,QACxB,QAD+BW,EACzD,OAALN,QAAK,IAALA,GAAiB,QAAZO,EAALP,EAAOmB,kBAAU,IAAAZ,GAAK,QAALC,EAAjBD,EAAoB,UAAE,IAAAC,OAAjB,EAALA,EAAwBb,eAAO,IAAAW,EAAAA,EAAS,OAALN,QAAK,IAALA,GAAiB,QAAZS,EAALT,EAAOmB,kBAAU,IAAAV,GAAK,QAALC,EAAjBD,EAAoB,UAAE,IAAAC,OAAjB,EAALA,EAAwBQ,cACvC,QADoDP,EACnE,OAALX,QAAK,IAALA,OAAK,EAALA,EAAOkB,qBAAa,IAAAP,EAAAA,EAAS,OAALX,QAAK,IAALA,OAAK,EAALA,EAAOL,SAC/BtE,OAAOC,SAET,GAAI0F,EAAcjG,OAAQ,CACxB,MAAMK,EAAQ0E,EAAgBkB,EAAc,IAC5C,MAAO,CACL,CACEF,UAAWvB,EAA0ByB,EAAc,IACnDvE,OAAQb,EACRmF,SAAU3F,GAGhB,CAEA,MAAO,CAAC,CAAE0F,UAAW,QAASrE,OAAQb,EAAOmF,SAAU,UAI5CK,EAAoB,WAAwB,IAAvBC,EAAYC,UAAAvG,OAAA,QAAAwG,IAAAD,UAAA,GAAAA,UAAA,GAAG,GAC/C,IAAKzG,MAAMC,QAAQuG,KAAkBA,EAAatG,OAAQ,MAAO,WACjE,MAAMyG,EAAMH,EAAavE,OAAO,CAACsB,EAAG9B,KAClC,MAAMgB,EAAMhB,EAAEwE,WAAavB,EAA2B,OAADjD,QAAC,IAADA,OAAC,EAADA,EAAGE,QAExD,OADA4B,EAAEd,IAAQc,EAAEd,IAAQ,IAAMpD,KAAKC,MAAMC,OAAOkC,EAAEG,QAAU,KAAO,GACxD2B,GACN,CAAC,GACEqD,EAAS,GAKf,OAJID,EAAIE,MAAMD,EAAOE,KAAK,aAAaH,EAAIE,KAAKtC,eAAe,YAC3DoC,EAAII,OAAOH,EAAOE,KAAK,UAAUH,EAAII,MAAMxC,eAAe,YAC1DoC,EAAIK,WAAWJ,EAAOE,KAAK,cAAcH,EAAIK,UAAUzC,eAAe,YACtEoC,EAAIM,QAAUL,EAAO1G,QAAQ0G,EAAOE,KAAK,SAASH,EAAIM,MAAM1C,eAAe,YACxEqC,EAAOM,KAAK,QAAU,UAC/B,EAQaC,EAA2BhC,IACtC,MAAM9D,EAAO6D,EAAqBC,GAClC,GAAQ,OAAJ9D,QAAI,IAAJA,GAAAA,EAAMnB,OAAQ,OAAOmB,EAAKjB,IAAIS,IAAA,IAAC,UAAEoF,EAAS,OAAErE,GAAQf,EAAA,MAAM,CAAEc,OAAQsE,EAAWrE,YAEnF,MAAO,CAAC,CAAED,OAAQ,OAAQC,OADZvC,KAAKC,MAAMC,QAAY,OAAL4F,QAAK,IAALA,OAAK,EAALA,EAAOpE,QAAS,KAAO,KAQ5CqG,EAAsB,WAAkB,IAAjBC,EAAMZ,UAAAvG,OAAA,QAAAwG,IAAAD,UAAA,GAAAA,UAAA,GAAG,GAC3C,MAAMa,EAAM,CAAET,KAAM,EAAGE,MAAO,EAAGC,UAAW,EAAGC,MAAO,EAAGlG,MAAO,GAChE,IAAK,MAAMoE,KAASkC,EAAQ,CAC1B,MAAMhG,EAAO6D,EAAqBC,GAClC,IAAK,MAAM1D,KAAKJ,EAAM,CACpB,MAAMkG,EAAMlI,KAAKC,MAAMC,OAAOkC,EAAEG,QAAU,KAAO,EACjD0F,EAAI7F,EAAEwE,YAAcqB,EAAI7F,EAAEwE,YAAc,GAAKsB,EAC7CD,EAAIvG,OAASwG,CACf,CACF,CACA,OAAOD,CACT,EA4BaE,EAAgBrC,IAAW,IAADsC,EAAAC,EAGrC,KAFyB,OAALvC,QAAK,IAALA,OAAK,EAALA,EAAOwC,eAAgB,IAAI9H,cAEhCmF,SAAS,SAAU,OAAO,EAGzC,MAAMD,EAAIN,GAAU,OAALU,QAAK,IAALA,OAAK,EAALA,EAAOyC,aAAkB,OAALzC,QAAK,IAALA,GAAiB,QAAZsC,EAALtC,EAAOmB,kBAAU,IAAAmB,GAAK,QAALC,EAAjBD,EAAoB,UAAE,IAAAC,OAAjB,EAALA,EAAwBE,YAAa,IACxE,SAAI5H,MAAMC,QAAa,OAALkF,QAAK,IAALA,OAAK,EAALA,EAAOmB,eAAgBvB,EAAEC,SAAS,UAAYD,EAAEC,SAAS,aAAeD,EAAEC,SAAS,gBAAkBD,EAAEC,SAAS,aASvH6C,EAAiB1C,IAAW,IAAD2C,EACtC,QAAS,OAAL3C,QAAK,IAALA,GAAiB,QAAZ2C,EAAL3C,EAAO4C,kBAAU,IAAAD,IAAjBA,EAAmBE,QAA4C,eAAlCvD,EAAKU,EAAM4C,WAAWC,YAC7B,KAAjB,OAAL7C,QAAK,IAALA,OAAK,EAALA,EAAO8C,eACgB,KAAlB,OAAL9C,QAAK,IAALA,OAAK,EAALA,EAAO+C,gBACF,OAAL/C,QAAK,IAALA,IAAAA,EAAOgD,cAKAC,EAAsB,WAA0D,IAA5CC,EAAW5B,UAAAvG,OAAA,QAAAwG,IAAAD,UAAA,GAAAA,UAAA,GAAG,GAAI6B,EAAe7B,UAAAvG,OAAA,QAAAwG,IAAAD,UAAA,GAAAA,UAAA,GAAG,GACnF,MAAMvE,EAAM,CACVqG,WAAY,EACZC,eAAgB,EAChBC,UAAW,EACXC,oBAAqB,EACrBC,sBAAuB,GAGnBC,EAAa,WAAgB,IAAfC,EAAIpC,UAAAvG,OAAA,QAAAwG,IAAAD,UAAA,GAAAA,UAAA,GAAG,GACzB,IAAK,MAAMqC,KAAKD,EAAM,CACpB,MAAMxH,EAAO6D,EAAqB4D,GAClC,IAAIjC,EAAO,EAAGE,EAAQ,EAAGgC,EAAO,EAChC,IAAK,MAAMtH,KAAKJ,EAAM,CACpB,MAAMkG,EAAMlI,KAAKC,MAAMC,QAAQ,OAADkC,QAAC,IAADA,OAAC,EAADA,EAAGG,SAAU,KAAO,EAC9B,SAAhBH,EAAEwE,UAAsBY,GAAQU,EACX,UAAhB9F,EAAEwE,UAAuBc,GAASQ,EAClB,cAAhB9F,EAAEwE,YAA2B8C,GAAQxB,EAChD,CACArF,EAAIqG,YAAcxB,EAClB7E,EAAIsG,gBAAkBO,EAElBlC,EAAO,IACLW,EAAasB,GAAI5G,EAAIuG,WAAa5B,EAC7BgB,EAAciB,GAAI5G,EAAIwG,qBAAuB7B,EACjD3E,EAAIyG,uBAAyB9B,EAEtC,CACF,EAMA,OAJA+B,EA9BwCnC,UAAAvG,OAAA,QAAAwG,IAAAD,UAAA,GAAAA,UAAA,GAAG,IA+B3CmC,EAAWP,GACXO,EAAWN,GAEJ,IAAKpG,EAAK8G,SAAU9G,EAAIuG,UAAYvG,EAAIwG,oBACjD,C,oGCvMO,MAAMO,EAAgBC,MAAO7B,EAAQ8B,EAAQC,EAAiBC,EAAmBC,KACtF,IAAK,IAADC,EAAAC,EAAAC,EAAAC,EACF,MAAMC,EAAW,IAAIC,IAAAA,UACfC,EAAYF,EAASG,aAAa,yBAElCC,EAAaC,GACL,MAARA,QAAyBtD,IAATsD,EAA2B,GAC3B,kBAATA,EAA0BA,EAAKC,QAAQ,SAAU,IAAIrK,OAC5C,mBAAToK,EAA2BA,EAAKrK,WACvB,kBAATqK,GAA8B,OAATA,GAAiB,SAAUA,GAA6B,kBAAdA,EAAK1J,KACtE0J,EAAK1J,KAAK2J,QAAQ,SAAU,IAAIrK,OAElCsK,OAAOF,GAAMC,QAAQ,SAAU,IAAIrK,OAGtCuK,EAAmBC,IACvBA,EAAKC,OAAS,CACZC,IAAK,CAAEC,MAAO,OAAQC,MAAO,CAAEC,KAAM,aACrCC,KAAM,CAAEH,MAAO,OAAQC,MAAO,CAAEC,KAAM,aACtCE,OAAQ,CAAEJ,MAAO,OAAQC,MAAO,CAAEC,KAAM,aACxCG,MAAO,CAAEL,MAAO,OAAQC,MAAO,CAAEC,KAAM,eAK3CZ,EAAU3F,OAAO,CAAC,GAAI,4BACtB,MAAM2G,EAAmBhB,EAAUiB,QAAQC,OAC3ClB,EAAUmB,WAAWH,EAAkB,EAAGA,EAAkB,GAC5D,MAAMI,EAAYpB,EAAUqB,QAAQ,IAAIL,KACxCI,EAAUE,KAAO,CAAEC,MAAM,EAAMZ,MAAO,CAAEC,KAAM,aAC9CQ,EAAUI,KAAO,CAAEpI,KAAM,UAAWqI,QAAS,QAASC,QAAS,CAAEd,KAAM,aACvEQ,EAAUO,UAAY,CAAEC,WAAY,UAEpC5B,EAAU6B,OAAOb,EAAmB,GAAGc,OAAS,CAAC,GAAI,cAAY,WAAY,GAAI,IACtD9B,EAAU6B,OAAOb,EAAmB,GAC5Ce,SAAS,CAACxB,EAAMyB,KACf,IAAdA,GAAiC,IAAdA,IACrBzB,EAAKiB,KAAO,CAAEpI,KAAM,UAAWqI,QAAS,QAASC,QAAS,CAAEd,KAAM,aAClEL,EAAKe,KAAO,CAAEX,MAAO,CAAEC,KAAM,YAAcW,MAAM,GACjDhB,EAAKoB,UAAY,CAAEC,WAAY,UAC/BtB,EAAgBC,IAEA,IAAdyB,GAAiC,IAAdA,IACrBzB,EAAKpJ,MAAQ,MAIjB,MAAM8K,EAAkC,IAApBxC,EAASpJ,OACzB,CAAC,CAAEI,KAAM,IAAKyL,SAAU,IAAKC,MAAO,GAAIC,WAAY,KACpD,IACK3C,EAAS4C,MAAM,GAAI,GACtB,CACE5L,MAAmC,QAA7BiJ,EAAAD,EAASA,EAASpJ,OAAS,UAAE,IAAAqJ,OAAA,EAA7BA,EAA+BjJ,OAAQ,IAC7CyL,UAAuC,QAA7BvC,EAAAF,EAASA,EAASpJ,OAAS,UAAE,IAAAsJ,OAAA,EAA7BA,EAA+BuC,WAAY,IACrDC,MAAO,sBACPC,WAAY5C,EAAkB9E,eAAe,UAE/C,CACEjE,MAAmC,QAA7BmJ,EAAAH,EAASA,EAASpJ,OAAS,UAAE,IAAAuJ,OAAA,EAA7BA,EAA+BnJ,OAAQ,IAC7CyL,UAAuC,QAA7BrC,EAAAJ,EAASA,EAASpJ,OAAS,UAAE,IAAAwJ,OAAA,EAA7BA,EAA+BqC,WAAY,IACrDC,MAAO,gBACPC,WAAY,GAAG/B,QAAO,IAAIiC,MAAOC,WAAWC,SAAS,EAAG,QAAQnC,QAAO,IAAIiC,MAAOG,WAAa,GAAGD,SAAS,EAAG,SAAQ,IAAIF,MAAOI,kBAIzIT,EAAYU,QAAQ,CAACC,EAASC,KAChB7C,EAAU3F,OAAO,CAAC,GAAI6F,EAAU0C,EAAQnM,MAAOmM,EAAQV,SAAUU,EAAQT,MAAOS,EAAQR,aAChGL,SAAS,CAACxB,EAAMyB,KACdA,GAAa,KACXa,GAASZ,EAAY5L,OAAS,GAAmB,IAAd2L,GAAiC,IAAdA,IACxD1B,EAAgBC,GAEA,IAAdyB,IACFzB,EAAKuC,OAAS,QACdvC,EAAKoB,UAAY,CAAEC,WAAY,UAEf,IAAdI,IAAiBzB,EAAKoB,UAAY,CAAEC,WAAY,SAClC,IAAdI,IAAiBzB,EAAKoB,UAAY,CAAEC,WAAY,eAK1D5B,EAAU3F,OAAO,CAAC,GAClB2F,EAAU3F,OAAO,CAAC,GAGlB,IAAI0I,EAAc,EAClB,MAAMC,EAAUxF,EAAOjH,IAAI,CAAC+E,EAAOuH,KAAW,IAADrH,EAAAyH,EAAAC,EAAAC,EAC3CJ,GAAe,EACf,MAAMK,GAAkB,QAAX5H,EAAAF,EAAMiB,aAAK,IAAAf,OAAA,EAAXA,EAAc,KAAM,CAAC,EAC5B6H,EAAe/H,EAAML,SAAoC,kBAAjBmI,EAAKnI,UAAoC,QAAhBgI,EAAIG,EAAKnI,eAAO,IAAAgI,OAAA,EAAZA,EAAcxM,OAAS2M,EAAKnI,SAAW,WAIlH,OAHKoI,IAAyC,kBAAjBA,GAA+B,SAAUA,IACpEC,QAAQC,KAAK,iCAAiCjI,EAAMkI,IAAMX,KAAU,CAAEvH,QAAO+H,iBAExE,CACLI,EAAGV,EACHW,eAAWxD,EAAsB,QAAbgD,EAACE,EAAKO,eAAO,IAAAT,OAAA,EAAZA,EAAcS,SACnCC,cAAU1D,EAAsB,QAAbiD,EAACC,EAAKO,eAAO,IAAAR,OAAA,EAAZA,EAAcU,aAClCC,MAAOxI,EAAMpE,OAAS,EACtB6M,kBAAc7D,EAAUmD,GACxBW,aAAc9D,EAAU5E,EAAM2I,gBAAkB,kBAI7B,IAAnBjB,EAAQ3M,QACV2M,EAAQ/F,KAAK,CAAEwG,EAAG,IAAKC,eAAW,IAAKE,cAAU,IAAKE,MAAO,IAAKC,kBAAc,IAAKC,aAAc,MAGrGhE,EAAUkE,QAAU,CAClB,CAAEtL,IAAK,IAAKuL,MAAO,IACnB,CAAEvL,IAAK,eAAauL,MAAO,IAC3B,CAAEvL,IAAK,cAAYuL,MAAO,IAC1B,CAAEvL,IAAK,QAASuL,MAAO,IACvB,CAAEvL,IAAK,kBAAgBuL,MAAO,IAC9B,CAAEvL,IAAK,eAAgBuL,MAAO,KAGhC,MAAMC,EAAmBnC,EAAY5L,OAAS,EACxCgO,EAAYrE,EAAU6B,OAAOuC,GACnCC,EAAUvC,OAAS,CAAC,IAAK,eAAa,cAAY,QAAS,oBAAkB,gBAC7EuC,EAAUtC,SAASxB,IACjBA,EAAKiB,KAAO,CAAEpI,KAAM,UAAWqI,QAAS,QAASC,QAAS,CAAEd,KAAM,aAClEL,EAAKe,KAAO,CAAEX,MAAO,CAAEC,KAAM,YAAcW,MAAM,GACjDhB,EAAKoB,UAAY,CAAEC,WAAY,UAC/BtB,EAAgBC,KAGlByC,EAAQL,QAAQ2B,IACFtE,EAAU3F,OAAOiK,GACzBvC,SAASxB,GAAQD,EAAgBC,MAGvCP,EAAU3F,OAAO,CAAC,GAClB2F,EAAU3F,OAAO,CAAC,GAGlB2F,EAAU3F,OAAO,IACjB,MAAMkK,EAAavE,EAAUiB,QAAQC,OACrClB,EAAUqB,QAAQ,IAAIkD,KAAcpN,MAAQ,qBAC5C6I,EAAUmB,WAAW,IAAIoD,MAAeA,KACxC,MAAMC,EAAcxE,EAAUqB,QAAQ,IAAIkD,KAC1CC,EAAYlD,KAAO,CAAEC,MAAM,EAAMZ,MAAO,CAAEC,KAAM,aAChD4D,EAAYhD,KAAO,CAAEpI,KAAM,UAAWqI,QAAS,QAASC,QAAS,CAAEd,KAAM,aACzE4D,EAAY7C,UAAY,CAAEC,WAAY,UACtCtB,EAAgBkE,GAChBlE,EAAgBN,EAAUqB,QAAQ,IAAIkD,MAElB,CAClB,CAAC,iBAAkBjF,EAAOtC,MAAQ,GAClC,CAAC,kBAAmBsC,EAAOnC,WAAa,GACxC,CAAC,cAAemC,EAAOpC,OAAS,GAChC,CAAC,iBAAkBoC,EAAOtC,MAAQ,IAAMsC,EAAOnC,WAAa,IAAMmC,EAAOpC,OAAS,KAGxEyF,QAAQ3L,IAAqB,IAAnBN,EAAOS,GAAMH,EACjC,MAAMyN,EAAMzE,EAAU3F,OAAO,CAAC,GAAI,GAAI3D,EAAOS,IAC7CsN,EAAIpD,QAAQ,GAAGM,UAAY,CAAEC,WAAY,QACzC6C,EAAIpD,QAAQ,GAAGM,UAAY,CAAEC,WAAY,SACzC6C,EAAIpD,QAAQ,GAAGyB,OAAS,SACxB2B,EAAIpD,QAAQ,GAAGC,KAAO,CAAEC,MAAM,GAC9BjB,EAAgBmE,EAAIpD,QAAQ,IAC5Bf,EAAgBmE,EAAIpD,QAAQ,MAG9BrB,EAAU3F,OAAO,CAAC,GAClB2F,EAAU3F,OAAO,CAAC,GAGlB2F,EAAU3F,OAAO,CAAC,GAAI,8BACtB,MAAMqK,EAA0B1E,EAAUiB,QAAQC,OAClDlB,EAAUmB,WAAWuD,EAAyB,EAAGA,EAAyB,GAC1E,MAAMC,EAAiB3E,EAAUqB,QAAQ,IAAIqD,KAC7CC,EAAerD,KAAO,CAAEC,MAAM,EAAMZ,MAAO,CAAEC,KAAM,aACnD+D,EAAenD,KAAO,CAAEpI,KAAM,UAAWqI,QAAS,QAASC,QAAS,CAAEd,KAAM,aAC5E+D,EAAehD,UAAY,CAAEC,WAAY,UACzC,IAAK,IAAI9I,EAAI,EAAGA,GAAK,EAAGA,IAAKwH,EAAgBN,EAAUqB,QAAQqD,EAAyB5L,IAExFkH,EAAU3F,OAAO,CAAC,GAAI,eAAgB,WAAY,YAAa,QAAS,UACtD2F,EAAUiB,QAClBc,SAAS,CAACxB,EAAMyB,KACpBA,GAAa,IACfzB,EAAKiB,KAAO,CAAEpI,KAAM,UAAWqI,QAAS,QAASC,QAAS,CAAEd,KAAM,aAClEL,EAAKe,KAAO,CAAEX,MAAO,CAAEC,KAAM,YAAcW,MAAM,GACjDhB,EAAKoB,UAAY,CAAEC,WAAY,UAC/BtB,EAAgBC,MAIpBqE,OAAOC,QAAQtF,GAAiBoD,QAAQmC,IAAmB,IAAjBrO,EAAMsO,GAAKD,EACvC9E,EAAU3F,OAAO,CAC3B,GACA6F,EAAUzJ,GACVsO,EAAK/H,MAAQ,EACb+H,EAAK5H,WAAa,EAClB4H,EAAK7H,OAAS,EACd6H,EAAK7N,OAAS,IAEZ6K,SAAS,CAACxB,EAAMyB,KACdA,GAAa,IACXA,GAAa,IACfzB,EAAKuC,OAAS,SACdvC,EAAKoB,UAAY,CAAEC,WAAY,UAEjCtB,EAAgBC,QAKtB,MAAMyE,QAAelF,EAASmF,KAAKC,cAC7BC,EAAO,IAAIC,KAAK,CAACJ,GAAS,CAAE5L,KAAM,sEAClCiM,EAAOC,SAASC,cAAc,KACpCF,EAAKG,KAAOC,OAAOC,IAAIC,gBAAgBR,GACvCE,EAAKO,SAAW,YAAW,IAAItD,MAAOuD,cAAcxD,MAAM,EAAG,WAC7DiD,SAASQ,KAAKC,YAAYV,GAC1BA,EAAKW,QACLV,SAASQ,KAAKG,YAAYZ,EAC5B,CAAE,MAAOa,GACP5C,QAAQ4C,MAAM,2BAA4BA,GAC1CC,MAAM,sCAAwCD,EAAME,QACtD,G,gCC1NK,MAAMC,EAAchH,eAAO7B,GAA+C,IAAvC8B,EAAM1C,UAAAvG,OAAA,QAAAwG,IAAAD,UAAA,GAAAA,UAAA,GAAG,CAAC,EAAG2C,EAAe3C,UAAAvG,OAAA,QAAAwG,IAAAD,UAAA,GAAAA,UAAA,GAAG,CAAC,EACxE,IAAK,IAAD0J,EAAAC,EAAAC,EACF,MAAMC,EAAM,IAAIC,EAAAA,QAEVC,EAAU,YAChB,IACEF,EAAIG,SAASD,EAAS,MAAO,IAAK,GAAI,GAAI,GAC5C,CAAE,MAAOE,GACPvD,QAAQC,KAAK,yCAA0CsD,EACzD,CAEAJ,EAAIK,YAAY,IAChBL,EAAItG,KAAK,wBAAsB,GAAI,IACnCsG,EAAIK,YAAY,IAChB,MAAMC,EAAM,IAAIzE,KACV0E,EAAUD,EAAIE,mBAAmB,SACjCC,EAAUH,EAAII,mBAAmB,QAAS,CAAEC,KAAM,UAAWC,OAAQ,UAAWC,QAAQ,IAC9Fb,EAAItG,KAAK,UAAU6G,KAAWE,IAAW,GAAI,IAEjD,IAAInE,EAAc,EAClB,MAAMwE,EAAc/J,EAAOjH,IAAK+E,IAAW,IAADE,EAAAgM,EAAAvE,EAAAC,EAAAC,EAAAsE,EACxC1E,GAAe,EACf,MAAMK,GAAkB,QAAX5H,EAAAF,EAAMiB,aAAK,IAAAf,OAAA,EAAXA,EAAc,KAAM,CAAC,EAC5BgB,GAA6B,QAAbgL,EAAAlM,EAAML,eAAO,IAAAuM,OAAA,EAAbA,EAAe/Q,OAAQ6E,EAAML,UAAuB,QAAhBgI,EAAIG,EAAKnI,eAAO,IAAAgI,OAAA,EAAZA,EAAcxM,OAAQ2M,EAAKnI,SAAW,WAEpG,MAAO,CACL8H,GACY,QAAZG,EAAAE,EAAKO,eAAO,IAAAT,OAAA,EAAZA,EAAcS,UAAW,IACb,QAAZR,EAAAC,EAAKO,eAAO,IAAAR,OAAA,EAAZA,EAAcU,cAAe,GAC7B,KAAe,QAAX4D,EAAAnM,EAAMpE,aAAK,IAAAuQ,OAAA,EAAXA,EAAa/M,eAAe,WAAY,MAC5C8B,GACK,OAALlB,QAAK,IAALA,OAAK,EAALA,EAAO2I,iBAAkB,MAIF,IAAvBsD,EAAYlR,QAAckR,EAAYtK,KAAK9G,MAAM,GAAGqL,KAAK,MAG9B,IAAvB+F,EAAYlR,QAAckR,EAAYtK,KAAK9G,MAAM,GAAGqL,KAAK,MAE7DkG,IAAUjB,EAAK,CACbkB,OAAQ,GACRC,KAAM,CAAC,CAAC,IAAK,eAAa,cAAY,QAAS,iBAC/C9B,KAAMyB,EACNM,OAAQ,CAAEC,SAAU,EAAGC,YAAa,EAAGC,SAAU,aACjDC,WAAY,CAAEC,UAAW,CAAC,EAAG,IAAK,KAAMC,UAAW,IAAKC,UAAW,OAAQC,UAAW,GAAKC,UAAW,CAAC,EAAG,EAAG,IAC7GC,mBAAoB,CAAEL,UAAW,CAAC,IAAK,IAAK,MAC5CM,aAAc,CACZ,EAAG,CAAEC,UAAW,QAChB,EAAG,CAAEC,OAAQ,UAEfC,eAAgB,CAAC,EAAG,EAAG,GACvBC,eAAgB,GAChBC,YAAc9D,IACZ0B,EAAIK,YAAY,IAChBL,EAAItG,KAAK,aAAU4E,EAAK+D,aAAc,IAAK,QAI/C,MAAMC,EAAStC,EAAIuC,cAAcD,OAAS,GAC1CtC,EAAIK,YAAY,IAChBL,EAAItG,KAAK,qBAAsB,GAAI4I,GAEnCrB,IAAUjB,EAAK,CACbkB,OAAQoB,EAAS,EACjBnB,KAAM,CAAC,CAAC,WAAY,UACpB9B,KAAM,CACJ,CAAC,iBAAkB,KAAe,QAAXQ,EAAAhH,EAAOtC,YAAI,IAAAsJ,OAAA,EAAXA,EAAa5L,eAAe,WAAY,OAC/D,CAAC,kBAAmB,KAAoB,QAAhB6L,EAAAjH,EAAOnC,iBAAS,IAAAoJ,OAAA,EAAhBA,EAAkB7L,eAAe,WAAY,OACrE,CAAC,cAAe,KAAgB,QAAZ8L,EAAAlH,EAAOpC,aAAK,IAAAsJ,OAAA,EAAZA,EAAc9L,eAAe,WAAY,OAC7D,CAAC,gBAAiB,KAAK4E,EAAOtC,KAAOsC,EAAOnC,UAAYmC,EAAOpC,OAAS,GAAGxC,eAAe,aAE5FmN,OAAQ,CAAEC,SAAU,GAAIC,YAAa,EAAGC,SAAU,aAClDC,WAAY,CAAEC,UAAW,CAAC,EAAG,IAAK,KAAMC,UAAW,IAAKC,UAAW,OAAQC,UAAW,GAAKC,UAAW,CAAC,EAAG,EAAG,IAC7GE,aAAc,CAAE,EAAG,CAAEE,OAAQ,UAC7BC,eAAgB,CAAC,EAAG,EAAG,GACvBC,eAAgB,KAGlB,MAAMK,EAAYxC,EAAIuC,cAAcD,OAAS,GAC7CtC,EAAIK,YAAY,IAChBL,EAAItG,KAAK,4BAA6B,GAAI8I,GAE1C,MAAMC,EAAetE,OAAOC,QAAQtF,GAAiBhJ,IAAIS,IAAA,IAAAmS,EAAAC,EAAAC,EAAAC,EAAA,IAAE7S,EAAMsO,GAAK/N,EAAA,MAAK,CACzEP,GAAQ,GACR,KAAa,QAAT0S,EAAApE,EAAK/H,YAAI,IAAAmM,OAAA,EAATA,EAAWzO,eAAe,WAAY,MAC1C,KAAkB,QAAd0O,EAAArE,EAAK5H,iBAAS,IAAAiM,OAAA,EAAdA,EAAgB1O,eAAe,WAAY,MAC/C,KAAc,QAAV2O,EAAAtE,EAAK7H,aAAK,IAAAmM,OAAA,EAAVA,EAAY3O,eAAe,WAAY,MAC3C,KAAc,QAAV4O,EAAAvE,EAAK7N,aAAK,IAAAoS,OAAA,EAAVA,EAAY5O,eAAe,WAAY,SAG7CgN,IAAUjB,EAAK,CACbkB,OAAQsB,EAAY,EACpBrB,KAAM,CAAC,CAAC,eAAgB,WAAY,YAAa,QAAS,UAC1D9B,KAAMoD,EAAa7S,OAAS,EAAI6S,EAAe,CAAC,CAAC,IAAK,IAAK,IAAK,IAAK,MACrErB,OAAQ,CAAEC,SAAU,EAAGC,YAAa,EAAGC,SAAU,aACjDC,WAAY,CAAEC,UAAW,CAAC,EAAG,IAAK,KAAMC,UAAW,IAAKC,UAAW,OAAQC,UAAW,GAAKC,UAAW,CAAC,EAAG,EAAG,IAC7GE,aAAc,CACZ,EAAG,CAAEE,OAAQ,SACb,EAAG,CAAEA,OAAQ,SACb,EAAG,CAAEA,OAAQ,SACb,EAAG,CAAEA,OAAQ,UAEfC,eAAgB,CAAC,EAAG,EAAG,GACvBC,eAAgB,KAGlBnC,EAAI8C,KAAK,YAAW,IAAIjH,MAAOuD,cAAc2D,MAAM,KAAK,SAC1D,CAAE,MAAOtD,GACP5C,QAAQ4C,MAAM,2BAA4BA,GAC1CC,MAAM,4BAA8BD,EAAME,QAC5C,CACF,ECnHaqD,EAAcA,CAACjM,EAAQ8B,EAAQC,EAAiBmK,KAC3D,MAMMC,EAAYnM,EAAOoM,QAAQtO,GAC/BA,EAAMiB,MAAMhG,IAAI,CAAC6M,EAAMP,KAAK,IAAAgH,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAlH,EAAAC,EAAAkH,EAAAC,EAAAC,EAAAC,EAAAvH,EAAAwE,EAAA,MAAK,CAC/BnM,EAAMkI,GAAIX,EAAQ,GAAY,QAATgH,EAAAzG,EAAKqH,YAAI,IAAAZ,OAAA,EAATA,EAAWpT,OAAQ2M,EAAKqH,MAAQ,WACrDtU,MAAMC,QAAQgN,EAAKsH,WAAatH,EAAKsH,UAAUnU,IAAI4F,GAAKA,EAAE1F,MAAQ0F,GAAGkB,KAAK,OAAsB,QAAdyM,EAAA1G,EAAKsH,iBAAS,IAAAZ,OAAA,EAAdA,EAAgBrT,OAAQ2M,EAAKsH,WAAa,iBAChH,QAAZX,EAAA3G,EAAKR,eAAO,IAAAmH,OAAA,EAAZA,EAActT,OAAQ2M,EAAKR,SAAW,mBAA0B,QAAVoH,EAAA5G,EAAKuH,aAAK,IAAAX,OAAA,EAAVA,EAAYvT,OAAQ2M,EAAKuH,OAAS,cAC5E,QAAZV,EAAA7G,EAAKwH,eAAO,IAAAX,OAAA,EAAZA,EAAcxT,OAAQ2M,EAAKwH,SAAW,MAAgB,QAAVV,EAAA9G,EAAKyH,aAAK,IAAAX,OAAA,EAAVA,EAAY3T,IAAIV,GAAKA,EAAEY,MAAQZ,GAAGwH,KAAK,QAAS,WAC9E,QAAd8M,EAAA/G,EAAK0H,iBAAS,IAAAX,OAAA,EAAdA,EAAgB5T,IAAImD,GAAK,GAAGA,EAAEjD,MAAQ,KAAKiD,EAAEkJ,SAAWlJ,EAAEqR,YAAc,KAAKrR,EAAEkJ,SAAWlJ,EAAEqR,eAAiB,OAAOrR,EAAEwI,UAAY,MAAM7E,KAAK,QAAS,UACtJ+F,EAAK4H,OAAS,WAAoB,QAATZ,EAAAhH,EAAK6H,YAAI,IAAAb,OAAA,EAATA,EAAW3T,OAAQ2M,EAAK6H,MAAQ,mBAA+B,QAAZ/H,EAAAE,EAAKO,eAAO,IAAAT,OAAA,EAAZA,EAAcS,UAAW,oBACzF,QAAZR,EAAAC,EAAKO,eAAO,IAAAR,OAAA,EAAZA,EAAc+H,cAAe,mBAA+B,QAAZb,EAAAjH,EAAKO,eAAO,IAAA0G,OAAA,EAAZA,EAAcc,YAAa,IAAgB,QAAZb,EAAAlH,EAAKO,eAAO,IAAA2G,OAAA,EAAZA,EAAcc,gBAAiB,IAClG,QAAZb,EAAAnH,EAAKO,eAAO,IAAA4G,OAAA,EAAZA,EAAcc,cAAe,IAAgB,QAAZb,EAAApH,EAAKO,eAAO,IAAA6G,OAAA,EAAZA,EAAc3G,cAAe,mBAClD,QAAZZ,EAAAG,EAAKnI,eAAO,IAAAgI,OAAA,EAAZA,EAAcxM,OAAQ2M,EAAKnI,SAAW,WAAY,KAAe,QAAXwM,EAAAnM,EAAMpE,aAAK,IAAAuQ,OAAA,EAAXA,EAAa/M,eAAe,WAAY,MAC9FY,EAAML,SAAW,WAAYK,EAAM2I,gBAAkB,cAAe3I,EAAM6C,QAAU,YACpF7C,EAAMgQ,UAAY,IAAIhJ,KAA+B,IAA1BhH,EAAMgQ,UAAUC,SAAgB7Q,eAAe,SAAW,MACrFY,EAAMkQ,UAAY,IAAIlJ,KAA+B,IAA1BhH,EAAMkQ,UAAUD,SAAgB7Q,eAAe,SAAW,OACrFnE,IAAIgK,GAAQ,IAAIF,OAAOE,GAAQ,IAAIH,QAAQ,KAAM,aAG/CqL,EAAa,CACjB,CAAC,iBAAkB,IAAInM,EAAOtC,KAAKtC,eAAe,YAClD,CAAC,kBAAmB,IAAI4E,EAAOnC,UAAUzC,eAAe,YACxD,CAAC,cAAe,IAAI4E,EAAOpC,MAAMxC,eAAe,YAChD,CAAC,gBAAiB,KAAK4E,EAAOtC,KAAOsC,EAAOnC,UAAYmC,EAAOpC,OAAOxC,eAAe,aACrFnE,IAAIkO,GAAOA,EAAIlO,IAAIgK,GAAQ,IAAIF,OAAOE,GAAQ,IAAIH,QAAQ,KAAM,WAE5DsL,EAAe9G,OAAOC,QAAQtF,GAAiBhJ,IAAIS,IAAA,IAAEP,EAAMsO,GAAK/N,EAAA,MAAK,CACzEP,EAAM,IAAIsO,EAAK/H,KAAKtC,eAAe,WAAY,IAAIqK,EAAK5H,UAAUzC,eAAe,WACjF,IAAIqK,EAAK7H,MAAMxC,eAAe,WAAY,IAAIqK,EAAK7N,MAAMwD,eAAe,YACxEnE,IAAIgK,GAAQ,IAAIF,OAAOE,GAAQ,IAAIH,QAAQ,KAAM,YAE7CuL,EAAa,CAnCH,CACd,YAAa,gBAAc,OAAQ,YAAa,cAAY,SAAU,YAAa,qBAAmB,YAAa,QACnH,kBAAmB,eAAa,gBAAiB,mBAAoB,0BAA2B,qBAChG,cAAY,iBAAkB,cAAe,iBAAkB,eAAgB,SAAU,uBAAqB,8BAiCtGtO,KAAK,QACVsM,EACH,GACA,uBACA,8BACG8B,EACH,8BACA,mFACGC,GACHrO,KAAK,MAED8H,EAAO,IAAIC,KAAK,CAACuG,GAAa,CAAEvS,KAAM,4BACtCwS,EAAMnG,OAAOC,IAAIC,gBAAgBR,GACjCzL,EAAI4L,SAASC,cAAc,KACjC7L,EAAE8L,KAAOoG,EACTlS,EAAEkM,SAAW,YAAW,IAAItD,MAAOuD,cAAc2D,MAAM,KAAK,SAC5D9P,EAAEsM,QACFP,OAAOC,IAAImG,gBAAgBD,GAC3BlC,EAAW,8BCvDAxJ,EAAaC,GACZ,MAARA,EAAqB,GACL,kBAATA,EAA0BA,EAAKC,QAAQ,SAAU,IAAIrK,OAC5C,mBAAToK,EAA2BA,EAAKrK,WACvB,kBAATqK,GAAyB,OAAJA,QAAI,IAAJA,GAAAA,EAAM1J,KAAa0J,EAAK1J,KAAK2J,QAAQ,SAAU,IAAIrK,OAC5EsK,OAAOF,GAAMC,QAAQ,SAAU,IAAIrK,OAQ/B+V,EAAqBnI,IAChC,GAAY,OAAPA,QAAO,IAAPA,IAAAA,EAASA,QAAS,MAAO,mBAC9B,IAAIoI,EAAUpI,EAAQA,QACtB,OAAQA,EAAQuH,aACd,IAAK,SAAcvH,EAAQyH,gBAAeW,GAAW,aAAa7L,EAAUyD,EAAQyH,mBAAmB,MACvG,IAAK,UAAezH,EAAQ0H,cAAaU,GAAW,KAAK7L,EAAUyD,EAAQ0H,iBAAiB,MAC5F,IAAK,OAAY1H,EAAQwH,YAAWY,GAAW,KAAK7L,EAAUyD,EAAQwH,eAGxE,OAAOY,G,qICKT,MACMlR,EAA6B/C,IACjC,MAAMiD,IACc,kBAAXjD,EACHA,GACM,OAANA,QAAM,IAANA,OAAM,EAANA,EAAQrB,QAAc,OAANqB,QAAM,IAANA,OAAM,EAANA,EAAQpB,SAAe,OAANoB,QAAM,IAANA,OAAM,EAANA,EAAQkD,SAAe,OAANlD,QAAM,IAANA,OAAM,EAANA,EAAQA,UAAgB,OAANA,QAAM,IAANA,OAAM,EAANA,EAAQsB,OAAQ,KAL/D,IAAItD,WAAWC,OAAOC,cAOjD,OAAI+E,EAAII,SAAS,UACbJ,EAAII,SAAS,QADiB,OAE9BJ,EAAII,SAAS,SAAiB,QAC9BJ,EAAII,SAAS,QAAgB,YAC1B,SAwBH6Q,EAA+B,SAACxO,GAAsC,IAA9B,gBAAEyO,GAAiBrP,UAAAvG,OAAA,QAAAwG,IAAAD,UAAA,GAAAA,UAAA,GAAG,CAAC,EACnE,MAAMvE,EAAM,CAAC,EACP6T,EAAeA,CAACC,EAAQC,KAC5B/T,EAAI8T,GAAU9T,EAAI8T,IAAW,CAAC,EAC9B9T,EAAI8T,GAAQC,GAAU/T,EAAI8T,GAAQC,IAAW,CAAEpP,KAAM,EAAGE,MAAO,EAAGC,UAAW,EAAGC,MAAO,EAAGlG,MAAO,GAC1FmB,EAAI8T,GAAQC,IAEfC,EAAOA,CAACC,EAAKlQ,EAAWrE,KACvBA,IACLuU,EAAIlQ,IAAckQ,EAAIlQ,IAAc,GAAKrE,EACzCuU,EAAIpV,OAASa,IAgBf,OAbCyF,GAAU,IAAImF,QAASrH,IACtB,MAAM6Q,EAAS9L,QAAY,OAAL/E,QAAK,IAALA,OAAK,EAALA,EAAO2I,iBAAkB,QAAQlO,OAEjDqW,EADcjW,MAAMC,QAAa,OAALkF,QAAK,IAALA,OAAK,EAALA,EAAOmB,aAA+B,eAAX,OAALnB,QAAK,IAALA,OAAK,EAALA,EAAOlC,MAClC,YAAc,QACrC5B,EAtCoB+U,EAACjR,EAAO2Q,KACpC,MAAM/U,EAAQ1B,KAAKC,MAAMC,QAAY,OAAL4F,QAAK,IAALA,OAAK,EAALA,EAAOpE,QAAS,KAAO,EAEvD,GAAIf,MAAMC,QAAa,OAALkF,QAAK,IAALA,OAAK,EAALA,EAAOY,WAAaZ,EAAMY,SAAS7F,OACnD,OAAOiF,EAAMY,SAAS3F,IAAK4F,IAAC,CAC1BC,UAAWvB,EAA0BsB,EAAErE,QACvCC,OAAQvC,KAAKC,MAAMC,OAAOyG,EAAEpE,QAAU,KAAO,KAIjD,MAAMyU,EAAgC,oBAApBP,GAAkCA,EAAgB3Q,IAAgB,GACpF,OAAIkR,EAAGnW,OACEmW,EAAGjW,IAAK4F,IAAC,CACdC,UAAWvB,EAA0BsB,EAAErE,QACvCC,OAAQvC,KAAKC,MAAMC,OAAOyG,EAAEpE,QAAU,KAAO,KAI1C,CAAC,CAAEqE,UAAW,QAASrE,OAAQb,KAoBvBqV,CAAsBjR,EAAO2Q,GACpCQ,EAASP,EAAaC,EAAQC,GAC9BM,EAAUR,EAAaC,EAAQ,SACrC3U,EAAKmL,QAAQ3L,IAA4B,IAA3B,UAAEoF,EAAS,OAAErE,GAAQf,EACjCqV,EAAKI,EAAQrQ,EAAWrE,GACxBsU,EAAKK,EAAStQ,EAAWrE,OAItBM,CACT,EAEMsU,EAASpX,GAAM,IAAIC,KAAKC,MAAMF,GAAK,GAAGmF,eAAe,WA0pB3D,EAppBqBoK,IA0Cd,IA1Ce,MACpB7N,EAAK,OACLuG,EAAM,WACNoP,EAAU,cACVC,EAAa,OACbvN,EAAM,UACNwN,EAAS,gBACTC,EAAe,YACfC,EAAW,WACXC,EAAU,eACVC,EAAc,aACdC,EAAY,gBACZC,EAAe,gBACf7N,EAAe,gBACf8N,EAAe,kBACfC,EAAiB,mBACjBC,EAAkB,WAClBC,EAAU,YACVC,EAAW,mBACXC,EAAkB,kBAClBC,EAAiB,qBACjBC,EAAoB,SACpBC,EAAQ,YACRC,EAAW,qBACXC,EAAoB,UACpBC,EAAS,iBACTC,EAAgB,oBAChBC,EAAmB,WACnBC,EAAU,cACVC,EAAa,kBACbC,EAAiB,uBACjBC,EAAsB,aACtBC,EAAY,sBACZC,EAAqB,wBACrBC,EAAuB,cACvBrP,GAAa,YACbiH,GAAW,YACXoD,GAAW,qBACXiF,GAAoB,gBACpBC,GAAe,mBACfC,GAAkB,sBAClBC,IACD/J,EACC,MAAMgK,IAAc,IAAIxM,MAAO2E,mBAAmB,QAAS,CACzD8H,QAAS,OACTC,MAAO,OACPC,IAAK,YAGDC,IAAUC,EAAAA,EAAAA,QAAO,OAChBC,GAAeC,KAAoB3X,EAAAA,EAAAA,UAAS,IAC7C4X,IAAkBH,EAAAA,EAAAA,QAAO,KAE/BlX,EAAAA,EAAAA,WAAU,KACR,SAASsX,EAAmBC,GACtBN,GAAQO,UAAYP,GAAQO,QAAQC,SAASF,EAAMzV,SACrDqU,GAAc,EAElB,CAEA,OADID,GAAY7I,SAASqK,iBAAiB,YAAaJ,GAChD,IAAMjK,SAASsK,oBAAoB,YAAaL,IACtD,CAACpB,EAAYC,IAGhB,MAAOyB,GAAsBC,KAA2BpY,EAAAA,EAAAA,UAAS,MAG3DqY,GAAoB,CACxB,SACA,iBACA,cACA,0BACA,kBACA,mBAiBIC,GAAuB3Q,UAC3B,MAAMmE,EAAU,OAALlI,QAAK,IAALA,OAAK,EAALA,EAAOkI,GAClB,IAAKA,EAAI,MAAM,IAAIyM,MAAM,gBAEzB,MAAMC,EAAY,GACT,OAAL5U,QAAK,IAALA,GAAAA,EAAOwC,cAAcoS,EAAUjT,KAAK3B,EAAMwC,cACrC,OAALxC,QAAK,IAALA,GAAAA,EAAO6U,iBAAuB,OAAL7U,QAAK,IAALA,OAAK,EAALA,EAAO6U,mBAAwB,OAAL7U,QAAK,IAALA,OAAK,EAALA,EAAOwC,eAC5DoS,EAAUjT,KAAK3B,EAAM6U,gBAGvB,MAAMC,EAvBuB9U,IACpB,OAALA,QAAK,IAALA,GAAAA,EAAOwC,aAAqBxC,EAAMwC,aAC7B,OAALxC,QAAK,IAALA,GAAAA,EAAO6U,eAAuB7U,EAAM6U,eAGtB,eAAX,OAAL7U,QAAK,IAALA,OAAK,EAALA,EAAOlC,OACPjD,MAAMC,QAAa,OAALkF,QAAK,IAALA,OAAK,EAALA,EAAOmB,YAEC,0BACjB,SAcO4T,CAAsB/U,GAE9BgV,EAAc,CAACF,KADR,CAAC,SAAU,iBAAkB,cAAe,0BAA2B,mBAChDzZ,OAAQiD,GAAMA,IAAMwW,IAElDG,EAAa,IACdL,EAAUvZ,OAAOC,YACjB0Z,KACAP,IACHpZ,OAAO,CAACrB,EAAGwD,EAAGY,MAAQpE,GAAKoE,EAAE8W,QAAQlb,KAAOwD,GAE9C,IAAK,MAAM2X,KAAOF,EAAY,CAC5B,MAAMG,GAAMjK,EAAAA,EAAAA,IAAIkK,EAAAA,GAAIF,EAAKjN,GAEzB,UADmBoN,EAAAA,EAAAA,IAAOF,IACjBG,SAAU,OAAOH,CAC5B,CAEA,OAAO,MAqDLI,IAAgBvZ,EAAAA,EAAAA,SAAQ,KAAMgG,EAAAA,EAAAA,IAAoBC,GAAU,IAAK,CAACA,IAGhEuT,IAAUxZ,EAAAA,EAAAA,SACd,IAAMyU,EAA6BxO,GAAU,GAAI,CAAEyO,gBAAiB3O,EAAAA,KACpE,CAACE,IAEGwT,IAAiBzZ,EAAAA,EAAAA,SACrB,IAAMqN,OAAOqM,KAAKF,IAASG,KAAK,CAACxX,EAAGC,IAAMD,EAAEyX,cAAcxX,EAAG,OAC7D,CAACoX,KAOH,OACEhY,EAAAA,EAAAA,MAAAqY,EAAAA,SAAA,CAAAlY,SAAA,EACEH,EAAAA,EAAAA,MAAA,OAAKC,UAAU,8CAA6CE,SAAA,EAC1DC,EAAAA,EAAAA,KAAA,MAAIH,UAAU,uEAAsEE,SAAC,sCAKrFH,EAAAA,EAAAA,MAAA,OAAKC,UAAU,qGAAoGE,SAAA,EACjHH,EAAAA,EAAAA,MAAA,OAAKC,WAAWC,EAAAA,EAAAA,GAAW,kCAA6C,SAAVhC,EAAmB,cAAgB,eAAeiC,SAAA,EAC9GC,EAAAA,EAAAA,KAAA,KAAGH,UAAU,qCAAoCE,SAAC,oBAClDH,EAAAA,EAAAA,MAAA,KAAGC,UAAU,+BAA8BE,SAAA,CAAC,IAAE1D,KAAKC,MAAMqb,GAAc9T,MAAQ,GAAGtC,eAAe,gBAEnG3B,EAAAA,EAAAA,MAAA,OAAKC,WAAWC,EAAAA,EAAAA,GAAW,kCAA6C,SAAVhC,EAAmB,cAAgB,eAAeiC,SAAA,EAC9GC,EAAAA,EAAAA,KAAA,KAAGH,UAAU,qCAAoCE,SAAC,qBAClDH,EAAAA,EAAAA,MAAA,KAAGC,UAAU,+BAA8BE,SAAA,CAAC,IAAE1D,KAAKC,MAAMqb,GAAc3T,WAAa,GAAGzC,eAAe,gBAExG3B,EAAAA,EAAAA,MAAA,OAAKC,WAAWC,EAAAA,EAAAA,GAAW,kCAA6C,SAAVhC,EAAmB,cAAgB,eAAeiC,SAAA,EAC9GC,EAAAA,EAAAA,KAAA,KAAGH,UAAU,qCAAoCE,SAAC,iBAClDH,EAAAA,EAAAA,MAAA,KAAGC,UAAU,+BAA8BE,SAAA,CAAC,IAAE1D,KAAKC,MAAMqb,GAAc5T,OAAS,GAAGxC,eAAe,gBAEpG3B,EAAAA,EAAAA,MAAA,OAAKC,WAAWC,EAAAA,EAAAA,GAAW,kCAA6C,SAAVhC,EAAmB,cAAgB,eAAeiC,SAAA,EAC9GC,EAAAA,EAAAA,KAAA,KAAGH,UAAU,qCAAoCE,SAAC,mBAClDH,EAAAA,EAAAA,MAAA,KAAGC,UAAU,+BAA8BE,SAAA,CAAC,IACxC1D,KAAKC,OAAOqb,GAAc9T,MAAQ,IAAM8T,GAAc3T,WAAa,IAAM2T,GAAc5T,OAAS,IAAIxC,eAAe,mBAM3H3B,EAAAA,EAAAA,MAAA,OAAKC,UAAU,oFAAmFE,SAAA,EAChGC,EAAAA,EAAAA,KAAA,SACEC,KAAK,OACLjC,MAAOyV,EACPxV,SAAW0C,GAAM+S,EAAc/S,EAAEC,OAAO5C,OACxC+C,YAAY,oBACZlB,WAAWC,EAAAA,EAAAA,GACT,iKACU,SAAVhC,EAAmB,yCAA2C,6CAGlE8B,EAAAA,EAAAA,MAAA,OAAKC,UAAU,kEAAiEE,SAAA,EAC9EH,EAAAA,EAAAA,MAAA,UACEM,QAASA,IAAM6U,GAAoB,GACnClV,WAAWC,EAAAA,EAAAA,GACT,gNACU,SAAVhC,EAAmB,kEAAoE,sEACvFiC,SAAA,EAEFC,EAAAA,EAAAA,KAACkY,EAAAA,EAAQ,CAACrY,UAAU,aACpBG,EAAAA,EAAAA,KAAA,QAAMH,UAAU,mBAAkBE,SAAC,gCAErCC,EAAAA,EAAAA,KAAA,OACEH,WAAWC,EAAAA,EAAAA,GACT,6KACU,SAAVhC,EAAmB,yCAA2C,6CAC9DiC,SAED4V,MAEH/V,EAAAA,EAAAA,MAAA,OAAKC,UAAU,yBAAyB0X,IAAKxB,GAAQhW,SAAA,EACnDC,EAAAA,EAAAA,KAAA,UACEE,QAASA,IAAM+U,GAAeD,GAC9BnV,WAAWC,EAAAA,EAAAA,GAAW,6GAA8G,uDACpI,aAAW,sBAAkBC,UAE7BC,EAAAA,EAAAA,KAACmY,EAAAA,EAAoB,CAACtY,WAAWC,EAAAA,EAAAA,GAAW,UAAqB,SAAVhC,EAAmB,iCAAmC,yCAE9GkX,IACChV,EAAAA,EAAAA,KAAA,OAAKH,WAAWC,EAAAA,EAAAA,GAAW,uDAAkE,SAAVhC,EAAmB,4BAA8B,0BAA0BiC,UAC5JH,EAAAA,EAAAA,MAAA,OAAKC,UAAU,OAAME,SAAA,EACnBC,EAAAA,EAAAA,KAAA,UAAQE,QAASA,KAAQuV,GAAmB,aAAcR,GAAc,IAAWpV,UAAU,gHAA+GE,SAAC,mBAC7MC,EAAAA,EAAAA,KAAA,UAAQE,QAASA,KAAQuV,GAAmB,SAAUR,GAAc,IAAWpV,UAAU,gHAA+GE,SAAC,mBACzMC,EAAAA,EAAAA,KAAA,UAAQE,QAASA,KAAQuV,GAAmB,OAAQR,GAAc,IAAWpV,UAAU,gHAA+GE,SAAC,eACvMC,EAAAA,EAAAA,KAAA,UAAQE,QAASA,KAAQqV,IAAqB,GAAON,GAAc,IAAWpV,UAAU,gHAA+GE,SAAC,mBACxMC,EAAAA,EAAAA,KAAA,UAAQE,QAASA,KAAQgV,IAAqBD,GAAc,IAAWpV,UAAU,gHAA+GE,SAAC,sBACjMC,EAAAA,EAAAA,KAAA,UAAQE,QAASA,KAAQiV,IAA0BF,GAAc,IAAWpV,UAAU,gHAA+GE,SAAC,wBACtMH,EAAAA,EAAAA,MAAA,UAAQM,QAASA,KAAQkV,EAAanP,GAAe,SAAUgP,GAAc,IAAWpV,UAAU,kIAAiIE,SAAA,EACjOC,EAAAA,EAAAA,KAACoY,EAAAA,EAAiB,CAACvY,UAAU,iBAAiB,sBAEhDD,EAAAA,EAAAA,MAAA,UAAQM,QAASA,KAAQkV,EAAalI,GAAa,OAAQ+H,GAAc,IAAWpV,UAAU,kIAAiIE,SAAA,EAC7NC,EAAAA,EAAAA,KAACoY,EAAAA,EAAiB,CAACvY,UAAU,iBAAiB,oBAEhDD,EAAAA,EAAAA,MAAA,UAAQM,QAASA,KAAQkV,EAAa9E,GAAa,OAAQ2E,GAAc,IAAWpV,UAAU,kIAAiIE,SAAA,EAC7NC,EAAAA,EAAAA,KAACoY,EAAAA,EAAiB,CAACvY,UAAU,iBAAiB,oBAEhDG,EAAAA,EAAAA,KAAA,UAAQE,QAASA,KAAQoV,GAAwB,GAAOL,GAAc,IAAWpV,UAAU,6HAA4HE,SAAC,kCASpOC,EAAAA,EAAAA,KAAA,OAAKH,WAAWC,EAAAA,EAAAA,GAAW,6GAAwH,SAAVhC,EAAmB,cAAgB,YAAYiC,SACrL4T,GACC3T,EAAAA,EAAAA,KAAA,OAAKH,UAAU,wCAAuCE,UACpDC,EAAAA,EAAAA,KAAA,OAAKH,UAAU,sEAGjBD,EAAAA,EAAAA,MAAAqY,EAAAA,SAAA,CAAAlY,SAAA,EACEC,EAAAA,EAAAA,KAAA,OAAKH,UAAU,kBAAiBE,UAC9BH,EAAAA,EAAAA,MAAA,SAAOC,UAAU,+CAA8CE,SAAA,EAC7DC,EAAAA,EAAAA,KAAA,SAAAD,UACEH,EAAAA,EAAAA,MAAA,MAAIC,WAAWC,EAAAA,EAAAA,GAAW,4CAAuD,SAAVhC,EAAmB,4BAA8B,6BAA6BiC,SAAA,EACnJH,EAAAA,EAAAA,MAAA,MAAIC,UAAU,uDAAuDK,QAASA,IAAMmU,EAAW,eAAetU,SAAA,CAAC,SAAIuU,EAAY,mBAC/HtU,EAAAA,EAAAA,KAAA,MAAIH,UAAU,wCAAuCE,SAAC,cACtDH,EAAAA,EAAAA,MAAA,MAAIC,UAAU,uDAAuDK,QAASA,IAAMmU,EAAW,WAAWtU,SAAA,CAAC,gBAAWuU,EAAY,eAClI1U,EAAAA,EAAAA,MAAA,MAAIC,UAAU,uDAAuDK,QAASA,IAAMmU,EAAW,SAAStU,SAAA,CAAC,eAAUuU,EAAY,aAC/H1U,EAAAA,EAAAA,MAAA,MAAIC,UAAU,uDAAuDK,QAASA,IAAMmU,EAAW,QAAQtU,SAAA,CAAC,QAAMuU,EAAY,YAC1H1U,EAAAA,EAAAA,MAAA,MAAIC,UAAU,uDAAuDK,QAASA,IAAMmU,EAAW,WAAWtU,SAAA,CAAC,QAAMuU,EAAY,eAC7H1U,EAAAA,EAAAA,MAAA,MAAIC,UAAU,uDAAuDK,QAASA,IAAMmU,EAAW,SAAStU,SAAA,CAAC,SAAOuU,EAAY,aAC5H1U,EAAAA,EAAAA,MAAA,MAAIC,UAAU,uDAAuDK,QAASA,IAAMmU,EAAW,kBAAkBtU,SAAA,CAAC,gBAAcuU,EAAY,sBAC5I1U,EAAAA,EAAAA,MAAA,MAAIC,UAAU,uDAAuDK,QAASA,IAAMmU,EAAW,UAAUtU,SAAA,CAAC,UAAQuU,EAAY,cAC9HtU,EAAAA,EAAAA,KAAA,MAAIH,UAAU,wCAAuCE,SAAC,mBAG1DC,EAAAA,EAAAA,KAAA,SAAAD,SAC8B,IAA3B6T,EAAgB1W,QACf8C,EAAAA,EAAAA,KAAA,MAAAD,UACEC,EAAAA,EAAAA,KAAA,MAAIqY,QAAQ,KAAKxY,UAAU,mDAAkDE,SAAC,2EAGhF6T,EAAgBxW,IAAI,CAAC+E,EAAOuH,KAAW,IAADrH,EAAAC,EAAAI,EAAAC,EAAAJ,EAAAC,EAAA8V,EAAA1V,EAAAC,EAAA0V,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAA3K,EACpC,MAAM4K,EACU,QAAdrE,GACKhB,EAAc,GAAKG,EAAetK,EAAQ,EAC3CkK,EAAgB1W,SAAW2W,EAAc,GAAKG,EAAetK,GAE7DyP,EAAiBxG,GAA6B,QAAXtQ,EAAAF,EAAMiB,aAAK,IAAAf,GAAK,QAALC,EAAXD,EAAc,UAAE,IAAAC,OAAL,EAAXA,EAAkBkI,WAA2B,QAApB9H,EAAIP,EAAMmB,kBAAU,IAAAZ,GAAK,QAALC,EAAhBD,EAAmB,UAAE,IAAAC,OAAL,EAAhBA,EAAuB6H,UAEvF4O,EAAYrS,EAChB5E,EAAML,UACK,QADES,EACbJ,EAAMiB,aAAK,IAAAb,GAAK,QAALC,EAAXD,EAAc,UAAE,IAAAC,GAAS,QAAT8V,EAAhB9V,EAAkBV,eAAO,IAAAwW,OAAd,EAAXA,EAA2Bhb,QACX,QADesF,EAC/BT,EAAMmB,kBAAU,IAAAV,GAAK,QAALC,EAAhBD,EAAmB,UAAE,IAAAC,GAAS,QAAT0V,EAArB1V,EAAuBf,eAAO,IAAAyW,OAAd,EAAhBA,EAAgCjb,OAChC,YAGI+b,EACJrc,MAAMC,QAAQkF,EAAMY,WAAaZ,EAAMY,SAAS7F,QAC5CqG,EAAAA,EAAAA,IAAkBpB,EAAMY,UACxBqW,EAEAE,EACa,cAAjBnX,EAAM6C,OAAyB,2BACV,cAAjB7C,EAAM6C,OAAyB,0BACd,cAAjB7C,EAAM6C,OAAyB,wBAC/B,GAEAuU,GAAuB,QAAXf,EAAArW,EAAMiB,aAAK,IAAAoV,GAAK,QAALC,EAAXD,EAAc,UAAE,IAAAC,OAAL,EAAXA,EAAkB3G,QAAwB,QAApB4G,EAAIvW,EAAMmB,kBAAU,IAAAoV,GAAK,QAALC,EAAhBD,EAAmB,UAAE,IAAAC,OAAL,EAAhBA,EAAuB7G,MACnE,IAAI0H,EAAc,MAIlB,MAHyB,kBAAdD,EAAwBC,EAAcD,EACnB,kBAAdA,GAAwC,OAAdA,IAAoBC,EAAcD,EAAUjc,MAAQ,QAG5FsC,EAAAA,EAAAA,MAAA,MAEEC,WAAWC,EAAAA,EAAAA,GACT,0CACU,SAAVhC,EAAmB,oCAAsC,mCACzD4L,EAAQ,IAAM,EAAe,SAAV5L,EAAmB,cAAgB,aAAgB,IACtEiC,SAAA,EAEFC,EAAAA,EAAAA,KAAA,MAAIH,UAAU,2BAA0BE,SAAEmZ,KAC1ClZ,EAAAA,EAAAA,KAAA,MAAIH,UAAU,2BAA0BE,UACtCH,EAAAA,EAAAA,MAAA,UACEM,QAASA,IAAMqU,EAAmBpS,GAClCtC,UAAU,yEACVgC,MAAM,6BAA4B9B,SAAA,EAElCC,EAAAA,EAAAA,KAACyZ,EAAAA,EAAqB,CAAC5Z,UAAU,iBAAiB,YAItDG,EAAAA,EAAAA,KAAA,MAAIH,UAAU,qGAAoGE,SAC/GoZ,KAEHnZ,EAAAA,EAAAA,KAAA,MAAIH,UAAU,6CAA4CE,UAC5C,QAAX6Y,EAAAzW,EAAMiB,aAAK,IAAAwV,GAAK,QAALC,EAAXD,EAAc,UAAE,IAAAC,GAAS,QAATC,EAAhBD,EAAkBrO,eAAO,IAAAsO,OAAd,EAAXA,EAA2BpO,eACV,QADqBqO,EACrC5W,EAAMmB,kBAAU,IAAAyV,GAAK,QAALC,EAAhBD,EAAmB,UAAE,IAAAC,GAAS,QAATC,EAArBD,EAAuBxO,eAAO,IAAAyO,OAAd,EAAhBA,EAAgCvO,cAChC,SAEJ1K,EAAAA,EAAAA,KAAA,MAAIH,UAAU,6CAA4CE,SAAEyZ,KAC5DxZ,EAAAA,EAAAA,KAAA,MAAIH,UAAU,6CAA4CE,SAAEsZ,KAC5DzZ,EAAAA,EAAAA,MAAA,MAAIC,UAAU,6CAA4CE,SAAA,CAAC,KAC5C,QAAXuO,EAAAnM,EAAMpE,aAAK,IAAAuQ,OAAA,EAAXA,EAAa/M,eAAe,WAAY,QAE5CvB,EAAAA,EAAAA,KAAA,MAAIH,UAAU,6CAA4CE,SACvDyU,IAAsBrS,EAAMkI,IAC3BzK,EAAAA,EAAAA,MAAAqY,EAAAA,SAAA,CAAAlY,SAAA,EACEC,EAAAA,EAAAA,KAAA,SACE6F,KAAM,iBAAiB1D,EAAMkI,KAC7BrM,MAAOiY,GACPhY,SAAW0C,GAAMuV,GAAiBvV,EAAEC,OAAO5C,OAC3C0b,UAAY/Y,IACV,GAAc,UAAVA,EAAElB,IAAiB,CACrB,MAAMka,GAAe1D,IAAiB,IAAIrZ,QAAU,cACpDgY,EAAqBzS,EAAMkI,GAAIsP,GACX,gBAAhBA,IAA+BxD,GAAgBG,QAAUqD,GAC7DlF,EAAqB,KACvB,KAAqB,WAAV9T,EAAElB,KACXgV,EAAqB,OAGzBmF,OAAQA,KACN,MAAMD,GAAe1D,IAAiB,IAAIrZ,QAAU,cACpDgY,EAAqBzS,EAAMkI,GAAIsP,GACX,gBAAhBA,IAA+BxD,GAAgBG,QAAUqD,GAC7DlF,EAAqB,OAEvB1T,YAAY,wBACZlB,WAAWC,EAAAA,EAAAA,GACT,qCACU,SAAVhC,EAAmB,yCAA2C,yCAC9D,uDAEF+b,WAAS,KAEXja,EAAAA,EAAAA,MAAA,YAAUyK,GAAI,iBAAiBlI,EAAMkI,KAAKtK,SAAA,EACxCC,EAAAA,EAAAA,KAAA,UAAQhC,MAAM,gBACb0X,GAAsBtY,IAAK4V,IAC1BhT,EAAAA,EAAAA,KAAA,UAAqBhC,MAAOgV,GAAfA,WAKnBhT,EAAAA,EAAAA,KAAA,QACEE,QAASA,KACP,MAAM4Z,EAAU3X,EAAM2I,gBAAkBqL,GAAgBG,SAAW,GACnEJ,GAAiB4D,GACjBrF,EAAqBtS,EAAMkI,KAE7BxK,UAAU,qCACVgC,MAAM,wCAAuC9B,SAE5CoC,EAAM2I,gBAAkB,mBAI/B9K,EAAAA,EAAAA,KAAA,MAAIH,UAAU,+BAA8BE,UAC1CH,EAAAA,EAAAA,MAAA,UACE5B,MAAOmE,EAAM6C,QAAU,YACvB/G,SAAW0C,GAAMyT,EAAmBjS,EAAMkI,GAAI1J,EAAEC,OAAO5C,OACvD6B,WAAWC,EAAAA,EAAAA,GACT,8EACAwZ,EACU,SAAVxb,EAAmB,gBAAkB,gBACrC,uDACAiC,SAAA,EAEFC,EAAAA,EAAAA,KAAA,UAAQhC,MAAM,YAAW+B,SAAC,eAC1BC,EAAAA,EAAAA,KAAA,UAAQhC,MAAM,oBAAgB+B,SAAC,uBAC/BC,EAAAA,EAAAA,KAAA,UAAQhC,MAAM,YAAW+B,SAAC,eAC1BC,EAAAA,EAAAA,KAAA,UAAQhC,MAAM,YAAW+B,SAAC,eAC1BC,EAAAA,EAAAA,KAAA,UAAQhC,MAAM,YAAW+B,SAAC,oBAG9BC,EAAAA,EAAAA,KAAA,MAAIH,UAAU,+BAA8BE,UAC1CH,EAAAA,EAAAA,MAAA,OAAKC,UAAU,aAAYE,SAAA,EACzBC,EAAAA,EAAAA,KAAA,UACEE,QAASA,IAAMgU,EAAgB/R,GAC/BtC,UAAU,kFACVgC,MAAM,gBACN,aAAY,iBAAiBqX,IAAgBnZ,UAE7CC,EAAAA,EAAAA,KAAC+Z,EAAAA,EAAU,CAACla,UAAU,eAExBG,EAAAA,EAAAA,KAAA,UACEE,QAASA,IAAMyW,GAAwBxU,GACvCtC,UAAU,sFACVgC,MAAM,uBACN,aAAY,2BAA2BqX,IAAgBnZ,SACxD,kBAGDC,EAAAA,EAAAA,KAAA,UACEE,QAASA,IAAMiU,EAAkBhS,EAAMkI,IACvCxK,UAAU,gFACVgC,MAAM,kBACN,aAAY,mBAAmBqX,IAAgBnZ,UAE/CC,EAAAA,EAAAA,KAACga,EAAAA,EAAS,CAACna,UAAU,qBA7HtBsC,EAAMkI,cA0IzBzK,EAAAA,EAAAA,MAAA,OAAKC,UAAU,yDAAwDE,SAAA,EACrEH,EAAAA,EAAAA,MAAA,OAAKC,UAAU,mEAAkEE,SAAA,EAC/EC,EAAAA,EAAAA,KAAA,QAAAD,SAAM,4BACNH,EAAAA,EAAAA,MAAA,UACE5B,MAAOgW,EACP/V,SAAW0C,IAAQsT,EAAgB1X,OAAOoE,EAAEC,OAAO5C,QAAS+V,EAAe,IAC3ElU,WAAWC,EAAAA,EAAAA,GAAW,gCAA2C,SAAVhC,EAAmB,yCAA2C,0CAA0CiC,SAAA,EAE/JC,EAAAA,EAAAA,KAAA,UAAQhC,MAAM,KAAI+B,SAAC,QACnBC,EAAAA,EAAAA,KAAA,UAAQhC,MAAM,KAAI+B,SAAC,QACnBC,EAAAA,EAAAA,KAAA,UAAQhC,MAAM,KAAI+B,SAAC,QACnBC,EAAAA,EAAAA,KAAA,UAAQhC,MAAM,KAAI+B,SAAC,cAGvBH,EAAAA,EAAAA,MAAA,OAAKC,UAAU,mEAAkEE,SAAA,EAC/EC,EAAAA,EAAAA,KAAA,UACEE,QAASA,IAAM6T,EAAgBkG,GAAS5d,KAAKiF,IAAI2Y,EAAO,EAAG,IAC3D/b,SAA0B,IAAhB2V,EACVhU,WAAWC,EAAAA,EAAAA,GACT,gDACgB,IAAhB+T,EAAoB,sDAAkE,SAAV/V,EAAmB,kCAAoC,mCACnIiC,UAEFC,EAAAA,EAAAA,KAACka,EAAAA,EAAe,CAACra,UAAU,eAE7BD,EAAAA,EAAAA,MAAA,QAAAG,SAAA,CAAM,aAAQ8T,EAAY,OAAKC,MAC/B9T,EAAAA,EAAAA,KAAA,UACEE,QAASA,IAAM6T,EAAgBkG,GAAS5d,KAAKwE,IAAIoZ,EAAO,EAAGnG,IAC3D5V,SAAU2V,IAAgBC,EAC1BjU,WAAWC,EAAAA,EAAAA,GACT,gDACA+T,IAAgBC,EAAa,sDAAkE,SAAVhW,EAAmB,kCAAoC,mCAC5IiC,UAEFC,EAAAA,EAAAA,KAACma,EAAAA,EAAgB,CAACta,UAAU,0BASxCD,EAAAA,EAAAA,MAAA,OAAKC,UAAU,iBAAgBE,SAAA,EAC7BC,EAAAA,EAAAA,KAAA,MAAIH,UAAU,gCAA+BE,SAAC,8BAEnB,IAA1B8X,GAAe3a,QACd8C,EAAAA,EAAAA,KAAA,OAAKH,WAAWC,EAAAA,EAAAA,GACd,8BACU,SAAVhC,EAAmB,4BAA8B,0BACjDiC,SAAC,oDAIHC,EAAAA,EAAAA,KAAA,OAAKH,UAAU,yBAAwBE,SACpC8X,GAAeza,IAAK4V,IACnB,MAAMoH,EAAUxC,GAAQ5E,IAAW,CAAC,EAC9BqH,EAAQD,EAAQC,OAAS,CAAExW,KAAK,EAAGE,MAAM,EAAGC,UAAU,EAAGC,MAAM,EAAGlG,MAAM,GACxEuc,EAAYF,EAAQE,WAAa,CAAEzW,KAAK,EAAGE,MAAM,EAAGC,UAAU,EAAGC,MAAM,EAAGlG,MAAM,GAChFwc,EAAUH,EAAQrc,OAAS,CAAE8F,KAAK,EAAGE,MAAM,EAAGC,UAAU,EAAGC,MAAM,EAAGlG,MAAM,GAEhF,OACE6B,EAAAA,EAAAA,MAAA,OAAkBC,WAAWC,EAAAA,EAAAA,GAC3B,mCACU,SAAVhC,EAAmB,qCAAuC,mCAC1DiC,SAAA,EACAH,EAAAA,EAAAA,MAAA,OAAKC,UAAU,yCAAwCE,SAAA,EACrDC,EAAAA,EAAAA,KAAA,MAAIH,UAAU,qCAAoCE,SAAEiT,KACpDhT,EAAAA,EAAAA,KAAA,UACEE,QAASA,IAhXVsa,EAACxH,EAAQoH,KAC5BjQ,QAAQsQ,IAAI,aAAczH,EAAQoH,IA+WCI,CAAaxH,EAAQoH,GACpCva,UAAU,8EAA6EE,SACxF,wBAKHH,EAAAA,EAAAA,MAAA,OAAKC,UAAU,wCAAuCE,SAAA,EAEpDH,EAAAA,EAAAA,MAAA,OAAAG,SAAA,EACEC,EAAAA,EAAAA,KAAA,OAAKH,UAAU,2BAA0BE,SAAC,cAC1CH,EAAAA,EAAAA,MAAA,OAAKC,WAAWC,EAAAA,EAAAA,GACd,+BACU,SAAVhC,EAAmB,iCAAmC,8BACtDiC,SAAA,EACAH,EAAAA,EAAAA,MAAA,OAAKC,UAAU,sCAAqCE,SAAA,EAACC,EAAAA,EAAAA,KAAA,QAAAD,SAAM,cAAeC,EAAAA,EAAAA,KAAA,QAAMH,UAAU,gBAAeE,SAAEyT,EAAM6G,EAAMxW,YACvHjE,EAAAA,EAAAA,MAAA,OAAKC,UAAU,sCAAqCE,SAAA,EAACC,EAAAA,EAAAA,KAAA,QAAAD,SAAM,eAAgBC,EAAAA,EAAAA,KAAA,QAAMH,UAAU,gBAAeE,SAAEyT,EAAM6G,EAAMrW,iBACxHpE,EAAAA,EAAAA,MAAA,OAAKC,UAAU,sCAAqCE,SAAA,EAACC,EAAAA,EAAAA,KAAA,QAAAD,SAAM,WAAYC,EAAAA,EAAAA,KAAA,QAAMH,UAAU,gBAAeE,SAAEyT,EAAM6G,EAAMtW,YACnHsW,EAAMpW,MAAQ,IACbrE,EAAAA,EAAAA,MAAA,OAAKC,UAAU,sCAAqCE,SAAA,EAACC,EAAAA,EAAAA,KAAA,QAAAD,SAAM,WAAYC,EAAAA,EAAAA,KAAA,QAAMH,UAAU,gBAAeE,SAAEyT,EAAM6G,EAAMpW,aAEtHjE,EAAAA,EAAAA,KAAA,OAAKH,UAAU,4CACfD,EAAAA,EAAAA,MAAA,OAAKC,UAAU,+BAA8BE,SAAA,EAACC,EAAAA,EAAAA,KAAA,QAAMH,UAAU,cAAaE,SAAC,WAAYC,EAAAA,EAAAA,KAAA,QAAMH,UAAU,YAAWE,SAAEyT,EAAM6G,EAAMtc,mBAKrI6B,EAAAA,EAAAA,MAAA,OAAAG,SAAA,EACEC,EAAAA,EAAAA,KAAA,OAAKH,UAAU,2BAA0BE,SAAC,cAC1CH,EAAAA,EAAAA,MAAA,OAAKC,WAAWC,EAAAA,EAAAA,GACd,+BACU,SAAVhC,EAAmB,iCAAmC,8BACtDiC,SAAA,EACAH,EAAAA,EAAAA,MAAA,OAAKC,UAAU,sCAAqCE,SAAA,EAACC,EAAAA,EAAAA,KAAA,QAAAD,SAAM,cAAeC,EAAAA,EAAAA,KAAA,QAAMH,UAAU,gBAAeE,SAAEyT,EAAM8G,EAAUzW,YAC3HjE,EAAAA,EAAAA,MAAA,OAAKC,UAAU,sCAAqCE,SAAA,EAACC,EAAAA,EAAAA,KAAA,QAAAD,SAAM,eAAgBC,EAAAA,EAAAA,KAAA,QAAMH,UAAU,gBAAeE,SAAEyT,EAAM8G,EAAUtW,iBAC5HpE,EAAAA,EAAAA,MAAA,OAAKC,UAAU,sCAAqCE,SAAA,EAACC,EAAAA,EAAAA,KAAA,QAAAD,SAAM,WAAYC,EAAAA,EAAAA,KAAA,QAAMH,UAAU,gBAAeE,SAAEyT,EAAM8G,EAAUvW,YACvHuW,EAAUrW,MAAQ,IACjBrE,EAAAA,EAAAA,MAAA,OAAKC,UAAU,sCAAqCE,SAAA,EAACC,EAAAA,EAAAA,KAAA,QAAAD,SAAM,WAAYC,EAAAA,EAAAA,KAAA,QAAMH,UAAU,gBAAeE,SAAEyT,EAAM8G,EAAUrW,aAE1HjE,EAAAA,EAAAA,KAAA,OAAKH,UAAU,4CACfD,EAAAA,EAAAA,MAAA,OAAKC,UAAU,+BAA8BE,SAAA,EAACC,EAAAA,EAAAA,KAAA,QAAMH,UAAU,cAAaE,SAAC,WAAYC,EAAAA,EAAAA,KAAA,QAAMH,UAAU,YAAWE,SAAEyT,EAAM8G,EAAUvc,sBAK3I6B,EAAAA,EAAAA,MAAA,OAAKC,UAAU,OAAME,SAAA,EACnBC,EAAAA,EAAAA,KAAA,OAAKH,UAAU,2BAA0BE,SAAC,mBAC1CH,EAAAA,EAAAA,MAAA,OAAKC,WAAWC,EAAAA,EAAAA,GACd,+BACU,SAAVhC,EAAmB,iCAAmC,8BACtDiC,SAAA,EACAH,EAAAA,EAAAA,MAAA,OAAKC,UAAU,sCAAqCE,SAAA,EAACC,EAAAA,EAAAA,KAAA,QAAAD,SAAM,cAAeC,EAAAA,EAAAA,KAAA,QAAMH,UAAU,gBAAeE,SAAEyT,EAAM+G,EAAQ1W,YACzHjE,EAAAA,EAAAA,MAAA,OAAKC,UAAU,sCAAqCE,SAAA,EAACC,EAAAA,EAAAA,KAAA,QAAAD,SAAM,eAAgBC,EAAAA,EAAAA,KAAA,QAAMH,UAAU,gBAAeE,SAAEyT,EAAM+G,EAAQvW,iBAC1HpE,EAAAA,EAAAA,MAAA,OAAKC,UAAU,sCAAqCE,SAAA,EAACC,EAAAA,EAAAA,KAAA,QAAAD,SAAM,WAAYC,EAAAA,EAAAA,KAAA,QAAMH,UAAU,gBAAeE,SAAEyT,EAAM+G,EAAQxW,YACrHwW,EAAQtW,MAAQ,IACfrE,EAAAA,EAAAA,MAAA,OAAKC,UAAU,sCAAqCE,SAAA,EAACC,EAAAA,EAAAA,KAAA,QAAAD,SAAM,WAAYC,EAAAA,EAAAA,KAAA,QAAMH,UAAU,gBAAeE,SAAEyT,EAAM+G,EAAQtW,aAExHjE,EAAAA,EAAAA,KAAA,OAAKH,UAAU,4CACfD,EAAAA,EAAAA,MAAA,OAAKC,UAAU,+BAA8BE,SAAA,EAACC,EAAAA,EAAAA,KAAA,QAAMH,UAAU,cAAaE,SAAC,WAAYC,EAAAA,EAAAA,KAAA,QAAMH,UAAU,YAAWE,SAAEyT,EAAM+G,EAAQxc,oBAjE/HiV,aA6ErB0D,KACC1W,EAAAA,EAAAA,KAAA,OAAKH,UAAU,kFAAiFE,UAC9FH,EAAAA,EAAAA,MAAA,OAAKC,WAAWC,EAAAA,EAAAA,GAAW,qEAAgF,SAAVhC,EAAmB,4BAA8B,0BAA0BiC,SAAA,EAC1KH,EAAAA,EAAAA,MAAA,MAAIC,UAAU,6BAA4BE,SAAA,CAAC,8BAClB2W,GAAqBrM,GAAGnB,MAAM,EAAG,OAG1DlJ,EAAAA,EAAAA,KAACpC,EAAAA,EAAkB,CACjBE,MAAOA,EACPC,MAAO2Y,GAAqB3Y,OAAS,EACrCC,MACEhB,MAAMC,QAAQyZ,GAAqB3T,WAAa2T,GAAqB3T,SAAS7F,OAC1EwZ,GAAqB3T,UACrBoB,EAAAA,EAAAA,IAAwBuS,IAE9BzY,SAAWI,IACTsY,GAAyBsD,IAAI,IAAWA,EAAMlX,SAAU1E,SAI5DuB,EAAAA,EAAAA,MAAA,OAAKC,UAAU,8BAA6BE,SAAA,EAC1CC,EAAAA,EAAAA,KAAA,UAAQE,QAASA,IAAMyW,GAAwB,MAAO9W,UAAU,qEAAoEE,SAAC,cAGrIC,EAAAA,EAAAA,KAAA,UACEE,QAASgG,UACP,MAAM9G,OA9gBO8G,OAAO/D,EAAOY,KACzC,MAAM/D,GAAO+D,GAAY,IAAI9D,OAC3B,CAACsB,EAAGC,IAAMD,GAAKlE,KAAKC,MAAMC,OAAOiE,EAAE5B,QAAU,KAAO,GACpD,GAEIb,EAAQ1B,KAAKC,MAAMC,OAAO4F,EAAMpE,OAAS,KAAO,EAEtD,GAAIiB,IAAQjB,EAMV,OALAiP,MACE,qBAAqBhO,EAAIuC,eACvB,uCAC8BxD,EAAMwD,eAAe,eAEhD,EAGT,MAAMgW,QAAYV,GAAqB1U,GACvC,IAAKoV,EAIH,OAHAvK,MACE,oIAEK,EAGT,MAAM0N,EAAU,CACd3X,UAAWA,GAAY,IAAI3F,IAAK4F,IAAC,IAAA2X,EAAA,MAAM,CACrChc,OAA4B,kBAAbqE,EAAErE,OAAsBqE,EAAErE,QAAU,OAADqE,QAAC,IAADA,GAAS,QAAR2X,EAAD3X,EAAGrE,cAAM,IAAAgc,OAAR,EAADA,EAAWrd,OAAQ,GACrEsB,OAAQvC,KAAKC,MAAMC,OAAOyG,EAAEpE,QAAU,KAAO,EAC7CC,KAAMmE,EAAEnE,MAAQ,MAElBwT,UAAW,IAAIlJ,MAGjB,IAEE,aADMyR,EAAAA,EAAAA,IAAUrD,EAAKmD,IACd,CACT,CAAE,MAAO/Z,GACPwJ,QAAQ4C,MAAM,0BAA2BpM,GACzC,MAAMka,GAAQ,OAADla,QAAC,IAADA,OAAC,EAADA,EAAGka,OAAQ,GAClBC,EAAM5T,QAAQ,OAADvG,QAAC,IAADA,OAAC,EAADA,EAAGsM,UAAW,IAMjC,MALa,sBAAT4N,EACF7N,MAAM,0FAENA,MAAM,kCAAoC8N,GAAOD,GAAQ,wBAEpD,CACT,GAge+BE,CAAqBrE,GAAsBA,GAAqB3T,UAAY,IACzF3D,GAAIuX,GAAwB,OAElC9W,UAAU,uEAAsEE,SACjF,wB,0EC5tBf,MAAMib,EAAiBte,IAAOA,GAAK,IAAIuK,QAAQ,gBAAiB,IAAIrK,OAE9Dqe,EAASA,CAACpV,EAAM7H,KACpB,IAAKA,EAAO,OAAO,KACnB,MAAMV,EAAwB,kBAAVU,EAAqBA,EAAa,OAALA,QAAK,IAALA,OAAK,EAALA,EAAOV,KACxD,OAAOuI,EAAKzE,KAAM0E,GAAMkV,EAAclV,EAAExI,QAAU0d,EAAc1d,KAAU,MAKtE4d,EAAgB,eAAArd,EAAAsd,EAAAxP,EAAAyP,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAA,IAACC,EAAIpY,UAAAvG,OAAA,QAAAwG,IAAAD,UAAA,GAAAA,UAAA,GAAG,CAAC,EAAGqY,EAAQrY,UAAAvG,OAAA,QAAAwG,IAAAD,UAAA,GAAAA,UAAA,GAAG,CAAC,EAAC,MAAM,CACnD+G,QAAyC,QAAlC3M,EAAc,QAAdsd,EAAEU,EAAKrR,eAAO,IAAA2Q,EAAAA,EAAIW,EAAStR,eAAO,IAAA3M,EAAAA,EAAI,GAC7C6M,YAAqD,QAA1CiB,EAAkB,QAAlByP,EAAES,EAAKnR,mBAAW,IAAA0Q,EAAAA,EAAIU,EAASpR,mBAAW,IAAAiB,EAAAA,EAAI,GACzDoG,YAAqD,QAA1CsJ,EAAkB,QAAlBC,EAAEO,EAAK9J,mBAAW,IAAAuJ,EAAAA,EAAIQ,EAAS/J,mBAAW,IAAAsJ,EAAAA,EAAI,GACzDrJ,UAA+C,QAAtCuJ,EAAgB,QAAhBC,EAAEK,EAAK7J,iBAAS,IAAAwJ,EAAAA,EAAIM,EAAS9J,iBAAS,IAAAuJ,EAAAA,EAAI,GACnDrJ,YAAqD,QAA1CuJ,EAAkB,QAAlBC,EAAEG,EAAK3J,mBAAW,IAAAwJ,EAAAA,EAAII,EAAS5J,mBAAW,IAAAuJ,EAAAA,EAAI,GACzDxJ,cAA2D,QAA9C0J,EAAoB,QAApBC,EAAEC,EAAK5J,qBAAa,IAAA2J,EAAAA,EAAIE,EAAS7J,qBAAa,IAAA0J,EAAAA,EAAI,GAChE,EAkwCD,EAhwC6BI,IAgCtB,IAhCuB,MAC5Bje,EAAK,iBACLgX,EAAgB,oBAChBC,EAAmB,WACnBiH,EAAU,cACVC,EAAa,iBACbC,EAAgB,SAChB5V,EAAQ,kBACRD,EAAiB,UACjBsN,EAAS,gBACTwI,EAAe,mBACf5H,EAAkB,aAClB6H,EAAY,gBACZC,EAAe,SACf3H,EAAQ,0BACR4H,EAAyB,0BACzBC,EAAyB,eACzBC,EAAc,qBACdC,EAAoB,wBACpBnH,EAAuB,YACvBoH,EAAW,eACXC,EAAc,sBACdtH,EAAqB,SACrBuH,EAAQ,WACRrM,EAAU,kBACVsM,EAAiB,qBACjBtH,EAAoB,aACpBuH,EAAY,kCACZC,EAAiC,0BACjCC,EAAyB,qBACzBC,EAAoB,sBACpBvH,GACDqG,EACC,MAAOmB,EAAOC,IAAY5e,EAAAA,EAAAA,UAAS,KAC5B6e,EAAkBC,IAAuB9e,EAAAA,EAAAA,UAAS,KAClD+e,EAAYC,KAAiBhf,EAAAA,EAAAA,UAAS,KACtCif,GAAcC,KAAmBlf,EAAAA,EAAAA,UAAS,KAC1Cmf,GAAQC,KAAapf,EAAAA,EAAAA,UAAS,KAC9BmT,GAAOkM,KAAYrf,EAAAA,EAAAA,UAAS,KAC5BoT,GAAWkM,KAAgBtf,EAAAA,EAAAA,UAAS,KACpCuf,GAAgBC,KAAqBxf,EAAAA,EAAAA,UAAS,KAE9Cyf,GAAeC,KAAoB1f,EAAAA,EAAAA,UAAS,KAC5C2f,GAAiBC,KAAsB5f,EAAAA,EAAAA,UAAS,KAChD6f,GAAoBC,KAAyB9f,EAAAA,EAAAA,UAAS,KACtD+f,GAAiBC,KAAsBhgB,EAAAA,EAAAA,UAAS,KAChDigB,GAAoBC,KAAyBlgB,EAAAA,EAAAA,UAAS,KACtDmgB,GAAgBC,KAAqBpgB,EAAAA,EAAAA,UAAS,KAC9CqgB,GAAmBC,KAAwBtgB,EAAAA,EAAAA,UAAS,KAGpDugB,GAAgBC,KAAqBxgB,EAAAA,EAAAA,UAAS,OAGrDO,EAAAA,EAAAA,WAAU,KACR,MAAMkgB,EAAY,CAChB9B,MAAOC,EACPC,iBAAkBC,EAClBC,WAAYC,GACZjX,SAAUmX,GACVC,OAAQC,GACRjM,MAAOkM,GACPjM,UAAWkM,GACXC,eAAgBC,GAChBC,cAAeC,GACfC,gBAAiBC,GACjBC,mBAAoBC,GACpBC,gBAAiBC,GACjBC,mBAAoBC,GACpBC,eAAgBC,GAChBC,kBAAmBC,IAGfI,EAAU3hB,IACd4hB,EAAAA,EAAAA,KAAWC,EAAAA,EAAAA,IAAW3H,EAAAA,GAAIla,GAAQ8hB,GAASJ,EAAU1hB,GAAM8hB,EAAKC,KAAKjiB,IAAKkiB,IAAC,CAAQjV,GAAIiV,EAAEjV,MAAOiV,EAAE1T,YAE9F2T,EAAS,CACbN,EAAO,SACPA,EAAO,oBACPA,EAAO,cACPA,EAAO,YACPA,EAAO,UACPA,EAAO,SACPA,EAAO,aACPA,EAAO,kBACPA,EAAO,iBACPA,EAAO,mBACPA,EAAO,sBACPA,EAAO,mBACPA,EAAO,sBACPA,EAAO,kBACPA,EAAO,sBAET,MAAO,IAAMM,EAAO/V,QAASgW,GAAMA,GAAKA,MACvC,IAGH,MAAMC,GAAiCA,CAAC/V,EAAOgW,EAAO1hB,KACpD,MAAM6H,EAAO7I,MAAMC,QAAQyX,EAASpR,YAAc,IAAIoR,EAASpR,YAAc,GAE7E,GADKuC,EAAK6D,KAAQ7D,EAAK6D,GAAS,CAAC,GAC7BgW,EAAM1d,SAAS,KAAM,CACvB,MAAO2d,EAAQC,GAASF,EAAMrP,MAAM,KACpCxK,EAAK6D,GAAS,IAAK7D,EAAK6D,GAAQ,CAACiW,GAAS,IAAM9Z,EAAK6D,GAAOiW,IAAW,CAAC,EAAI,CAACC,GAAQ5hB,GACvF,MACE6H,EAAK6D,GAAS,IAAK7D,EAAK6D,GAAQ,CAACgW,GAAQ1hB,GAE3Cue,EAA0B,aAAc1W,IAIpCga,GAA2BA,CAACrgB,EAAKkgB,EAAO1hB,KAC5CyhB,GAA+BjgB,EAAKkgB,EAAO1hB,IAIvC8hB,GAAqBC,EAAAA,OAAa,OAGxCjhB,EAAAA,EAAAA,WAAU,KACHsd,IAAc0D,GAAmBxJ,QAAU,OAC/C,CAAC8F,KAEJtd,EAAAA,EAAAA,WAAU,KACR,IAAKsd,EAAc,OAiBnB,KAdEc,EAAMhgB,QACNogB,EAAWpgB,QACXsgB,GAAatgB,QACbwgB,GAAOxgB,QACPwU,GAAMxU,QACNyU,GAAUzU,QACVwhB,GAAexhB,QACfghB,GAAgBhhB,QAChB8gB,GAAc9gB,QACdkhB,GAAmBlhB,QACnBohB,GAAgBphB,QAChBshB,GAAmBthB,QACnB0hB,GAAkB1hB,QAEC,OAErB,GAAI4iB,GAAmBxJ,UAAY8F,EAAa/R,GAAI,OAEpD,MAAM2V,EAAkB5D,EAAa5R,SAAW,CAAC,EAG3CyV,EAC0B,kBAAvB7D,EAAare,MAChBqe,EAAare,MACS,cAAtBqe,EAAanc,KACbmc,EAAare,OAAS,EACtBf,MAAMC,QAAQmf,EAAahZ,OAC3B7G,QAAO2jB,EAAAA,EAAAA,IAAe9D,EAAahZ,QAAU,GAC7C,EAON,GALAmZ,EAA0B,QAAS0D,GACnC1D,EAA0B,UAAWH,EAAata,SAAW,IAC7Dya,EAA0B,SAAUH,EAAapX,QAAU,aAC3DuX,EAA0B,iBAAkBH,EAAatR,gBAAkB,IAEjD,cAAtBsR,EAAanc,KAAsB,CACrC,MAAMqD,GAAc8Y,EAAa9Y,YAAc,IAAIlG,IAAKoD,IAAC,IAAA2f,EAAA,MAAM,CAC7DlgB,KAAMgb,EAAOyD,GAAgBle,EAAEP,MAC/BmgB,MAAOnF,EAAOiD,GAAiB1d,EAAE4f,OACjCC,KAAMpF,EAAO+C,GAAexd,EAAE6f,MAC9BC,UAAWrF,EAAOmD,GAAoB5d,EAAE8f,WACxC9O,MAAOyJ,EAAOqD,GAAiB9d,EAAEgR,OACjC/H,QAASwR,EAAO2D,GAAmBpe,EAAEiJ,SACrCkI,UAAW3U,MAAMC,QAAQuD,EAAEmR,WACvBnR,EAAEmR,UACCvU,IAAKmD,IACJ,MAAMggB,EAAOtF,EAAOuD,GAAoBje,GACxC,OAAOggB,EAAO,IAAKA,EAAMxX,SAAUxI,EAAEwI,UAAY,GAAM,OAExDvL,OAAOC,SACV,GACJgU,UAAWjR,EAAEiR,QACbK,KAAwB,kBAAXtR,EAAEsR,KAAoBtR,EAAEsR,MAAa,QAANqO,EAAA3f,EAAEsR,YAAI,IAAAqO,OAAA,EAANA,EAAQ7iB,OAAQ,GAC5DkN,QAAS0Q,EAAc1a,EAAEgK,QAASwV,GAClCnO,MAAOrR,EAAEqR,OAAS,MAEpB0K,EAA0B,aAAcjZ,EAC1C,KAAO,CACL,MAAMF,GAASgZ,EAAahZ,OAAS,IAAIhG,IAAKC,IAAC,IAAAmjB,EAAAC,EAAAC,EAnMjC7a,EAAM8a,EAmM2B,MAAM,CACnDrP,KAAM2J,EAAOiC,EAAO7f,EAAEiU,MACtBsP,gBAC+B,kBAAtBvjB,EAAEujB,gBAA+BvjB,EAAEujB,iBAAmC,QAAjBJ,EAAAnjB,EAAEujB,uBAAe,IAAAJ,OAAA,EAAjBA,EAAmB5O,cAAe,GAChGL,UAAWvU,MAAMC,QAAQI,EAAEkU,WAAalU,EAAEkU,UAAUnU,IAAK4F,GAAMiY,EAAOqC,EAAYta,IAAIxF,OAAOC,SAAW,GACxGojB,qBACoC,kBAA3BxjB,EAAEwjB,qBACLxjB,EAAEwjB,sBACoB,QAAtBJ,EAAApjB,EAAEwjB,4BAAoB,IAAAJ,OAAA,EAAtBA,EAAwB7O,cAAe,GAC7CnI,QAASwR,EAAOuC,GAAcngB,EAAEoM,SAChC+H,MAAOyJ,EAAOyC,GAAQrgB,EAAEmU,OACxBE,OA9MY7L,EA8MM6L,GA9MAiP,EA8MOtjB,EAAEqU,MA9MA1U,MAAMC,QAAQ0jB,GAAOA,EAAIvjB,IAAKjB,GAAM8e,EAAOpV,EAAM1J,IAAIqB,OAAOC,SAAW,IA+MlGkU,UAAW3U,MAAMC,QAAQI,EAAEsU,WACvBtU,EAAEsU,UACCvU,IAAKmD,IAAO,IAADugB,EAAAC,EACV,MAAMR,EAAOtF,EAAOtJ,GAAWpR,GAC/B,OAAOggB,EAAO,IAAKA,EAAMxX,SAAUxI,EAAEwI,UAAY,EAAGiY,MAA4B,QAAvBF,EAAS,QAATC,EAAExgB,EAAEygB,aAAK,IAAAD,EAAAA,EAAIR,EAAKS,aAAK,IAAAF,EAAAA,EAAI,GAAM,OAE3FtjB,OAAOC,SACV,GACJgU,UAAWpU,EAAEoU,QACbK,KAAwB,kBAAXzU,EAAEyU,KAAoBzU,EAAEyU,MAAa,QAAN4O,EAAArjB,EAAEyU,YAAI,IAAA4O,OAAA,EAANA,EAAQpjB,OAAQ,GAC5DkN,QAAS0Q,EAAc7d,EAAEmN,QAASwV,GAClCnO,MAAOxU,EAAEwU,OAAS,MAEpB0K,EAA0B,QAASnZ,EACrC,CAEA0c,GAAmBxJ,QAAU8F,EAAa/R,IACzC,CACD+R,EACAc,EACAI,EACAE,GACAE,GACAhM,GACAC,GACA+M,GACAR,GACAF,GACAI,GACAE,GACAE,GACAI,GACArC,KAIFzd,EAAAA,EAAAA,WAAU,KACR,IAAKsd,GAAsC,cAAtBA,EAAanc,KAAsB,OACxD,MAAMghB,EAAW1kB,QAAO2jB,EAAAA,EAAAA,IAAexL,EAAStR,OAAS,MAAQ,EAC7D6d,KAAcvM,EAAS3W,OAAS,IAClCwe,EAA0B,QAAS0E,IAEpC,CAAC7E,EAAc1H,EAAStR,MAAOmZ,EAA2B2D,EAAAA,KAG7D,MAAMgB,GAAkBlkB,MAAMC,QAAuB,OAAfkf,QAAe,IAAfA,OAAe,EAAfA,EAAiB/Y,OACnD+Y,EAAgB/Y,MAChBpG,MAAMC,QAAuB,OAAfkf,QAAe,IAAfA,OAAe,EAAfA,EAAiB7Y,YAC/B6Y,EAAgB7Y,WAChB,IAGNxE,EAAAA,EAAAA,WAAU,KACR,IAAKsd,GAAsC,cAAtBA,EAAanc,KAAsB,OACxD,MACMghB,GADOvM,EAASpR,YAAc,IACdrE,OACpB,CAACD,EAAKwB,IAAMxB,EAAMzC,QAAO4kB,EAAAA,EAAAA,IAAwB3gB,EAAG,EAAGke,KAAmB,GAC1E,GAEEuC,KAAcvM,EAAS3W,OAAS,IAClCwe,EAA0B,QAAS0E,IAEpC,CAAC7E,EAAc1H,EAASpR,WAAYob,GAAgBnC,IAqCrD,OACE3c,EAAAA,EAAAA,MAAA,OAAAG,SAAA,EAEEC,EAAAA,EAAAA,KAACohB,EAAAA,EAAU,CAACC,KAAMvM,EAAkBwM,GAAIvB,EAAAA,SAAehgB,UACrDH,EAAAA,EAAAA,MAAC2hB,EAAAA,GAAM,CAACD,GAAG,MAAMzhB,UAAU,gBAAgB2hB,QAASA,KAAQzM,GAAoB,GAAQgK,GAAkB,OAAShf,SAAA,EACjHC,EAAAA,EAAAA,KAACohB,EAAAA,EAAWK,MAAK,CAACH,GAAIvB,EAAAA,SAAgB2B,MAAM,wBAAwBC,UAAU,YAAYC,QAAQ,cAAcC,MAAM,uBAAuBC,UAAU,cAAcC,QAAQ,YAAWhiB,UACtLC,EAAAA,EAAAA,KAAA,OAAKH,UAAU,4CAEjBG,EAAAA,EAAAA,KAAA,OAAKH,UAAU,qDAAoDE,UACjEC,EAAAA,EAAAA,KAACohB,EAAAA,EAAWK,MAAK,CAACH,GAAIvB,EAAAA,SAAgB2B,MAAM,wBAAwBC,UAAU,qBAAqBC,QAAQ,wBAAwBC,MAAM,uBAAuBC,UAAU,wBAAwBC,QAAQ,qBAAoBhiB,UAC5NH,EAAAA,EAAAA,MAAC2hB,EAAAA,GAAOS,MAAK,CACXniB,WACEC,EAAAA,EAAAA,GACE,2CACU,SAAVhC,EAAmB,4BAA8B,4BAEpDiC,SAAA,EAEDH,EAAAA,EAAAA,MAAA,OAAKC,UAAU,yCAAwCE,SAAA,EACrDC,EAAAA,EAAAA,KAACuhB,EAAAA,GAAOU,MAAK,CAACpiB,UAAU,sBAAqBE,SAAE+e,GAAiB,qBAAoB,4BACpF9e,EAAAA,EAAAA,KAAA,UAAQE,QAASA,KAAQ6U,GAAoB,GAAQgK,GAAkB,OAAUlf,UAAU,oCAAoC,aAAW,eAAcE,UACtJC,EAAAA,EAAAA,KAACkiB,EAAAA,EAAS,CAACriB,UAAU,kBAGzBG,EAAAA,EAAAA,KAAA,OAAKH,UAAU,YAAWE,SACvB+e,IACClf,EAAAA,EAAAA,MAAAqY,EAAAA,SAAA,CAAAlY,SAAA,EACEH,EAAAA,EAAAA,MAAA,OAAAG,SAAA,EACEC,EAAAA,EAAAA,KAAA,SAAOH,UAAU,kEAAiEE,SAAC,YACnFC,EAAAA,EAAAA,KAAA,SACEC,KAAK,OACLjC,MAAO8gB,GAAexhB,KACtBW,SAAW0C,GAAMoe,GAAkB,IAAKD,GAAgBxhB,KAAMqD,EAAEC,OAAO5C,QACvE6B,WAAWC,EAAAA,EAAAA,GACT,uCACU,SAAVhC,EAAmB,yCAA2C,yCAC9D,uDAEFiD,YAAY,kBAGhBnB,EAAAA,EAAAA,MAAA,OAAAG,SAAA,EACEC,EAAAA,EAAAA,KAAA,SAAOH,UAAU,kEAAiEE,SAAC,cACnFC,EAAAA,EAAAA,KAAA,SACEC,KAAK,SACLjC,MAAO8gB,GAAe/V,SACtB9K,SAAW0C,GAAMoe,GAAkB,IAAKD,GAAgB/V,SAAUpI,EAAEC,OAAO5C,QAC3E6B,WAAWC,EAAAA,EAAAA,GACT,uCACU,SAAVhC,EAAmB,yCAA2C,yCAC9D,uDAEFiD,YAAY,SACZF,IAAI,UAGRjB,EAAAA,EAAAA,MAAA,OAAKC,UAAU,yBAAwBE,SAAA,EACrCC,EAAAA,EAAAA,KAAA,UAAQE,QA7DEiiB,KAC9BpD,GAAkB,OA4D4Clf,WAAWC,EAAAA,EAAAA,GAAW,2CAAsD,SAAVhC,EAAmB,8CAAgD,+CAA+CiC,SAAC,cAC/NC,EAAAA,EAAAA,KAAA,UAAQE,QA/EFgG,UAC1B,IAAK4Y,GAAexhB,OAASwhB,GAAe/V,UAAYqZ,MAAMtD,GAAe/V,WAAaxM,OAAOuiB,GAAe/V,WAAa,EAC3H6T,EAAS,wFAGX,UACQhC,EAAAA,EAAAA,KAAUtN,EAAAA,EAAAA,IAAIkK,EAAAA,GAAI,gBAAiBsH,GAAezU,IAAK,CAC3D/M,KAAMwhB,GAAexhB,KAAKV,OAC1BmM,SAAUxM,OAAOuiB,GAAe/V,YAElCwH,EAAW,0CACXwO,GAAkB,KACpB,CAAE,MAAOhS,GACP6P,EAAS,oCAAiC7P,EAAME,UAClD,GAiE0D/O,SAAUyV,EAAW9T,WAAWC,EAAAA,EAAAA,GAAW,2CAA4C6T,EAAY,iCAA6C,SAAV7V,EAAmB,2CAA6C,4CAA4CiC,SACrR4T,EAAY,eAAiB,sBAKpC/T,EAAAA,EAAAA,MAAAqY,EAAAA,SAAA,CAAAlY,SAAA,EACEH,EAAAA,EAAAA,MAAA,OAAAG,SAAA,EACEC,EAAAA,EAAAA,KAAA,SAAOH,UAAU,kEAAiEE,SAAC,YACnFC,EAAAA,EAAAA,KAAA,SACEC,KAAK,OACLjC,MAAOge,EAAW1e,KAClBW,SAAW0C,GAAMsb,EAAc,IAAKD,EAAY1e,KAAMqD,EAAEC,OAAO5C,QAC/D6B,WAAWC,EAAAA,EAAAA,GACT,uCACU,SAAVhC,EAAmB,yCAA2C,yCAC9D,uDAEFiD,YAAY,kBAGhBnB,EAAAA,EAAAA,MAAA,OAAAG,SAAA,EACEC,EAAAA,EAAAA,KAAA,SAAOH,UAAU,kEAAiEE,SAAC,cACnFC,EAAAA,EAAAA,KAAA,SACEC,KAAK,SACLjC,MAAOge,EAAWjT,SAClB9K,SAAW0C,GAAMsb,EAAc,IAAKD,EAAYjT,SAAUpI,EAAEC,OAAO5C,QACnE6B,WAAWC,EAAAA,EAAAA,GACT,uCACU,SAAVhC,EAAmB,yCAA2C,yCAC9D,uDAEFiD,YAAY,SACZF,IAAI,UAGRjB,EAAAA,EAAAA,MAAA,OAAKC,UAAU,yBAAwBE,SAAA,EACrCC,EAAAA,EAAAA,KAAA,UAAQE,QAASA,IAAM6U,GAAoB,GAAQlV,WAAWC,EAAAA,EAAAA,GAAW,2CAAsD,SAAVhC,EAAmB,8CAAgD,+CAA+CiC,SAAC,cACxOC,EAAAA,EAAAA,KAAA,UAAQE,QAASgc,EAAkBhe,SAAUyV,EAAW9T,WAAWC,EAAAA,EAAAA,GAAW,2CAA4C6T,EAAY,iCAA6C,SAAV7V,EAAmB,2CAA6C,4CAA4CiC,SAClR4T,EAAY,eAAiB,qBAMxC/T,EAAAA,EAAAA,MAAA,OAAKC,UAAU,OAAME,SAAA,EACnBH,EAAAA,EAAAA,MAAA,MAAIC,UAAU,4DAA2DE,SAAA,CAAC,oCACzCsG,EAAkB,gBAE9B,IAApBC,EAASpJ,QACR8C,EAAAA,EAAAA,KAAA,KAAGH,UAAU,2CAA0CE,SAAC,sCAExDC,EAAAA,EAAAA,KAAA,MAAIH,UAAU,YAAWE,SACtBuG,EAASlJ,IAAKqM,IACb7J,EAAAA,EAAAA,MAAA,MAAqBC,WAAWC,EAAAA,EAAAA,GAAW,mDAA8D,SAAVhC,EAAmB,cAAgB,eAAeiC,SAAA,EAC/IH,EAAAA,EAAAA,MAAA,QAAMC,UAAU,UAASE,SAAA,CACtB0J,EAAQnM,KAAK,KAAGmM,EAAQV,SAAS,gBAEpCnJ,EAAAA,EAAAA,MAAA,OAAKC,UAAU,aAAYE,SAAA,EACzBC,EAAAA,EAAAA,KAAA,UAAQE,QAASA,IA9IhBuJ,KACzBsV,GAAkBtV,IA6I6B4Y,CAAkB5Y,GAAU5J,UAAU,kFAAkFgC,MAAM,qBAAkB,aAAY,UAAU4H,EAAQnM,OAAOyC,UAC1MC,EAAAA,EAAAA,KAAC+Z,EAAAA,EAAU,CAACla,UAAU,eAExBG,EAAAA,EAAAA,KAAA,UAAQE,QAASA,IA1JfgG,WAC1B,UACQoc,EAAAA,EAAAA,KAAUhV,EAAAA,EAAAA,IAAIkK,EAAAA,GAAI,gBAAiB+K,IACzChS,EAAW,uCACb,CAAE,MAAOxD,GACP6P,EAAS,kCAA+B7P,EAAME,UAChD,GAoJ+CuV,CAAoB/Y,EAAQY,IAAKxK,UAAU,gFAAgFgC,MAAM,uBAAoB,aAAY,YAAY4H,EAAQnM,OAAOyC,UACjNC,EAAAA,EAAAA,KAACga,EAAAA,EAAS,CAACna,UAAU,mBATlB4J,EAAQY,uBAwBnCrK,EAAAA,EAAAA,KAACohB,EAAAA,EAAU,CAACC,KAA0B,OAApBlF,EAA0BmF,GAAIvB,EAAAA,SAAehgB,UAC7DH,EAAAA,EAAAA,MAAC2hB,EAAAA,GAAM,CAACD,GAAG,MAAMzhB,UAAU,gBAAgB2hB,QAASA,IAAMjN,EAAmB,MAAMxU,SAAA,EACjFC,EAAAA,EAAAA,KAACohB,EAAAA,EAAWK,MAAK,CAACH,GAAIvB,EAAAA,SAAgB2B,MAAM,wBAAwBC,UAAU,YAAYC,QAAQ,cAAcC,MAAM,uBAAuBC,UAAU,cAAcC,QAAQ,YAAWhiB,UACtLC,EAAAA,EAAAA,KAAA,OAAKH,UAAU,4CAEjBG,EAAAA,EAAAA,KAAA,OAAKH,UAAU,qDAAoDE,UACjEC,EAAAA,EAAAA,KAACohB,EAAAA,EAAWK,MAAK,CAACH,GAAIvB,EAAAA,SAAgB2B,MAAM,wBAAwBC,UAAU,qBAAqBC,QAAQ,wBAAwBC,MAAM,uBAAuBC,UAAU,wBAAwBC,QAAQ,qBAAoBhiB,UAC5NH,EAAAA,EAAAA,MAAC2hB,EAAAA,GAAOS,MAAK,CAACniB,WAAWC,EAAAA,EAAAA,GAAW,yEAAoF,SAAVhC,EAAmB,4BAA8B,4BAA4BiC,SAAA,EACzLH,EAAAA,EAAAA,MAAC2hB,EAAAA,GAAOU,MAAK,CAACpiB,UAAU,6DAA4DE,SAAA,CAAC,uBAEnFC,EAAAA,EAAAA,KAAA,UAAQE,QAASA,IAAMqU,EAAmB,MAAO1U,UAAU,oCAAoC,aAAW,kBAAiBE,UACzHC,EAAAA,EAAAA,KAACkiB,EAAAA,EAAS,CAACriB,UAAU,iBAGxBsc,IACCvc,EAAAA,EAAAA,MAAAqY,EAAAA,SAAA,CAAAlY,SAAA,CAC6B,eAAX,OAAfoc,QAAe,IAAfA,OAAe,EAAfA,EAAiBlc,OAChBD,EAAAA,EAAAA,KAACyiB,EAAAA,EAAqB,CAACC,MAAOvG,EAAgB7Y,YAAc4d,GAAiByB,KAAM,CAAEC,KAAM,GAAKtJ,YAAY,WAAWuJ,gBAAgB,KAEvI7iB,EAAAA,EAAAA,KAAC8iB,EAAAA,EAAY,CAAC1f,MAAO8d,GAAiB6B,cAAc,EAAOC,cAAc,EAAM1J,YAAY,cAE7F1Z,EAAAA,EAAAA,MAAA,OAAKC,UAAU,0BAAyBE,SAAA,EACtCH,EAAAA,EAAAA,MAAA,KAAGC,UAAU,cAAaE,SAAA,CAAC,WAASoc,EAAgBnX,QAAU,gBAC9DpF,EAAAA,EAAAA,MAAA,KAAGC,UAAU,cAAaE,SAAA,CAAC,iBAAeoc,EAAgBrR,gBAAkB,iBACtD,eAAX,OAAfqR,QAAe,IAAfA,OAAe,EAAfA,EAAiBlc,OACjCL,EAAAA,EAAAA,MAAA,KAAGC,UAAU,cAAaE,SAAA,CAAC,uBAErBoc,EAAgB7Y,YAAc,IAAIrE,OAClC,CAACD,EAAKwB,IAAMxB,EAAMzC,QAAO4kB,EAAAA,EAAAA,IAAwB3gB,EAAG,EAAGke,KAAmB,GAC1E,GACCnd,eAAe,YAIW,kBAA1B4a,EAAgBpe,QACxB6B,EAAAA,EAAAA,MAAA,KAAGC,UAAU,cAAaE,SAAA,CAAC,uBAGtB/C,MAAMC,QAAuB,OAAfkf,QAAe,IAAfA,OAAe,EAAfA,EAAiB/Y,OAC3B7G,QAAO2jB,EAAAA,EAAAA,IAAe/D,EAAgB/Y,QAAU,GAChD7G,QAAsB,OAAf4f,QAAe,IAAfA,OAAe,EAAfA,EAAiBpe,QAAS,IACrCwD,eAAe,+BAiBfvB,EAAAA,EAAAA,KAACohB,EAAAA,EAAU,CAACC,KAAuB,OAAjBjF,EAAuBkF,GAAIvB,EAAAA,SAAehgB,UAC1DH,EAAAA,EAAAA,MAAC2hB,EAAAA,GAAM,CAACD,GAAG,MAAMzhB,UAAU,gBAAgB2hB,QAASA,IAAMnF,EAAgB,MAAMtc,SAAA,EAC9EC,EAAAA,EAAAA,KAACohB,EAAAA,EAAWK,MAAK,CAACH,GAAIvB,EAAAA,SAAgB2B,MAAM,wBAAwBC,UAAU,YAAYC,QAAQ,cAAcC,MAAM,uBAAuBC,UAAU,cAAcC,QAAQ,YAAWhiB,UACtLC,EAAAA,EAAAA,KAAA,OAAKH,UAAU,4CAEjBG,EAAAA,EAAAA,KAAA,OAAKH,UAAU,qDAAoDE,UACjEC,EAAAA,EAAAA,KAACohB,EAAAA,EAAWK,MAAK,CAACH,GAAIvB,EAAAA,SAAgB2B,MAAM,wBAAwBC,UAAU,qBAAqBC,QAAQ,wBAAwBC,MAAM,uBAAuBC,UAAU,wBAAwBC,QAAQ,qBAAoBhiB,UAC5NH,EAAAA,EAAAA,MAAC2hB,EAAAA,GAAOS,MAAK,CAACniB,WAAWC,EAAAA,EAAAA,GAAW,yEAAoF,SAAVhC,EAAmB,4BAA8B,4BAA4BiC,SAAA,EACzLH,EAAAA,EAAAA,MAAC2hB,EAAAA,GAAOU,MAAK,CAACpiB,UAAU,6DAA4DE,SAAA,CAAC,iBAEnFC,EAAAA,EAAAA,KAAA,UAAQE,QAASA,IAAMmc,EAAgB,MAAOxc,UAAU,oCAAoC,aAAW,oBAAgBE,UACrHC,EAAAA,EAAAA,KAACkiB,EAAAA,EAAS,CAACriB,UAAU,kBAIkB,eAAX,OAAZuc,QAAY,IAAZA,OAAY,EAAZA,EAAcnc,MAAuByU,EAASpR,YAAc,GAAKoR,EAAStR,OAAS,IAEpFhG,IAAI,CAACkO,EAAK9L,KAAG,IAAAyjB,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAA,OAC5BxkB,EAAAA,EAAAA,MAAA,OAAeC,UAAU,kEAAiEE,SAAA,EACxFC,EAAAA,EAAAA,KAAA,MAAIH,UAAU,mBAAkBE,SAAyB,eAAX,OAAZqc,QAAY,IAAZA,OAAY,EAAZA,EAAcnc,MAAuB,YAAYT,EAAM,IAAM,WAAWA,EAAM,MAExF,eAAX,OAAZ4c,QAAY,IAAZA,OAAY,EAAZA,EAAcnc,OACbL,EAAAA,EAAAA,MAAA,OAAKC,UAAU,wCAAuCE,SAAA,EACpDH,EAAAA,EAAAA,MAAA,OAAAG,SAAA,EACEC,EAAAA,EAAAA,KAAA,SAAOH,UAAU,iCAAgCE,SAAC,UAClDC,EAAAA,EAAAA,KAACqkB,EAAAA,EAAc,CAACxiB,MAAM,OAAOyiB,MAAM,eAAKC,QAAS7F,GAAgB8F,SAAUlZ,EAAIrL,MAAQ,KAAMwkB,UAAU,EAAOC,kBAAoBvoB,GAAM0jB,GAAyBrgB,EAAK,OAAQrD,SAEhLyD,EAAAA,EAAAA,MAAA,OAAAG,SAAA,EACEC,EAAAA,EAAAA,KAAA,SAAOH,UAAU,iCAAgCE,SAAC,WAClDC,EAAAA,EAAAA,KAACqkB,EAAAA,EAAc,CAACxiB,MAAM,QAAQyiB,MAAM,eAAKC,QAASrG,GAAiBsG,SAAUlZ,EAAI8U,OAAS,KAAMqE,UAAU,EAAOC,kBAAoBvoB,GAAM0jB,GAAyBrgB,EAAK,QAASrD,SAEpLyD,EAAAA,EAAAA,MAAA,OAAAG,SAAA,EACEC,EAAAA,EAAAA,KAAA,SAAOH,UAAU,iCAAgCE,SAAC,YAClDC,EAAAA,EAAAA,KAACqkB,EAAAA,EAAc,CAACxiB,MAAM,SAASyiB,MAAM,eAAKC,QAASvG,GAAewG,SAAUlZ,EAAI+U,MAAQ,KAAMoE,UAAU,EAAOC,kBAAoBvoB,GAAM0jB,GAAyBrgB,EAAK,OAAQrD,SAEjLyD,EAAAA,EAAAA,MAAA,OAAAG,SAAA,EACEC,EAAAA,EAAAA,KAAA,SAAOH,UAAU,iCAAgCE,SAAC,eAClDC,EAAAA,EAAAA,KAACqkB,EAAAA,EAAc,CAACxiB,MAAM,YAAYyiB,MAAM,eAAKC,QAASnG,GAAoBoG,SAAUlZ,EAAIgV,WAAa,KAAMmE,UAAU,EAAOC,kBAAoBvoB,GAAM0jB,GAAyBrgB,EAAK,YAAarD,SAEnMyD,EAAAA,EAAAA,MAAA,OAAAG,SAAA,EACEC,EAAAA,EAAAA,KAAA,SAAOH,UAAU,iCAAgCE,SAAC,YAClDC,EAAAA,EAAAA,KAACqkB,EAAAA,EAAc,CAACxiB,MAAM,SAASyiB,MAAM,eAAKC,QAASjG,GAAiBkG,SAAUlZ,EAAIkG,OAAS,KAAMiT,UAAU,EAAOC,kBAAoBvoB,GAAM0jB,GAAyBrgB,EAAK,QAASrD,SAErLyD,EAAAA,EAAAA,MAAA,OAAAG,SAAA,EACEC,EAAAA,EAAAA,KAAA,SAAOH,UAAU,iCAAgCE,SAAC,iBAClDC,EAAAA,EAAAA,KAACqkB,EAAAA,EAAc,CAACxiB,MAAM,cAAWyiB,MAAM,eAAKC,QAAS3F,GAAmB4F,SAAUlZ,EAAI7B,SAAW,KAAMgb,UAAU,EAAOC,kBAAoBvoB,GAAM0jB,GAAyBrgB,EAAK,UAAWrD,SAE7LyD,EAAAA,EAAAA,MAAA,OAAKC,UAAU,gBAAeE,SAAA,EAC5BC,EAAAA,EAAAA,KAAA,SAAOH,UAAU,iCAAgCE,SAAC,eAClDC,EAAAA,EAAAA,KAACqkB,EAAAA,EAAc,CACbxiB,MAAM,YACNyiB,MAAM,SACNC,QAAS/F,GACTgG,SAAUlZ,EAAIqG,WAAa,GAC3B8S,UAAU,EACVC,kBAAoBC,GAAQ9E,GAAyBrgB,EAAK,YAAamlB,EAAIvnB,IAAKmD,IAAC,CAAQjD,KAAMiD,EAAEjD,KAAMyL,SAAUxI,EAAEwI,UAAY,YAKnInJ,EAAAA,EAAAA,MAAA,OAAAG,SAAA,EACEC,EAAAA,EAAAA,KAAA,SAAOH,UAAU,iCAAgCE,SAAC,eAClDC,EAAAA,EAAAA,KAAA,SAAOC,KAAK,WAAW2kB,UAAWtZ,EAAImG,QAASxT,SAAW0C,GAAM8e,GAA+BjgB,EAAK,UAAWmB,EAAEC,OAAOgkB,SAAU/kB,UAAU,gBAE9ID,EAAAA,EAAAA,MAAA,OAAAG,SAAA,EACEC,EAAAA,EAAAA,KAAA,SAAOH,UAAU,iCAAgCE,SAAC,qBAClDC,EAAAA,EAAAA,KAAA,SACEC,KAAK,OACLjC,MAA2B,kBAAbsN,EAAIwG,KAAoBxG,EAAIwG,MAAe,QAARmR,EAAA3X,EAAIwG,YAAI,IAAAmR,OAAA,EAARA,EAAU3lB,OAAQ,GACnEW,SAAW0C,GAAM8e,GAA+BjgB,EAAK,OAAQmB,EAAEC,OAAO5C,OACtE6B,WAAWC,EAAAA,EAAAA,GAAW,uCAAkD,SAAVhC,EAAmB,yCAA2C,yCAA0C,6DAG1K8B,EAAAA,EAAAA,MAAA,OAAKC,UAAU,gBAAeE,SAAA,EAC5BC,EAAAA,EAAAA,KAAA,SAAOH,UAAU,iCAAgCE,SAAC,kBAClDC,EAAAA,EAAAA,KAAA,SACEC,KAAK,OACLjC,OAAkB,QAAXklB,EAAA5X,EAAId,eAAO,IAAA0Y,OAAA,EAAXA,EAAa1Y,UAAW,GAC/BvM,SAAW0C,GAAM8e,GAA+BjgB,EAAK,kBAAmBmB,EAAEC,OAAO5C,OACjF6B,WAAWC,EAAAA,EAAAA,GAAW,uCAAkD,SAAVhC,EAAmB,yCAA2C,yCAA0C,6DAG1K8B,EAAAA,EAAAA,MAAA,OAAAG,SAAA,EACEC,EAAAA,EAAAA,KAAA,SAAOH,UAAU,iCAAgCE,SAAC,iBAClDC,EAAAA,EAAAA,KAAA,SACEC,KAAK,OACLjC,OAAkB,QAAXmlB,EAAA7X,EAAId,eAAO,IAAA2Y,OAAA,EAAXA,EAAazY,cAAe,GACnCzM,SAAW0C,GAAM8e,GAA+BjgB,EAAK,sBAAuBmB,EAAEC,OAAO5C,OACrF6B,WAAWC,EAAAA,EAAAA,GAAW,uCAAkD,SAAVhC,EAAmB,yCAA2C,yCAA0C,6DAG1K8B,EAAAA,EAAAA,MAAA,OAAAG,SAAA,EACEC,EAAAA,EAAAA,KAAA,SAAOH,UAAU,iCAAgCE,SAAC,0BAClDH,EAAAA,EAAAA,MAAA,UACE5B,OAAkB,QAAXolB,EAAA9X,EAAId,eAAO,IAAA4Y,OAAA,EAAXA,EAAarR,cAAe,GACnC9T,SAAW0C,GAAM8e,GAA+BjgB,EAAK,sBAAuBmB,EAAEC,OAAO5C,OACrF6B,WAAWC,EAAAA,EAAAA,GAAW,uCAAkD,SAAVhC,EAAmB,yCAA2C,yCAA0C,uDAAuDiC,SAAA,EAE7NC,EAAAA,EAAAA,KAAA,UAAQhC,MAAM,GAAE+B,SAAC,gBACjBC,EAAAA,EAAAA,KAAA,UAAQhC,MAAM,QAAO+B,SAAC,eACtBC,EAAAA,EAAAA,KAAA,UAAQhC,MAAM,SAAQ+B,SAAC,qBACvBC,EAAAA,EAAAA,KAAA,UAAQhC,MAAM,UAAS+B,SAAC,cACxBC,EAAAA,EAAAA,KAAA,UAAQhC,MAAM,OAAM+B,SAAC,uBAGK,UAAlB,QAAXsjB,EAAA/X,EAAId,eAAO,IAAA6Y,OAAA,EAAXA,EAAatR,eACZnS,EAAAA,EAAAA,MAAA,OAAAG,SAAA,EACEC,EAAAA,EAAAA,KAAA,SAAOH,UAAU,iCAAgCE,SAAC,sBAClDC,EAAAA,EAAAA,KAAA,SACEC,KAAK,OACLjC,OAAkB,QAAXslB,EAAAhY,EAAId,eAAO,IAAA8Y,OAAA,EAAXA,EAAatR,YAAa,GACjC/T,SAAW0C,GAAM8e,GAA+BjgB,EAAK,oBAAqBmB,EAAEC,OAAO5C,OACnF6B,WAAWC,EAAAA,EAAAA,GAAW,uCAAkD,SAAVhC,EAAmB,yCAA2C,yCAA0C,4DAI9I,YAAlB,QAAXylB,EAAAjY,EAAId,eAAO,IAAA+Y,OAAA,EAAXA,EAAaxR,eACZnS,EAAAA,EAAAA,MAAA,OAAAG,SAAA,EACEC,EAAAA,EAAAA,KAAA,SAAOH,UAAU,iCAAgCE,SAAC,6BAClDC,EAAAA,EAAAA,KAAA,SACEC,KAAK,OACLjC,OAAkB,QAAXwlB,EAAAlY,EAAId,eAAO,IAAAgZ,OAAA,EAAXA,EAAavR,gBAAiB,GACrChU,SAAW0C,GAAM8e,GAA+BjgB,EAAK,wBAAyBmB,EAAEC,OAAO5C,OACvF6B,WAAWC,EAAAA,EAAAA,GAAW,uCAAkD,SAAVhC,EAAmB,yCAA2C,yCAA0C,4DAI9I,aAAlB,QAAX2lB,EAAAnY,EAAId,eAAO,IAAAiZ,OAAA,EAAXA,EAAa1R,eACZnS,EAAAA,EAAAA,MAAA,OAAAG,SAAA,EACEC,EAAAA,EAAAA,KAAA,SAAOH,UAAU,iCAAgCE,SAAC,2BAClDC,EAAAA,EAAAA,KAAA,SACEC,KAAK,OACLjC,OAAkB,QAAX0lB,EAAApY,EAAId,eAAO,IAAAkZ,OAAA,EAAXA,EAAaxR,cAAe,GACnCjU,SAAW0C,GAAM8e,GAA+BjgB,EAAK,sBAAuBmB,EAAEC,OAAO5C,OACrF6B,WAAWC,EAAAA,EAAAA,GAAW,uCAAkD,SAAVhC,EAAmB,yCAA2C,yCAA0C,6DAI5K8B,EAAAA,EAAAA,MAAA,OAAKC,UAAU,gBAAeE,SAAA,EAC5BC,EAAAA,EAAAA,KAAA,SAAOH,UAAU,iCAAgCE,SAAC,WAClDC,EAAAA,EAAAA,KAAA,SACEC,KAAK,OACLjC,MAAOsN,EAAIuG,OAAS,GACpB5T,SAAW0C,GAAM8e,GAA+BjgB,EAAK,QAASmB,EAAEC,OAAO5C,OACvE6B,WAAWC,EAAAA,EAAAA,GAAW,uCAAkD,SAAVhC,EAAmB,yCAA2C,yCAA0C,gEAK5K8B,EAAAA,EAAAA,MAAA,OAAKC,UAAU,wCAAuCE,SAAA,EACpDH,EAAAA,EAAAA,MAAA,OAAAG,SAAA,EACEC,EAAAA,EAAAA,KAAA,SAAOH,UAAU,iCAAgCE,SAAC,sBAClDC,EAAAA,EAAAA,KAACqkB,EAAAA,EAAc,CAACxiB,MAAM,OAAOyiB,MAAM,eAAKC,QAASrH,EAAOsH,SAAUlZ,EAAIgG,MAAQ,KAAMmT,UAAU,EAAOC,kBAAoBvoB,GAAMmgB,EAA0B9c,EAAK,OAAQrD,SAExKyD,EAAAA,EAAAA,MAAA,OAAAG,SAAA,EACEC,EAAAA,EAAAA,KAAA,SAAOH,UAAU,iCAAgCE,SAAC,eAClDC,EAAAA,EAAAA,KAACqkB,EAAAA,EAAc,CACbxiB,MAAM,YACNyiB,MAAM,eACNC,QAASjH,EACTkH,SAAUlZ,EAAIiG,WAAa,GAC3BkT,UAAU,EACVI,mBAAmB,EACnBH,kBAAoBI,GAAcxI,EAA0B9c,EAAK,YAAaslB,GAC9EC,UAAWC,IAAA,IAAC,UAAEF,GAAWE,EAAA,OAAK1I,EAA0B9c,EAAK,YAAaslB,UAG9EllB,EAAAA,EAAAA,MAAA,OAAAG,SAAA,EACEC,EAAAA,EAAAA,KAAA,SAAOH,UAAU,iCAAgCE,SAAC,iBAClDC,EAAAA,EAAAA,KAACqkB,EAAAA,EAAc,CAACxiB,MAAM,cAAWyiB,MAAM,eAAKC,QAAS/G,GAAcgH,SAAUlZ,EAAI7B,SAAW,KAAMgb,UAAU,EAAOC,kBAAoBvoB,GAAMmgB,EAA0B9c,EAAK,UAAWrD,SAEzLyD,EAAAA,EAAAA,MAAA,OAAAG,SAAA,EACEC,EAAAA,EAAAA,KAAA,SAAOH,UAAU,iCAAgCE,SAAC,YAClDC,EAAAA,EAAAA,KAACqkB,EAAAA,EAAc,CAACxiB,MAAM,SAASyiB,MAAM,eAAKC,QAAS7G,GAAQ8G,SAAUlZ,EAAIkG,OAAS,KAAMiT,UAAU,EAAOC,kBAAoBvoB,GAAMmgB,EAA0B9c,EAAK,QAASrD,SAE7KyD,EAAAA,EAAAA,MAAA,OAAKC,UAAU,gBAAeE,SAAA,EAC5BC,EAAAA,EAAAA,KAAA,SAAOH,UAAU,iCAAgCE,SAAC,wBAClDC,EAAAA,EAAAA,KAACqkB,EAAAA,EAAc,CAACxiB,MAAM,qBAAkByiB,MAAM,eAAKC,QAAS7S,GAAO8S,SAAUlZ,EAAIoG,OAAS,GAAI+S,UAAU,EAAMC,kBAAoBI,GAAcxI,EAA0B9c,EAAK,QAASslB,SAE1LllB,EAAAA,EAAAA,MAAA,OAAKC,UAAU,gBAAeE,SAAA,EAC5BC,EAAAA,EAAAA,KAAA,SAAOH,UAAU,iCAAgCE,SAAC,eAClDC,EAAAA,EAAAA,KAACqkB,EAAAA,EAAc,CACbxiB,MAAM,YACNyiB,MAAM,SACNC,QAAS5S,GACT6S,SAAUlZ,EAAIqG,WAAa,GAC3B8S,UAAU,EACVC,kBAAoBC,GAClBrI,EACE9c,EACA,YACAmlB,EAAIvnB,IAAKmD,IAAC,CACR8J,GAAI9J,EAAE8J,GACN/M,KAAMiD,EAAEjD,KACR0jB,MAAOzgB,EAAEygB,OAAS,EAClBvX,QAASlJ,EAAEkJ,SAAW,GACtBmI,YAAarR,EAAEqR,aAAe,GAC9B7I,SAAUxI,EAAEwI,UAAY,YAQlCnJ,EAAAA,EAAAA,MAAA,OAAAG,SAAA,EACEC,EAAAA,EAAAA,KAAA,SAAOH,UAAU,iCAAgCE,SAAC,eAClDC,EAAAA,EAAAA,KAAA,SAAOC,KAAK,WAAW2kB,UAAWtZ,EAAImG,QAASxT,SAAW0C,GAAM2b,EAA0B9c,EAAK,UAAWmB,EAAEC,OAAOgkB,SAAU/kB,UAAU,gBAEzID,EAAAA,EAAAA,MAAA,OAAAG,SAAA,EACEC,EAAAA,EAAAA,KAAA,SAAOH,UAAU,iCAAgCE,SAAC,qBAClDC,EAAAA,EAAAA,KAAA,SACEC,KAAK,OACLjC,MAA2B,kBAAbsN,EAAIwG,KAAoBxG,EAAIwG,MAAe,QAAR6R,EAAArY,EAAIwG,YAAI,IAAA6R,OAAA,EAARA,EAAUrmB,OAAQ,GACnEW,SAAW0C,GAAM2b,EAA0B9c,EAAK,OAAQmB,EAAEC,OAAO5C,OACjE6B,WAAWC,EAAAA,EAAAA,GAAW,uCAAkD,SAAVhC,EAAmB,yCAA2C,yCAA0C,6DAG1K8B,EAAAA,EAAAA,MAAA,OAAKC,UAAU,gBAAeE,SAAA,EAC5BC,EAAAA,EAAAA,KAAA,SAAOH,UAAU,iCAAgCE,SAAC,kBAClDC,EAAAA,EAAAA,KAAA,SACEC,KAAK,OACLjC,OAAkB,QAAX4lB,EAAAtY,EAAId,eAAO,IAAAoZ,OAAA,EAAXA,EAAapZ,UAAW,GAC/BvM,SAAW0C,GAAM2b,EAA0B9c,EAAK,kBAAmBmB,EAAEC,OAAO5C,OAC5E6B,WAAWC,EAAAA,EAAAA,GAAW,uCAAkD,SAAVhC,EAAmB,yCAA2C,yCAA0C,6DAG1K8B,EAAAA,EAAAA,MAAA,OAAAG,SAAA,EACEC,EAAAA,EAAAA,KAAA,SAAOH,UAAU,iCAAgCE,SAAC,iBAClDC,EAAAA,EAAAA,KAAA,SACEC,KAAK,OACLjC,OAAkB,QAAX6lB,EAAAvY,EAAId,eAAO,IAAAqZ,OAAA,EAAXA,EAAanZ,cAAe,GACnCzM,SAAW0C,GAAM2b,EAA0B9c,EAAK,sBAAuBmB,EAAEC,OAAO5C,OAChF6B,WAAWC,EAAAA,EAAAA,GAAW,uCAAkD,SAAVhC,EAAmB,yCAA2C,yCAA0C,6DAG1K8B,EAAAA,EAAAA,MAAA,OAAAG,SAAA,EACEC,EAAAA,EAAAA,KAAA,SAAOH,UAAU,iCAAgCE,SAAC,0BAClDH,EAAAA,EAAAA,MAAA,UACE5B,OAAkB,QAAX8lB,EAAAxY,EAAId,eAAO,IAAAsZ,OAAA,EAAXA,EAAa/R,cAAe,GACnC9T,SAAW0C,GAAM2b,EAA0B9c,EAAK,sBAAuBmB,EAAEC,OAAO5C,OAChF6B,WAAWC,EAAAA,EAAAA,GAAW,uCAAkD,SAAVhC,EAAmB,yCAA2C,yCAA0C,uDAAuDiC,SAAA,EAE7NC,EAAAA,EAAAA,KAAA,UAAQhC,MAAM,GAAE+B,SAAC,gBACjBC,EAAAA,EAAAA,KAAA,UAAQhC,MAAM,QAAO+B,SAAC,eACtBC,EAAAA,EAAAA,KAAA,UAAQhC,MAAM,SAAQ+B,SAAC,qBACvBC,EAAAA,EAAAA,KAAA,UAAQhC,MAAM,UAAS+B,SAAC,cACxBC,EAAAA,EAAAA,KAAA,UAAQhC,MAAM,OAAM+B,SAAC,uBAGK,UAAlB,QAAXgkB,EAAAzY,EAAId,eAAO,IAAAuZ,OAAA,EAAXA,EAAahS,eACZnS,EAAAA,EAAAA,MAAA,OAAAG,SAAA,EACEC,EAAAA,EAAAA,KAAA,SAAOH,UAAU,iCAAgCE,SAAC,sBAClDC,EAAAA,EAAAA,KAAA,SACEC,KAAK,OACLjC,OAAkB,QAAXgmB,EAAA1Y,EAAId,eAAO,IAAAwZ,OAAA,EAAXA,EAAahS,YAAa,GACjC/T,SAAW0C,GAAM2b,EAA0B9c,EAAK,oBAAqBmB,EAAEC,OAAO5C,OAC9E6B,WAAWC,EAAAA,EAAAA,GAAW,uCAAkD,SAAVhC,EAAmB,yCAA2C,yCAA0C,4DAI9I,YAAlB,QAAXmmB,EAAA3Y,EAAId,eAAO,IAAAyZ,OAAA,EAAXA,EAAalS,eACZnS,EAAAA,EAAAA,MAAA,OAAAG,SAAA,EACEC,EAAAA,EAAAA,KAAA,SAAOH,UAAU,iCAAgCE,SAAC,6BAClDC,EAAAA,EAAAA,KAAA,SACEC,KAAK,OACLjC,OAAkB,QAAXkmB,EAAA5Y,EAAId,eAAO,IAAA0Z,OAAA,EAAXA,EAAajS,gBAAiB,GACrChU,SAAW0C,GAAM2b,EAA0B9c,EAAK,wBAAyBmB,EAAEC,OAAO5C,OAClF6B,WAAWC,EAAAA,EAAAA,GAAW,uCAAkD,SAAVhC,EAAmB,yCAA2C,yCAA0C,4DAI9I,aAAlB,QAAXqmB,EAAA7Y,EAAId,eAAO,IAAA2Z,OAAA,EAAXA,EAAapS,eACZnS,EAAAA,EAAAA,MAAA,OAAAG,SAAA,EACEC,EAAAA,EAAAA,KAAA,SAAOH,UAAU,iCAAgCE,SAAC,2BAClDC,EAAAA,EAAAA,KAAA,SACEC,KAAK,OACLjC,OAAkB,QAAXomB,EAAA9Y,EAAId,eAAO,IAAA4Z,OAAA,EAAXA,EAAalS,cAAe,GACnCjU,SAAW0C,GAAM2b,EAA0B9c,EAAK,sBAAuBmB,EAAEC,OAAO5C,OAChF6B,WAAWC,EAAAA,EAAAA,GAAW,uCAAkD,SAAVhC,EAAmB,yCAA2C,yCAA0C,6DAI5K8B,EAAAA,EAAAA,MAAA,OAAKC,UAAU,gBAAeE,SAAA,EAC5BC,EAAAA,EAAAA,KAAA,SAAOH,UAAU,iCAAgCE,SAAC,WAClDC,EAAAA,EAAAA,KAAA,SACEC,KAAK,OACLjC,MAAOsN,EAAIuG,OAAS,GACpB5T,SAAW0C,GAAM2b,EAA0B9c,EAAK,QAASmB,EAAEC,OAAO5C,OAClE6B,WAAWC,EAAAA,EAAAA,GAAW,uCAAkD,SAAVhC,EAAmB,yCAA2C,yCAA0C,iEA/QtK0B,MAyRdI,EAAAA,EAAAA,MAAA,OAAKC,UAAU,6CAA4CE,SAAA,EACzDH,EAAAA,EAAAA,MAAA,OAAAG,SAAA,EACEC,EAAAA,EAAAA,KAAA,SAAOH,UAAU,kEAAiEE,SAAC,WACnFC,EAAAA,EAAAA,KAAA,SACEC,KAAK,SACLjC,MAAO0W,EAAS3W,OAAS,EACzBE,SAAW0C,GAAM4b,EAA0B,QAAShgB,OAAOoE,EAAEC,OAAO5C,QACpE6B,WAAWC,EAAAA,EAAAA,GAAW,uCAAkD,SAAVhC,EAAmB,yCAA2C,yCAA0C,6DAG1K8B,EAAAA,EAAAA,MAAA,OAAAG,SAAA,EACEC,EAAAA,EAAAA,KAAA,SAAOH,UAAU,kEAAiEE,SAAC,YACnFH,EAAAA,EAAAA,MAAA,UACE5B,MAAO0W,EAAS1P,QAAU,YAC1B/G,SAAW0C,GAAM4b,EAA0B,SAAU5b,EAAEC,OAAO5C,OAC9D6B,WAAWC,EAAAA,EAAAA,GAAW,uCAAkD,SAAVhC,EAAmB,yCAA2C,yCAA0C,uDAAuDiC,SAAA,EAE7NC,EAAAA,EAAAA,KAAA,UAAQhC,MAAM,YAAW+B,SAAC,eAC1BC,EAAAA,EAAAA,KAAA,UAAQhC,MAAM,oBAAgB+B,SAAC,uBAC/BC,EAAAA,EAAAA,KAAA,UAAQhC,MAAM,YAAW+B,SAAC,eAC1BC,EAAAA,EAAAA,KAAA,UAAQhC,MAAM,YAAW+B,SAAC,eAC1BC,EAAAA,EAAAA,KAAA,UAAQhC,MAAM,YAAW+B,SAAC,qBAG9BH,EAAAA,EAAAA,MAAA,OAAAG,SAAA,EACEC,EAAAA,EAAAA,KAAA,SAAOH,UAAU,kEAAiEE,SAAC,uBACnFC,EAAAA,EAAAA,KAACqkB,EAAAA,EAAc,CACbxiB,MAAM,oBACNyiB,MAAM,eACNC,QAASzG,GACT0G,SAAU1G,GAAe1c,KAAM/D,GAAMA,EAAEC,OAASoX,EAAS5S,UAAY,KACrE2iB,UAAU,EACVC,kBAAoBvoB,GAAMogB,EAA0B,WAAY,OAADpgB,QAAC,IAADA,OAAC,EAADA,EAAGmB,OAAQ,UAG9EsC,EAAAA,EAAAA,MAAA,OAAAG,SAAA,EACEC,EAAAA,EAAAA,KAAA,SAAOH,UAAU,kEAAiEE,SAAC,kBACnFC,EAAAA,EAAAA,KAAA,SACEC,KAAK,OACLjC,MAAO0W,EAAS5J,gBAAkB,cAClC7M,SAAW0C,GAAM4b,EAA0B,iBAAkB5b,EAAEC,OAAO5C,OACtE6B,WAAWC,EAAAA,EAAAA,GAAW,uCAAkD,SAAVhC,EAAmB,yCAA2C,yCAA0C,gEAI5K8B,EAAAA,EAAAA,MAAA,OAAKC,UAAU,8BAA6BE,SAAA,EAC1CC,EAAAA,EAAAA,KAAA,UAAQE,QAASA,IAAMmc,EAAgB,MAAOxc,WAAWC,EAAAA,EAAAA,GAAW,2CAAsD,SAAVhC,EAAmB,8CAAgD,+CAA+CiC,SAAC,cAGnOC,EAAAA,EAAAA,KAAA,UAAQE,QAASsc,EAAgBte,SAAUyV,EAAW9T,WAAWC,EAAAA,EAAAA,GAAW,2CAA4C6T,EAAY,iCAA6C,SAAV7V,EAAmB,2CAA6C,4CAA4CiC,SAChR4T,EAAY,eAAiB,oCAW5C3T,EAAAA,EAAAA,KAACohB,EAAAA,EAAU,CAACC,KAAM5E,EAAsB6E,GAAIvB,EAAAA,SAAehgB,UACzDH,EAAAA,EAAAA,MAAC2hB,EAAAA,GAAM,CAACD,GAAG,MAAMzhB,UAAU,gBAAgB2hB,QAASA,IAAMlM,GAAwB,GAAOvV,SAAA,EACvFC,EAAAA,EAAAA,KAACohB,EAAAA,EAAWK,MAAK,CACfH,GAAIvB,EAAAA,SACJ2B,MAAM,wBACNC,UAAU,YACVC,QAAQ,cACRC,MAAM,uBACNC,UAAU,cACVC,QAAQ,YAAWhiB,UAEnBC,EAAAA,EAAAA,KAAA,OAAKH,UAAU,4CAEjBG,EAAAA,EAAAA,KAAA,OAAKH,UAAU,qDAAoDE,UACjEC,EAAAA,EAAAA,KAACohB,EAAAA,EAAWK,MAAK,CACfH,GAAIvB,EAAAA,SACJ2B,MAAM,wBACNC,UAAU,qBACVC,QAAQ,wBACRC,MAAM,uBACNC,UAAU,wBACVC,QAAQ,qBAAoBhiB,UAE5BH,EAAAA,EAAAA,MAAC2hB,EAAAA,GAAOS,MAAK,CAACniB,WAAWC,EAAAA,EAAAA,GACvB,uDACU,SAAVhC,EAAmB,4BAA8B,4BACjDiC,SAAA,EACAC,EAAAA,EAAAA,KAACuhB,EAAAA,GAAOU,MAAK,CAACpiB,UAAU,2BAA0BE,SAAC,qCACnDH,EAAAA,EAAAA,MAAA,KAAGC,UAAU,OAAME,SAAA,CAAC,iCACQC,EAAAA,EAAAA,KAAA,QAAMH,UAAU,yBAAwBE,SAAC,UAAY,2GAGjFC,EAAAA,EAAAA,KAAA,SACEC,KAAK,OACLjC,MAAO0e,EACPze,SAAU0C,GAAKgc,EAAehc,EAAEC,OAAO5C,OACvC6B,WAAWC,EAAAA,EAAAA,GACT,mDACU,SAAVhC,EAAmB,yCAA2C,yCAC9D,sDAEFiD,YAAY,yBAEdnB,EAAAA,EAAAA,MAAA,OAAKC,UAAU,iCAAgCE,SAAA,EAC7CC,EAAAA,EAAAA,KAAA,UACEE,QAASA,KAAQoV,GAAwB,GAAQqH,EAAe,KAChE9c,WAAWC,EAAAA,EAAAA,GACT,2CACU,SAAVhC,EAAmB,8CAAgD,+CACnEiC,SACH,cAGDC,EAAAA,EAAAA,KAAA,UACEE,QAASmV,EACTnX,SAAUyV,GAA2C,cAA9B+I,EAAY7f,cACnCgD,WAAWC,EAAAA,EAAAA,GACT,2CACA6T,GAA2C,cAA9B+I,EAAY7f,cAAgC,iCAAmC,0CAC5FkD,SAED4T,EAAY,gBAAkB,mCAU7C3T,EAAAA,EAAAA,KAACohB,EAAAA,EAAU,CAACC,KAAMxE,EAAmByE,GAAIvB,EAAAA,SAAehgB,UACtDH,EAAAA,EAAAA,MAAC2hB,EAAAA,GAAM,CAACD,GAAG,MAAMzhB,UAAU,gBAAgB2hB,QAASA,IAAMjM,GAAqB,GAAOxV,SAAA,EACpFC,EAAAA,EAAAA,KAACohB,EAAAA,EAAWK,MAAK,CACfH,GAAIvB,EAAAA,SACJ2B,MAAM,wBACNC,UAAU,YACVC,QAAQ,cACRC,MAAM,uBACNC,UAAU,cACVC,QAAQ,YAAWhiB,UAEnBC,EAAAA,EAAAA,KAAA,OAAKH,UAAU,4CAEjBG,EAAAA,EAAAA,KAAA,OAAKH,UAAU,qDAAoDE,UACjEC,EAAAA,EAAAA,KAACohB,EAAAA,EAAWK,MAAK,CACfH,GAAIvB,EAAAA,SACJ2B,MAAM,wBACNC,UAAU,qBACVC,QAAQ,wBACRC,MAAM,uBACNC,UAAU,wBACVC,QAAQ,qBAAoBhiB,UAE5BH,EAAAA,EAAAA,MAAC2hB,EAAAA,GAAOS,MAAK,CAACniB,WAAWC,EAAAA,EAAAA,GACvB,yEACU,SAAVhC,EAAmB,4BAA8B,4BACjDiC,SAAA,EACAH,EAAAA,EAAAA,MAAC2hB,EAAAA,GAAOU,MAAK,CAACpiB,UAAU,6DAA4DE,SAAA,CAAC,uBAEnFC,EAAAA,EAAAA,KAAA,UACEE,QAASA,IAAMqV,GAAqB,GACpC1V,UAAU,oCACV,aAAW,mCAAkCE,UAE7CC,EAAAA,EAAAA,KAACkiB,EAAAA,EAAS,CAACriB,UAAU,iBAGxBid,EAAa1Z,MAAMhG,IAAI,CAAC6M,EAAMgb,KAAS,IAAAhU,EAAAlH,EAAAC,EAAAkH,EAAAC,EAAAC,EAAAC,EAAA6T,EAAAC,EAAAC,EAAA,OACtCxlB,EAAAA,EAAAA,MAAA,OAAqBC,UAAU,kEAAiEE,SAAA,EAC9FH,EAAAA,EAAAA,MAAA,MAAIC,UAAU,mBAAkBE,SAAA,CAAC,WAASklB,EAAY,MAC1ErlB,EAAAA,EAAAA,MAAA,OAAKC,UAAU,wCAAuCE,SAAA,EACpDH,EAAAA,EAAAA,MAAA,OAAAG,SAAA,EACEC,EAAAA,EAAAA,KAAA,SAAOH,UAAU,iCAAgCE,SAAC,sBAClDC,EAAAA,EAAAA,KAACqkB,EAAAA,EAAc,CACbxiB,MAAM,OACNyiB,MAAM,eACNC,QAASrH,EACTsH,SAA+B,kBAAdva,EAAKqH,KAAoB4L,EAAM9b,KAAK1E,GAAKA,EAAEY,OAAS2M,EAAKqH,MAAQrH,EAAKqH,KACvFmT,UAAU,EACVC,kBAAoBvoB,GAAM4gB,EAAkCkI,EAAW,OAAQ9oB,SAInFyD,EAAAA,EAAAA,MAAA,OAAAG,SAAA,EACEC,EAAAA,EAAAA,KAAA,SAAOH,UAAU,iCAAgCE,SAAC,eAClDC,EAAAA,EAAAA,KAACqkB,EAAAA,EAAc,CACbxiB,MAAM,YACNyiB,MAAM,eACNC,QAASjH,EACTkH,SAAUxnB,MAAMC,QAAQgN,EAAKsH,WAAatH,EAAKsH,UAAY,GAC3DkT,UAAU,EACVI,mBAAmB,EACnBH,kBAAoBI,GAAc/H,EAAkCkI,EAAW,YAAaH,GAC5FC,UAAWM,IAAA,IAAC,UAAEP,GAAWO,EAAA,OAAKtI,EAAkCkI,EAAW,YAAaH,UAI5FllB,EAAAA,EAAAA,MAAA,OAAAG,SAAA,EACEC,EAAAA,EAAAA,KAAA,SAAOH,UAAU,iCAAgCE,SAAC,iBAClDC,EAAAA,EAAAA,KAACqkB,EAAAA,EAAc,CACbxiB,MAAM,cACNyiB,MAAM,eACNC,QAAS/G,GACTgH,SAAkC,kBAAjBva,EAAKR,QAAuB+T,GAAapc,KAAK4B,GAAKA,EAAE1F,OAAS2M,EAAKR,SAAWQ,EAAKR,QACpGgb,UAAU,EACVC,kBAAoBvoB,GAAM4gB,EAAkCkI,EAAW,UAAW9oB,SAItFyD,EAAAA,EAAAA,MAAA,OAAAG,SAAA,EACEC,EAAAA,EAAAA,KAAA,SAAOH,UAAU,iCAAgCE,SAAC,YAClDC,EAAAA,EAAAA,KAACqkB,EAAAA,EAAc,CACbxiB,MAAM,SACNyiB,MAAM,eACNC,QAAS7G,GACT8G,SAAgC,kBAAfva,EAAKuH,MAAqBkM,GAAOtc,KAAKke,GAAKA,EAAEhiB,OAAS2M,EAAKuH,OAASvH,EAAKuH,MAC1FiT,UAAU,EACVC,kBAAoBvoB,GAAM4gB,EAAkCkI,EAAW,QAAS9oB,SAIpFyD,EAAAA,EAAAA,MAAA,OAAKC,UAAU,gBAAeE,SAAA,EAC5BC,EAAAA,EAAAA,KAAA,SAAOH,UAAU,iCAAgCE,SAAC,wBAClDC,EAAAA,EAAAA,KAACqkB,EAAAA,EAAc,CACbxiB,MAAM,qBACNyiB,MAAM,eACNC,QAAS7S,GACT8S,SAAUxnB,MAAMC,QAAQgN,EAAKyH,OAASzH,EAAKyH,MAAQ,GACnD+S,UAAU,EACVC,kBAAoBI,GAAc/H,EAAkCkI,EAAW,QAASH,SAI5FllB,EAAAA,EAAAA,MAAA,OAAKC,UAAU,gBAAeE,SAAA,EAC5BC,EAAAA,EAAAA,KAAA,SAAOH,UAAU,iCAAgCE,SAAC,eAClDC,EAAAA,EAAAA,KAACqkB,EAAAA,EAAc,CACbxiB,MAAM,YACNyiB,MAAM,SACNC,QAAS5S,GACT6S,SAAUxnB,MAAMC,QAAQgN,EAAK0H,WAAa1H,EAAK0H,UAAY,GAC3D8S,UAAU,EAChBC,kBAAoBC,GAClB5H,EACEkI,EACA,YACAN,EAAIvnB,IAAImD,IAAC,CACP8J,GAAI9J,EAAE8J,GACN/M,KAAMiD,EAAEjD,KACR0jB,MAAOzgB,EAAEygB,OAAS,EAClBvX,QAASlJ,EAAEkJ,SAAW,GACtBmI,YAAarR,EAAEqR,aAAe,GAC9B7I,SAAUxI,EAAEwI,UAAY,YAS5BnJ,EAAAA,EAAAA,MAAA,OAAAG,SAAA,EACEC,EAAAA,EAAAA,KAAA,SAAOH,UAAU,iCAAgCE,SAAC,eAClDC,EAAAA,EAAAA,KAAA,SACEC,KAAK,WACL2kB,UAAW3a,EAAKwH,QAChBxT,SAAU0C,GAAKoc,EAAkCkI,EAAW,UAAWtkB,EAAEC,OAAOgkB,SAChF/kB,UAAU,gBAIdD,EAAAA,EAAAA,MAAA,OAAAG,SAAA,EACEC,EAAAA,EAAAA,KAAA,SAAOH,UAAU,iCAAgCE,SAAC,qBAClDC,EAAAA,EAAAA,KAAA,SACEC,KAAK,OACLjC,MAA4B,kBAAdiM,EAAK6H,KAAoB7H,EAAK6H,MAAiB,QAATb,EAAAhH,EAAK6H,YAAI,IAAAb,OAAA,EAATA,EAAW3T,OAAQ,GACvEW,SAAU0C,GAAKoc,EAAkCkI,EAAW,OAAQtkB,EAAEC,OAAO5C,OAC7E6B,WAAWC,EAAAA,EAAAA,GACT,uCACU,SAAVhC,EAAmB,yCAA2C,yCAC9D,6DAKN8B,EAAAA,EAAAA,MAAA,OAAKC,UAAU,gBAAeE,SAAA,EAC5BC,EAAAA,EAAAA,KAAA,SAAOH,UAAU,iCAAgCE,SAAC,kBAClDC,EAAAA,EAAAA,KAAA,SACEC,KAAK,OACLjC,OAAmB,QAAZ+L,EAAAE,EAAKO,eAAO,IAAAT,OAAA,EAAZA,EAAcS,UAAW,GAChCvM,SAAU0C,GAAKoc,EAAkCkI,EAAW,kBAAmBtkB,EAAEC,OAAO5C,OACxF6B,WAAWC,EAAAA,EAAAA,GACT,uCACU,SAAVhC,EAAmB,yCAA2C,yCAC9D,6DAKN8B,EAAAA,EAAAA,MAAA,OAAAG,SAAA,EACEC,EAAAA,EAAAA,KAAA,SAAOH,UAAU,iCAAgCE,SAAC,iBAClDC,EAAAA,EAAAA,KAAA,SACEC,KAAK,OACLjC,OAAmB,QAAZgM,EAAAC,EAAKO,eAAO,IAAAR,OAAA,EAAZA,EAAcU,cAAe,GACpCzM,SAAU0C,GAAKoc,EAAkCkI,EAAW,sBAAuBtkB,EAAEC,OAAO5C,OAC5F6B,WAAWC,EAAAA,EAAAA,GACT,uCACU,SAAVhC,EAAmB,yCAA2C,yCAC9D,6DAKN8B,EAAAA,EAAAA,MAAA,OAAAG,SAAA,EACEC,EAAAA,EAAAA,KAAA,SAAOH,UAAU,iCAAgCE,SAAC,0BAClDH,EAAAA,EAAAA,MAAA,UACE5B,OAAmB,QAAZkT,EAAAjH,EAAKO,eAAO,IAAA0G,OAAA,EAAZA,EAAca,cAAe,GACpC9T,SAAU0C,GAAKoc,EAAkCkI,EAAW,sBAAuBtkB,EAAEC,OAAO5C,OAC5F6B,WAAWC,EAAAA,EAAAA,GACT,uCACU,SAAVhC,EAAmB,yCAA2C,yCAC9D,uDACAiC,SAAA,EAEFC,EAAAA,EAAAA,KAAA,UAAQhC,MAAM,GAAE+B,SAAC,gBACjBC,EAAAA,EAAAA,KAAA,UAAQhC,MAAM,QAAO+B,SAAC,eACtBC,EAAAA,EAAAA,KAAA,UAAQhC,MAAM,SAAQ+B,SAAC,qBACvBC,EAAAA,EAAAA,KAAA,UAAQhC,MAAM,UAAS+B,SAAC,cACxBC,EAAAA,EAAAA,KAAA,UAAQhC,MAAM,OAAM+B,SAAC,uBAIM,UAAlB,QAAZoR,EAAAlH,EAAKO,eAAO,IAAA2G,OAAA,EAAZA,EAAcY,eACbnS,EAAAA,EAAAA,MAAA,OAAAG,SAAA,EACEC,EAAAA,EAAAA,KAAA,SAAOH,UAAU,iCAAgCE,SAAC,sBAClDC,EAAAA,EAAAA,KAAA,SACEC,KAAK,OACLjC,OAAmB,QAAZoT,EAAAnH,EAAKO,eAAO,IAAA4G,OAAA,EAAZA,EAAcY,YAAa,GAClC/T,SAAU0C,GAAKoc,EAAkCkI,EAAW,oBAAqBtkB,EAAEC,OAAO5C,OAC1F6B,WAAWC,EAAAA,EAAAA,GACT,uCACU,SAAVhC,EAAmB,yCAA2C,yCAC9D,4DAMuB,YAAlB,QAAZuT,EAAApH,EAAKO,eAAO,IAAA6G,OAAA,EAAZA,EAAcU,eACbnS,EAAAA,EAAAA,MAAA,OAAAG,SAAA,EACEC,EAAAA,EAAAA,KAAA,SAAOH,UAAU,iCAAgCE,SAAC,6BAClDC,EAAAA,EAAAA,KAAA,SACEC,KAAK,OACLjC,OAAmB,QAAZknB,EAAAjb,EAAKO,eAAO,IAAA0a,OAAA,EAAZA,EAAcjT,gBAAiB,GACtChU,SAAU0C,GAAKoc,EAAkCkI,EAAW,wBAAyBtkB,EAAEC,OAAO5C,OAC9F6B,WAAWC,EAAAA,EAAAA,GACT,uCACU,SAAVhC,EAAmB,yCAA2C,yCAC9D,4DAMuB,aAAlB,QAAZqnB,EAAAlb,EAAKO,eAAO,IAAA2a,OAAA,EAAZA,EAAcpT,eACbnS,EAAAA,EAAAA,MAAA,OAAAG,SAAA,EACEC,EAAAA,EAAAA,KAAA,SAAOH,UAAU,iCAAgCE,SAAC,2BAClDC,EAAAA,EAAAA,KAAA,SACEC,KAAK,OACLjC,OAAmB,QAAZonB,EAAAnb,EAAKO,eAAO,IAAA4a,OAAA,EAAZA,EAAclT,cAAe,GACpCjU,SAAU0C,GAAKoc,EAAkCkI,EAAW,sBAAuBtkB,EAAEC,OAAO5C,OAC5F6B,WAAWC,EAAAA,EAAAA,GACT,uCACU,SAAVhC,EAAmB,yCAA2C,yCAC9D,6DAMR8B,EAAAA,EAAAA,MAAA,OAAKC,UAAU,gBAAeE,SAAA,EAC5BC,EAAAA,EAAAA,KAAA,SAAOH,UAAU,iCAAgCE,SAAC,WAClDC,EAAAA,EAAAA,KAAA,SACEC,KAAK,OACLjC,MAAOiM,EAAK4H,OAAS,GACrB5T,SAAU0C,GAAKoc,EAAkCkI,EAAW,QAAStkB,EAAEC,OAAO5C,OAC9E6B,WAAWC,EAAAA,EAAAA,GACT,uCACU,SAAVhC,EAAmB,yCAA2C,yCAC9D,iEA5NoBmnB,MAsOZrlB,EAAAA,EAAAA,MAAA,OAAKC,UAAU,6CAA4CE,SAAA,EACzDH,EAAAA,EAAAA,MAAA,OAAAG,SAAA,EACEC,EAAAA,EAAAA,KAAA,SAAOH,UAAU,kEAAiEE,SAAC,WACnFC,EAAAA,EAAAA,KAAA,SACEC,KAAK,SACLjC,MAAO8e,EAAa/e,OAAS,EAC7BE,SAAU0C,GAAKqc,EAA0B,QAASzgB,OAAOoE,EAAEC,OAAO5C,QAClE6B,WAAWC,EAAAA,EAAAA,GACT,uCACU,SAAVhC,EAAmB,yCAA2C,yCAC9D,6DAIN8B,EAAAA,EAAAA,MAAA,OAAAG,SAAA,EACEC,EAAAA,EAAAA,KAAA,SAAOH,UAAU,kEAAiEE,SAAC,YACnFH,EAAAA,EAAAA,MAAA,UACE5B,MAAO8e,EAAa9X,QAAU,YAC9B/G,SAAU0C,GAAKqc,EAA0B,SAAUrc,EAAEC,OAAO5C,OAC5D6B,WAAWC,EAAAA,EAAAA,GACT,uCACU,SAAVhC,EAAmB,yCAA2C,yCAC9D,uDACAiC,SAAA,EAEFC,EAAAA,EAAAA,KAAA,UAAQhC,MAAM,YAAW+B,SAAC,eAC1BC,EAAAA,EAAAA,KAAA,UAAQhC,MAAM,oBAAgB+B,SAAC,uBAC/BC,EAAAA,EAAAA,KAAA,UAAQhC,MAAM,YAAW+B,SAAC,eAC1BC,EAAAA,EAAAA,KAAA,UAAQhC,MAAM,YAAW+B,SAAC,eAC1BC,EAAAA,EAAAA,KAAA,UAAQhC,MAAM,YAAW+B,SAAC,qBAG9BH,EAAAA,EAAAA,MAAA,OAAAG,SAAA,EACEC,EAAAA,EAAAA,KAAA,SAAOH,UAAU,kEAAiEE,SAAC,uBACnFH,EAAAA,EAAAA,MAAA,UACE5B,MAAO8e,EAAahb,SAAW,WAC/B7D,SAAU0C,GAAKqc,EAA0B,UAAWrc,EAAEC,OAAO5C,OAC7D6B,WAAWC,EAAAA,EAAAA,GACT,uCACU,SAAVhC,EAAmB,yCAA2C,yCAC9D,uDACAiC,SAAA,EAEFC,EAAAA,EAAAA,KAAA,UAAQhC,MAAM,WAAU+B,SAAC,cACzBC,EAAAA,EAAAA,KAAA,UAAQhC,MAAM,YAAW+B,SAAC,eAC1BC,EAAAA,EAAAA,KAAA,UAAQhC,MAAM,QAAO+B,SAAC,iBAG1BH,EAAAA,EAAAA,MAAA,OAAAG,SAAA,EACEC,EAAAA,EAAAA,KAAA,SAAOH,UAAU,kEAAiEE,SAAC,kBACnFC,EAAAA,EAAAA,KAAA,SACEC,KAAK,OACLjC,MAAO8e,EAAahS,gBAAkB,cACtC7M,SAAU0C,GAAKqc,EAA0B,iBAAkBrc,EAAEC,OAAO5C,OACpE6B,WAAWC,EAAAA,EAAAA,GACT,uCACU,SAAVhC,EAAmB,yCAA2C,yCAC9D,gEAKR8B,EAAAA,EAAAA,MAAA,OAAKC,UAAU,8BAA6BE,SAAA,EAC1CC,EAAAA,EAAAA,KAAA,UACEE,QAASA,IAAMqV,GAAqB,GACpC1V,WAAWC,EAAAA,EAAAA,GACT,2CACU,SAAVhC,EAAmB,8CAAgD,+CACnEiC,SACH,cAGDC,EAAAA,EAAAA,KAAA,UACEE,QAAS+c,EACT/e,SAAUyV,EACV9T,WAAWC,EAAAA,EAAAA,GACT,2CACA6T,EAAY,iCAA6C,SAAV7V,EAAmB,2CAA6C,4CAC/GiC,SAED4T,EAAY,eAAiB,mCCjNlD,EA5iCwB9V,IAAsC,IAArC,SAAE+e,EAAQ,WAAErM,EAAU,MAAEzS,GAAOD,EACtD,MAAOwG,EAAQihB,IAAa/mB,EAAAA,EAAAA,UAAS,KAC9B6d,EAAcC,IAAmB9d,EAAAA,EAAAA,UAAS,OAC1CkV,EAAYC,IAAiBnV,EAAAA,EAAAA,UAAS,KACtC4H,EAAQof,IAAahnB,EAAAA,EAAAA,UAAS,CAAEsF,KAAM,EAAGG,UAAW,EAAGD,MAAO,KAC9D2Q,EAAUC,IAAepW,EAAAA,EAAAA,UAAS,CAAE6E,MAAO,GAAIrF,MAAO,EAAGiH,OAAQ,GAAIlD,QAAS,GAAIgJ,eAAgB,MAClG+I,EAAaE,IAAkBxV,EAAAA,EAAAA,UAAS,IACxCyV,EAAcC,IAAmB1V,EAAAA,EAAAA,UAAS,KAC1CoV,EAAW6R,IAAgBjnB,EAAAA,EAAAA,WAAS,IACpCke,EAAsBnH,IAA2B/W,EAAAA,EAAAA,WAAS,IAC1Dme,EAAaC,IAAkBpe,EAAAA,EAAAA,UAAS,KACxC4d,EAAiB5H,IAAsBhW,EAAAA,EAAAA,UAAS,OAChDiW,EAAmBC,IAAwBlW,EAAAA,EAAAA,UAAS,OACpD6H,EAAiBqf,IAAsBlnB,EAAAA,EAAAA,UAAS,CAAC,IACjDmnB,EAAQC,IAAapnB,EAAAA,EAAAA,UAAS,sBAC9BsW,EAAW+Q,IAAgBrnB,EAAAA,EAAAA,UAAS,SACpC+H,EAAUuf,IAAetnB,EAAAA,EAAAA,UAAS,KAClCyd,EAAYC,IAAiB1d,EAAAA,EAAAA,UAAS,CAAEjB,KAAM,GAAIyL,SAAU,MAC5D+L,EAAkBC,IAAuBxW,EAAAA,EAAAA,WAAS,IAClDyW,EAAYC,IAAiB1W,EAAAA,EAAAA,WAAS,IACtCse,EAAmBtH,IAAwBhX,EAAAA,EAAAA,WAAS,IACpDiX,GAAiBC,KAAsBlX,EAAAA,EAAAA,UAAS,QAChDue,GAAcgJ,KAAmBvnB,EAAAA,EAAAA,UAAS,CAC/C6E,MAAO,CACL,CACEkO,KAAM,GACNsP,gBAAiB,GACjBrP,UAAW,CAAC,CAAEjU,KAAM,KACpBujB,qBAAsB,GACtBpX,QAAS,GACT+H,MAAO,GACPC,QAAS,GACTC,MAAO,GACPC,UAAW,GACXE,MAAO,GACPrH,QAAS,CACPA,QAAS,GACTE,YAAa,GACbqH,YAAa,GACbC,UAAW,GACXC,cAAe,IAEjBH,KAAM,GACNhQ,QAAS,aAGb/D,MAAO,EACPiH,OAAQ,YACRlD,QAAS,WACTgJ,eAAgB,cAChB7K,KAAM,UAGFoG,IAAoBjI,EAAAA,EAAAA,SACxB,IAAMkI,EAASrH,OAAO,CAACD,EAAKgE,IAAMhE,EAAMzC,OAAOyG,EAAE+F,UAAY,GAAI,GACjE,CAACzC,IAGGyf,IAAcC,EAAAA,EAAAA,aAAY9f,eAAO+f,GAA0B,IAAlBC,EAAOziB,UAAAvG,OAAA,QAAAwG,IAAAD,UAAA,GAAAA,UAAA,GAAG,CAAC,EACxD,UACQ0iB,EAAAA,EAAAA,KAAOhH,EAAAA,EAAAA,IAAW3H,EAAAA,GAAI,gBAAiB,CAC3CyO,SACAG,WAAWC,EAAAA,EAAAA,MACXH,WAEJ,CAAE,MAAOnZ,GACP5C,QAAQ4C,MAAM,gCAAiCA,EACjD,CACF,EAAG,IAaGuZ,IAAcN,EAAAA,EAAAA,aAAY,KAC9BR,GAAa,GAEb,IAAIe,EAAc,GACdC,EAAkB,GAEtB,MAAMC,EAAYA,KAChB,MAAMC,EAAS,IAAIH,KAAgBC,GAEnClB,EAAUoB,GAEV,MAAMC,EAAY,CAAE9iB,KAAM,EAAGG,UAAW,EAAGD,MAAO,EAAG6iB,QAAS,GACxDC,EAAqB,CAAC,EAE5BH,EAAOld,QAASrH,IACd,GAAqB,cAAjBA,EAAM6C,OAAwB,CAChC,MAAM8hB,EAAiB3kB,EAAM2kB,gBAAkB,CAAEC,SAAU,EAAGC,UAAW,EAAGC,MAAO,GACnFN,EAAU9iB,MAAQijB,EAAyB,UAAK,EAChDH,EAAU3iB,WAAa8iB,EAA0B,WAAK,EACtDH,EAAU5iB,OAAS+iB,EAAsB,OAAK,EAC9CH,EAAUC,SAAWzkB,EAAMpE,OAAS,EAEpC,MAAM+M,EAAiB3I,EAAM2I,gBAAkB,cAC/C,GAAuB,gBAAnBA,EAAkC,CAC/B+b,EAAmB/b,KACtB+b,EAAmB/b,GAAkB,CACnCoc,SAAU,CAAEC,SAAU,EAAGnjB,UAAW,EAAGD,MAAO,EAAGhG,MAAO,GACxDqpB,SAAU,CAAED,SAAU,EAAGnjB,UAAW,EAAGD,MAAO,EAAGhG,MAAO,KAG5D,MAAMkV,EAAwB,cAAf9Q,EAAMlC,KAAuB,WAAa,WACnDonB,EAActgB,EAAU5E,EAAML,SAAW,YAAYjF,cACrD+B,EAASuD,EAAMpE,OAAS,EAEV,aAAhBspB,EAA4BR,EAAmB/b,GAAgBmI,GAAQkU,UAAYvoB,EAC9D,cAAhByoB,EAA6BR,EAAmB/b,GAAgBmI,GAAQjP,WAAapF,EACrE,UAAhByoB,IAAyBR,EAAmB/b,GAAgBmI,GAAQlP,OAASnF,GAEtFioB,EAAmB/b,GAAgBmI,GAAQlV,OAASa,CACtD,CACF,IAGF2mB,EAAUoB,GACVlB,EAAmBoB,GACnBrB,GAAa,IAGT8B,GAAapI,EAAAA,EAAAA,KACjBC,EAAAA,EAAAA,IAAW3H,EAAAA,GAAI,UACd+P,IACChB,EAAcgB,EAASlI,KAAKjiB,IAAKkQ,IAAS,IAADka,EAAAC,EACvC,MAAM7b,EAAO0B,EAAI1B,OACXxI,EACJpG,MAAMC,QAAQ2O,EAAKxI,QAAUwI,EAAKxI,MAAMlG,OAAS,EAC7C0O,EAAKxI,MACL,CAAC,CAAEoH,QAAS,CAAC,EAAG1I,QAAS,CAAExE,KAAM,YAAcwU,KAAM,CAAC,IAE9D,MAAO,CACHzH,GAAIiD,EAAIjD,GACRpK,KAAM,WACH2L,EACHxI,MAAOA,EAAMhG,IAAK6M,IAAI,IACjBA,EACHO,QAASP,EAAKO,SAAW,CAAC,EAC1B1I,QACEmI,EAAKnI,SAAmC,kBAAjBmI,EAAKnI,SAAwBmI,EAAKnI,QAAQxE,KAC7D2M,EAAKnI,QACL,CAAExE,KAAM2M,EAAKnI,SAAW,YAC9BgQ,KAAM7H,EAAK6H,MAAQ,CAAC,KAEtBhQ,QAAS8J,EAAK9J,UAAoB,QAAR0lB,EAAApkB,EAAM,UAAE,IAAAokB,GAAS,QAATC,EAARD,EAAU1lB,eAAO,IAAA2lB,OAAT,EAARA,EAAmBnqB,OAAQ,WACrDwpB,eAAgBlb,EAAKkb,gBAAkB,CAAEC,SAAU,EAAGC,UAAW,EAAGC,MAAO,GAC3ElpB,MAAO6N,EAAK7N,OAAS,EACrB+M,eAAgBc,EAAKd,gBAAkB,cACvC9F,OAAQ4G,EAAK5G,QAAU,eAG3ByhB,KAED1Z,IACC6P,EAAS,8BAA8B7P,EAAME,WAC7CuY,GAAa,KAIXkC,GAAiBxI,EAAAA,EAAAA,KACrBC,EAAAA,EAAAA,IAAW3H,EAAAA,GAAI,2BACd+P,IACCf,EAAkBe,EAASlI,KAAKjiB,IAAKkQ,IAAS,IAADqa,EAAAC,EAAAC,EAC3C,MAAMjc,EAAO0B,EAAI1B,OACjB,MAAO,CACLvB,GAAIiD,EAAIjD,GACRpK,KAAM,eACH2L,EACH9J,QAAS8J,EAAK9J,UAA2B,QAAf6lB,EAAA/b,EAAKtI,kBAAU,IAAAqkB,GAAK,QAALC,EAAfD,EAAkB,UAAE,IAAAC,GAAS,QAATC,EAApBD,EAAsB9lB,eAAO,IAAA+lB,OAAd,EAAfA,EAA+BvqB,OAAQ,WACjEwpB,eAAgBlb,EAAKkb,gBAAkB,CAAEC,SAAU,EAAGC,UAAW,EAAGC,MAAO,GAC3ElpB,MAAO6N,EAAK7N,OAAS,EACrB+M,eAAgBc,EAAKd,gBAAkB,cACvC9F,OAAQ4G,EAAK5G,QAAU,eAG3ByhB,KAED1Z,IACC6P,EAAS,8BAA8B7P,EAAME,WAC7CuY,GAAa,KAIjB,MAAO,KACL8B,IACAI,MAED,CAAC9K,IAEEkL,IAAgB9B,EAAAA,EAAAA,aAAY,KAChC,MAAM+B,GAAQ,IAAI5e,MAAOuD,cAAc2D,MAAM,KAAK,GAC5C2X,GAAiBC,EAAAA,EAAAA,IAAM9I,EAAAA,EAAAA,IAAW3H,EAAAA,GAAI,kBAAkB0Q,EAAAA,EAAAA,IAAM,OAAQ,KAAMH,IAC5EI,GAAcjJ,EAAAA,EAAAA,IAClB8I,EACCT,IACC,MAAMa,EAAeb,EAASlI,KAAKjiB,IAAKkQ,IAAG,CAAQjD,GAAIiD,EAAIjD,MAAOiD,EAAI1B,UACtEia,EAAYuC,IAEbrb,IACC6P,EAAS,iCAA8B7P,EAAME,aAGjD,MAAO,IAAMkb,KACZ,CAACvL,KAEJ9d,EAAAA,EAAAA,WAAU,KACR,MAAMupB,EAAoB/B,KACpBgC,EAAsBR,KAC5B,MAAO,KACLO,IACAC,MAED,CAAChC,GAAawB,KAEjB,MAAMS,IAAiBnqB,EAAAA,EAAAA,SAAQ,IACtBiG,EAAO7G,OAAQ2E,IAAW,IAADE,EAAAC,EAAAI,EAAAC,EAAAJ,EAAAC,EAAAI,EAAAC,EAAA2V,EAAAC,EAAA+P,EAAA9P,EAAAC,EAAA8P,EAC9B,MAAMC,GAAmBjV,GAAc,IAAI5W,cAErC8rB,GAAqB,QAAXtmB,EAAAF,EAAMiB,aAAK,IAAAf,GAAK,QAALC,EAAXD,EAAc,UAAE,IAAAC,OAAL,EAAXA,EAAkBkI,WAA2B,QAApB9H,EAAIP,EAAMmB,kBAAU,IAAAZ,GAAK,QAALC,EAAhBD,EAAmB,UAAE,IAAAC,OAAL,EAAhBA,EAAuB6H,UAAW,CAAC,EAC1EA,GAAWme,EAAQne,SAAW,IAAI3N,cAClC+rB,GAASD,EAAQje,aAAe,IAAI7N,cAEpCgsB,GAAqB,QAAXtmB,EAAAJ,EAAMiB,aAAK,IAAAb,GAAK,QAALC,EAAXD,EAAc,UAAE,IAAAC,OAAL,EAAXA,EAAkBsP,QAAwB,QAApBlP,EAAIT,EAAMmB,kBAAU,IAAAV,GAAK,QAALC,EAAhBD,EAAmB,UAAE,IAAAC,OAAL,EAAhBA,EAAuBiP,MAC3DA,GAA2B,kBAAZ+W,EAAuBA,GAAiB,OAAPA,QAAO,IAAPA,OAAO,EAAPA,EAASvrB,OAAQ,IAAIT,cAErEiF,EAAUiF,EACd5E,EAAML,UAAsB,QAAf0W,EAAIrW,EAAMiB,aAAK,IAAAoV,GAAK,QAALC,EAAXD,EAAc,UAAE,IAAAC,GAAS,QAAT+P,EAAhB/P,EAAkB3W,eAAO,IAAA0mB,OAAd,EAAXA,EAA2BlrB,QAAwB,QAApBob,EAAIvW,EAAMmB,kBAAU,IAAAoV,GAAK,QAALC,EAAhBD,EAAmB,UAAE,IAAAC,GAAS,QAAT8P,EAArB9P,EAAuB7W,eAAO,IAAA2mB,OAAd,EAAhBA,EAAgCnrB,OAAQ,IAC5FT,cAEIiO,GAAkB3I,EAAM2I,gBAAkB,IAAIjO,cAC9CmI,GAAU7C,EAAM6C,QAAU,IAAInI,cAEpC,OACuB,QAApB2Y,IAA6BrT,EAAMlC,OAASuV,MAC5ChL,EAAQxI,SAAS0mB,IAChBE,EAAM5mB,SAAS0mB,IACf5W,EAAK9P,SAAS0mB,IACd5mB,EAAQE,SAAS0mB,IACjB5d,EAAe9I,SAAS0mB,IACxB1jB,EAAOhD,SAAS0mB,MAGrB,CAACrkB,EAAQoP,EAAY+B,KAGlBsT,IAAkB1qB,EAAAA,EAAAA,SAAQ,KAC9B,MAAM2D,EAAI,CAAE8B,KAAM,EAAGG,UAAW,EAAGD,MAAO,EAAG6iB,QAAS,GAStD,OARA2B,GAAe/e,QAASrH,IACtB,GAAqB,cAAjBA,EAAM6C,OAAwB,OAClC,MAAM+jB,EAAK5mB,EAAM2kB,gBAAkB,CAAEC,SAAU,EAAGC,UAAW,EAAGC,MAAO,GACvEllB,EAAE8B,MAAQklB,EAAa,UAAK,EAC5BhnB,EAAEiC,WAAa+kB,EAAc,WAAK,EAClChnB,EAAEgC,OAASglB,EAAU,OAAK,EAC1BhnB,EAAE6kB,SAAWzkB,EAAMpE,OAAS,IAEvBgE,GACN,CAACwmB,KAEES,IAAe5qB,EAAAA,EAAAA,SAAQ,IACpB,IAAImqB,IAAgBxQ,KAAK,CAACxX,EAAGC,KAClC,MAAMyoB,EAAWA,CAAC9V,EAAK+V,EAAMC,KAC3B,GAAa,gBAATD,EAAwB,OAAO/V,EAAMgW,EAA2B9R,QAAQlE,IAAQ,EAEpF,GAAI+V,EAAKE,WAAW,aAAc,CAChC,MAAMC,EAAKlW,EAAIhB,UACf,OAAIkX,GAA6B,oBAAhBA,EAAGC,SAAgCD,EAAGC,WACnDD,aAAclgB,KAAakgB,EAAGE,UAC3BF,GAAMA,EAAGjX,QAAuB,IAAbiX,EAAGjX,QAAiB,CAChD,CAEA,MAAMoX,EAAWA,CAAC1jB,EAAG9C,IACnBA,EAAEqN,MAAM,KAAKpR,OAAO,CAACC,EAAKuqB,IAAUvqB,QAAqBwE,IAAdxE,EAAIuqB,GAAsBvqB,EAAIuqB,QAAQ/lB,EAAYoC,GAE/F,IAAI9H,EAAQwrB,EAASrW,EAAK+V,GAE1B,SAAexlB,IAAV1F,GAAiC,OAAVA,GAA4B,KAAVA,IAAiBkrB,EAAKE,WAAW,YAAa,CAE1FprB,EAAQwrB,EAASrW,EADD+V,EAAKjiB,QAAQ,cAAe,iBAE9C,CAE+D,IAADyiB,EAA1DR,EAAKS,SAAS,eAAkC,kBAAV3rB,IACxCA,GAAa,QAAL0rB,EAAA1rB,SAAK,IAAA0rB,OAAA,EAALA,EAAOpsB,OAAQ,IAGzB,MAAwB,kBAAVU,EAAqBA,EAAQ+I,EAAU/I,IAAU,IAG3D4rB,EAASX,EAAS1oB,EAAGmlB,EAAQ6C,IAC7BsB,EAASZ,EAASzoB,EAAGklB,EAAQ6C,IAEnC,MAAsB,kBAAXqB,GAAyC,kBAAXC,EAClB,QAAdhV,EAAsB+U,EAAO5R,cAAc6R,GAAUA,EAAO7R,cAAc4R,GAE9D,QAAd/U,EAAsB+U,EAASC,EAASA,EAASD,IAEzD,CAACrB,GAAgB7C,EAAQ7Q,IAEtBf,GAAazX,KAAKytB,KAAKd,GAAa9rB,OAAS8W,GAC7CJ,IAAkBxV,EAAAA,EAAAA,SAAQ,KAC9B,MAAM2rB,GAASlW,EAAc,GAAKG,EAC5BgW,EAAMD,EAAQ/V,EACpB,OAAOgV,GAAa9f,MAAM6gB,EAAOC,IAChC,CAAChB,GAAcnV,EAAaG,IAyDzBE,IAAkB8R,EAAAA,EAAAA,aAAa7jB,IACnCka,EAAgBla,GAEhB,MAAM8nB,EAAiB,CACrBzf,QAAS,GACTE,YAAa,GACbqH,YAAa,GACbC,UAAW,GACXC,cAAe,GACfC,YAAa,IAGf,GAAmB,cAAf/P,EAAMlC,KAAsB,CAC9B,MAAMqD,EACJtG,MAAMC,QAAQkF,EAAMmB,aAAenB,EAAMmB,WAAWpG,OAAS,EACzDiF,EAAMmB,WAAWlG,IAAKoD,IAAC,IAClBA,EACHgK,QAAShK,EAAEgK,SAAW,IAAKyf,GAC3BtY,UAAW3U,MAAMC,QAAQuD,EAAEmR,WAAanR,EAAEmR,UAAY,GACtDF,QAA8B,mBAAdjR,EAAEiR,QAAwBjR,EAAEiR,UAAYjR,EAAEiR,QAC1DK,KAAMtR,EAAEsR,MAAQ,GAChBD,MAAOrR,EAAEqR,OAAS,GAClB5R,KAAMO,EAAEP,MAAQ,KAChBogB,KAAM7f,EAAE6f,MAAQ,KAChBD,MAAO5f,EAAE4f,OAAS,KAClBE,UAAW9f,EAAE8f,WAAa,KAC1B9O,MAAOhR,EAAEgR,OAAS,KAClB/H,QAASjJ,EAAEiJ,SAAW,QAExB,CACE,CACExJ,KAAM,KACNogB,KAAM,KACND,MAAO,KACPE,UAAW,KACX9O,MAAO,KACP/H,QAAS,KACTkI,UAAW,GACXE,MAAO,GACPJ,SAAS,EACTK,KAAM,GACNtH,QAAS,IAAKyf,KAaxB,YATAtV,EAAY,CACVtK,GAAIlI,EAAMkI,GACV/G,aACAvF,MAAOoE,EAAMpE,OAAS,EACtBiH,OAAQ7C,EAAM6C,QAAU,YACxBlD,QAASK,EAAML,QAAUiF,EAAU5E,EAAML,SAAW,WACpDgJ,eAAgB3I,EAAM2I,gBAAkB,cACxC7K,KAAM,aAGV,CAEA,MAAMmD,EACJpG,MAAMC,QAAQkF,EAAMiB,QAAUjB,EAAMiB,MAAMlG,OAAS,EAC/CiF,EAAMiB,MAAMhG,IAAK6M,IAAI,IAAAH,EAAA,MAAM,IACtBG,EACHO,QAASP,EAAKO,SAAW,IAAKyf,GAC9BnoB,QAASmI,EAAKnI,QAAUiF,GAAsB,QAAZ+C,EAAAG,EAAKnI,eAAO,IAAAgI,OAAA,EAAZA,EAAcxM,OAAQ2M,EAAKnI,SAAW,WACxE6P,UAAW3U,MAAMC,QAAQgN,EAAK0H,WAAa1H,EAAK0H,UAAY,GAC5DJ,UAAWvU,MAAMC,QAAQgN,EAAKsH,WAC1BtH,EAAKsH,UACLtH,EAAKsH,UACL,CAAC,CAAEjU,KAAM2M,EAAKsH,UAAUjU,MAAQ2M,EAAKsH,YACrC,GACJE,QAAiC,mBAAjBxH,EAAKwH,QAAwBxH,EAAKwH,UAAYxH,EAAKwH,QACnEC,MAAO1U,MAAMC,QAAQgN,EAAKyH,OAASzH,EAAKyH,MAAQ,GAChDJ,KAAMrH,EAAKqH,MAAQ,GACnBsP,gBAAiB3W,EAAK2W,iBAAmB,GACzCnX,QAASQ,EAAKR,SAAW,GACzB+H,MAAOvH,EAAKuH,OAAS,GACrBM,KAAM7H,EAAK6H,MAAQ,GACnBD,MAAO5H,EAAK4H,OAAS,MAEvB,CACE,CACEP,KAAM,GACNsP,gBAAiB,GACjBrP,UAAW,CAAC,CAAEjU,KAAM,KACpBujB,qBAAsB,GACtBpX,QAAS,GACT+H,MAAO,GACPC,SAAS,EACTC,MAAO,GACPC,UAAW,GACXE,MAAO,GACPrH,QAAS,IAAKyf,GACdnY,KAAM,GACNhQ,QAAS,aAInB6S,EAAY,CACVtK,GAAIlI,EAAMkI,GACVjH,QACArF,MAAOoE,EAAMpE,OAAS,EACtBiH,OAAQ7C,EAAM6C,QAAU,YACxBlD,QAASK,EAAML,QAAUiF,EAAU5E,EAAML,SAAW,WACpDgJ,eAAgB3I,EAAM2I,gBAAkB,cACxC7K,KAAM,WAEP,IAmOGoV,GAAwBnP,UAC5B,GAAkC,cAA9BwW,EAAY7f,cAAhB,CAIA2oB,GAAa,GACb,IACE,MAAM0E,GAAQC,EAAAA,EAAAA,IAAW3S,EAAAA,IACnB4S,QAAuBC,EAAAA,EAAAA,KAAQlL,EAAAA,EAAAA,IAAW3H,EAAAA,GAAI,WAC9C8S,QAAgCD,EAAAA,EAAAA,KAAQlL,EAAAA,EAAAA,IAAW3H,EAAAA,GAAI,4BAC7D4S,EAAe5gB,QAAS+gB,GAAWL,EAAMM,OAAOD,EAAOhT,MACvD+S,EAAwB9gB,QAAS+gB,GAAWL,EAAMM,OAAOD,EAAOhT,YAC1D2S,EAAMO,SACZnV,GAAwB,GACxBqH,EAAe,IACfpM,EAAW,0CACXwV,GAAY,+BAA6B,CAAE2E,MAAON,EAAeO,KAAOL,EAAwBK,MAClG,CAAE,MAAO5d,GACP6P,EAAS,wCAAwC7P,EAAME,UACzD,CAAC,QACCuY,GAAa,EACf,CAjBA,MAFE5I,EAAS,kDA2QPgO,IAAwBxsB,EAAAA,EAAAA,SAAQ,KACpC,MAAMK,EAAI,CAAC,EACX,IAAK,MAAOuU,EAAQpH,KAASH,OAAOC,QAAQtF,GAAmB,CAAC,GAAI,CAAC,IAADykB,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAClE,MAAMvnB,IAAY,OAAJ+H,QAAI,IAAJA,GAAc,QAAVif,EAAJjf,EAAMsb,gBAAQ,IAAA2D,OAAV,EAAJA,EAAgB1D,WAAY,KAAU,OAAJvb,QAAI,IAAJA,GAAc,QAAVkf,EAAJlf,EAAMwb,gBAAQ,IAAA0D,OAAV,EAAJA,EAAgB3D,WAAY,GACtEnjB,IAAiB,OAAJ4H,QAAI,IAAJA,GAAc,QAAVmf,EAAJnf,EAAMsb,gBAAQ,IAAA6D,OAAV,EAAJA,EAAgB/mB,YAAa,KAAU,OAAJ4H,QAAI,IAAJA,GAAc,QAAVof,EAAJpf,EAAMwb,gBAAQ,IAAA4D,OAAV,EAAJA,EAAgBhnB,YAAa,GAC7ED,IAAa,OAAJ6H,QAAI,IAAJA,GAAc,QAAVqf,EAAJrf,EAAMsb,gBAAQ,IAAA+D,OAAV,EAAJA,EAAgBlnB,QAAS,KAAU,OAAJ6H,QAAI,IAAJA,GAAc,QAAVsf,EAAJtf,EAAMwb,gBAAQ,IAAA8D,OAAV,EAAJA,EAAgBnnB,QAAS,GACjEhG,IAAa,OAAJ6N,QAAI,IAAJA,GAAc,QAAVuf,EAAJvf,EAAMsb,gBAAQ,IAAAiE,OAAV,EAAJA,EAAgBptB,QAAS,KAAU,OAAJ6N,QAAI,IAAJA,GAAc,QAAVwf,EAAJxf,EAAMwb,gBAAQ,IAAAgE,OAAV,EAAJA,EAAgBrtB,QAAS,GACvEU,EAAEuU,GAAU,CAAEnP,OAAMG,YAAWD,QAAOhG,QACxC,CACA,OAAOU,GACN,CAAC2H,IAEEsP,IAAwBtX,EAAAA,EAAAA,SAAQ,IAAMqN,OAAOqM,KAAK1R,GAAmB,CAAC,GAAI,CAACA,IAEjF,OACExG,EAAAA,EAAAA,MAAA,OAAKC,UAAU,8CAA6CE,SAAA,EAC1DC,EAAAA,EAAAA,KAACqrB,EAAoB,CACnBvtB,MAAOA,EACPgX,iBAAkBA,EAClBC,oBAAqBA,EACrBiH,WAAYA,EACZC,cAAeA,EACfC,iBA/oBmBhW,UACvB,IACG8V,EAAW1e,OACX0e,EAAWjT,UACZqZ,MAAMpG,EAAWjT,WACjBxM,OAAOyf,EAAWjT,WAAa,EAE/B6T,EAAS,uFANX,CASA4I,GAAa,GACb,UACQW,EAAAA,EAAAA,KAAOhH,EAAAA,EAAAA,IAAW3H,EAAAA,GAAI,iBAAkB,CAC5Cla,KAAM0e,EAAW1e,KAAKV,OACtBmM,SAAUxM,OAAOyf,EAAWjT,UAC5BuiB,MAAM,IAAIniB,MAAOuD,cAAc2D,MAAM,KAAK,GAC1C8B,UAAW,IAAIhJ,OAEjB8S,EAAc,CAAE3e,KAAM,GAAIyL,SAAU,KACpCgM,GAAoB,GACpBxE,EAAW,uCACXwV,GAAY,0BAAoB/J,EAAW1e,SAAS0e,EAAWjT,qBAAsB,CACnFwiB,YAAavP,EAAW1e,KACxByL,SAAUxM,OAAOyf,EAAWjT,WAEhC,CAAE,MAAOgE,GACP6P,EAAS,iCAA8B7P,EAAME,UAC/C,CAAC,QACCuY,GAAa,EACf,CApBA,GAuoBIlf,SAAUA,EACVD,kBAAmBA,GACnBsN,UAAWA,EACXwI,gBAAiBA,EACjB5H,mBAAoBA,EACpB6H,aAAcA,EACdC,gBAAiBA,EACjB3H,SAAUA,EACV4H,0BAzgBqCkP,CAACvG,EAAWvF,EAAO1hB,KAC5D2W,EAAasF,IACX,MAAMwR,EAAW,IAAKxR,EAAK7W,OAAS,IAGpC,GAFKqoB,EAASxG,KAAYwG,EAASxG,GAAa,CAAEza,QAAS,CAAC,EAAG1I,QAAS,CAAC,EAAGgQ,KAAM,CAAC,IAE/E4N,EAAM1d,SAAS,KAAM,CACvB,MAAO2d,EAAQC,GAASF,EAAMrP,MAAM,KACpCob,EAASxG,GAAa,IACjBwG,EAASxG,GACZ,CAACtF,GAAS,IAAM8L,EAASxG,GAAWtF,IAAW,CAAC,EAAI,CAACC,GAAQ5hB,GAEjE,KAAqB,UAAV0hB,EACL1iB,MAAMC,QAAQe,GAChBytB,EAASxG,GAAa,IAAKwG,EAASxG,GAAYvT,MAAO1T,GAEvDytB,EAASxG,GAAa,IACjBwG,EAASxG,GACZvT,MAAOxK,OAAOlJ,GACXqS,MAAM,KACNjT,IAAKV,IAAC,CAAQY,KAAMZ,EAAEE,UACtBY,OAAQd,GAAMA,EAAEY,OAGJ,cAAVoiB,EACL1iB,MAAMC,QAAQe,GAChBytB,EAASxG,GAAa,IAAKwG,EAASxG,GAAYtT,UAAW3T,GAE3DytB,EAASxG,GAAa,IACjBwG,EAASxG,GACZtT,UAAWzK,OAAOlJ,GACfqS,MAAM,KACNjT,IAAKmD,IACJ,MAAOjD,EAAMouB,EAAuB,GAAI3iB,EAAW,KAAOxI,EAAE8P,MAAM,KAClE,MAAO,CACL/S,KAAMA,EAAKV,OACX,CAAC8uB,EAAqB1pB,SAAS,OAAS,cAAgB,WAAY0pB,EAAqB9uB,OACzFmM,SAAUxM,OAAOwM,IAAa,KAGjCvL,OAAQ+C,GAAMA,EAAEjD,OAGJ,cAAVoiB,EACL1iB,MAAMC,QAAQe,GAChBytB,EAASxG,GAAa,IAAKwG,EAASxG,GAAY1T,UAAWvT,GAE3DytB,EAASxG,GAAa,IACjBwG,EAASxG,GACZ1T,UAAWrK,OAAOlJ,GACfqS,MAAM,KACNjT,IAAK4F,IAAC,CAAQ1F,KAAM0F,EAAEpG,UACtBY,OAAQwF,GAAMA,EAAE1F,OAIvBmuB,EAASxG,GAAa,IAAKwG,EAASxG,GAAY,CAACvF,GAAQ1hB,GAG3D,MAAO,IAAKic,EAAM7W,MAAOqoB,MAgdvBlP,0BA9gB4BA,CAACmD,EAAO1hB,KACxC2W,EAAasF,IAAI,IAAWA,EAAM,CAACyF,GAAQ1hB,MA8gBvCwe,eA7ciBtW,UACrB,GAAKkW,EAAL,CACAoJ,GAAa,GACb,IACE,MAAMmG,EAAWtnB,EAAOjD,KAAM0E,GAAMA,EAAEuE,KAAO+R,EAAa/R,IACpDuhB,EAAgBD,EAClB,CACEvoB,MAAOuoB,EAASvoB,MAChBE,WAAYqoB,EAASroB,WACrBvF,MAAO4tB,EAAS5tB,MAChBiH,OAAQ2mB,EAAS3mB,OACjBlD,QAAS6pB,EAAS7pB,QAClBgJ,eAAgB6gB,EAAS7gB,eACzB7K,KAAM0rB,EAAS1rB,MAEjB,CAAC,EAEC6mB,EAAiB,CACrBC,SAA+B,aAArBrS,EAAS5S,SAAyBvF,OAAOmY,EAAS3W,QAAc,EAC1EipB,UAAgC,cAArBtS,EAAS5S,SAA0BvF,OAAOmY,EAAS3W,QAAc,EAC5EkpB,MAA4B,UAArBvS,EAAS5S,SAAsBvF,OAAOmY,EAAS3W,QAAc,GAGtE,IAAI8tB,EAAiB,CACnB9tB,MAAOxB,OAAOmY,EAAS3W,QAAU,EACjCiH,OAAQ0P,EAAS1P,QAAU,YAC3BlD,QAAS4S,EAAS5S,SAAW,WAC7BgJ,eAAgB4J,EAAS5J,gBAAkB,cAC3Cgc,iBACAzU,UAAW,IAAIlJ,KACflJ,KAAMyU,EAASzU,MAAQmc,EAAanc,MAAQ,SAG9C,GAA6C,eAAxCmc,EAAanc,MAAQyU,EAASzU,MAAuB,CACxD,MAAM6rB,GAA0BpX,EAASpR,YAAc,IAAIlG,IAAKoD,IAAC,IAAAurB,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAA,MAAM,CACrEnsB,KAAMO,EAAEP,KAAO,CAAE3C,MAAyB,kBAAXkD,EAAEP,KAAoBO,EAAEP,KAAOO,EAAEP,KAAK3C,OAAS,IAAO,KACrF+iB,KAAM7f,EAAE6f,KAAO,CAAE/iB,MAAyB,kBAAXkD,EAAE6f,KAAoB7f,EAAE6f,KAAO7f,EAAE6f,KAAK/iB,OAAS,IAAO,KACrF8iB,MAAO5f,EAAE4f,MAAQ,CAAE9iB,MAA0B,kBAAZkD,EAAE4f,MAAqB5f,EAAE4f,MAAQ5f,EAAE4f,MAAM9iB,OAAS,IAAO,KAC1FgjB,UAAW9f,EAAE8f,UAAY,CAAEhjB,MAA8B,kBAAhBkD,EAAE8f,UAAyB9f,EAAE8f,UAAY9f,EAAE8f,UAAUhjB,OAAS,IAAO,KAC9GkU,MAAOhR,EAAEgR,MAAQ,CAAElU,MAA0B,kBAAZkD,EAAEgR,MAAqBhR,EAAEgR,MAAQhR,EAAEgR,MAAMlU,OAAS,IAAO,KAC1FmM,QAASjJ,EAAEiJ,QAAU,CAAEnM,MAA4B,kBAAdkD,EAAEiJ,QAAuBjJ,EAAEiJ,QAAUjJ,EAAEiJ,QAAQnM,OAAS,IAAO,KACpGqU,UAAW3U,MAAMC,QAAQuD,EAAEmR,WACvBnR,EAAEmR,UACCvU,IAAKmD,IAAC,CAAQjD,KAAMiD,EAAEjD,MAAQ,GAAIyL,SAAUxM,OAAOgE,EAAEwI,WAAa,KAClEvL,OAAQ+C,GAAMA,EAAEjD,MACnB,GACJuU,MAAOrR,EAAEqR,OAAS,GAClBJ,UAAWjR,EAAEiR,QACbK,KAAMtR,EAAEsR,KAAO,CAAExU,MAAyB,kBAAXkD,EAAEsR,KAAoBtR,EAAEsR,KAAOtR,EAAEsR,KAAKxU,OAAS,IAAO,KACrFkN,QAAS,CACPA,SAAkB,QAATuhB,EAAAvrB,EAAEgK,eAAO,IAAAuhB,OAAA,EAATA,EAAWvhB,UAAW,GAC/BE,aAAsB,QAATshB,EAAAxrB,EAAEgK,eAAO,IAAAwhB,OAAA,EAATA,EAAWthB,cAAe,GACvCqH,aAAsB,QAATka,EAAAzrB,EAAEgK,eAAO,IAAAyhB,OAAA,EAATA,EAAWla,cAAe,GACvCC,WAAoB,QAATka,EAAA1rB,EAAEgK,eAAO,IAAA0hB,OAAA,EAATA,EAAWla,YAAa,GACnCC,eAAwB,QAATka,EAAA3rB,EAAEgK,eAAO,IAAA2hB,OAAA,EAATA,EAAWla,gBAAiB,GAC3CC,aAAsB,QAATka,EAAA5rB,EAAEgK,eAAO,IAAA4hB,OAAA,EAATA,EAAWla,cAAe,OAI3C2Z,EAAiB,IAAKA,EAAgBvoB,WAAYwoB,SAC5ClR,EAAAA,EAAAA,KAAUtN,EAAAA,EAAAA,IAAIkK,EAAAA,GAAI,0BAA2B4E,EAAa/R,IAAKwhB,GAErE9F,GAAY,iCAA8B3J,EAAa/R,KAAM,CAC3DgiB,QAASjQ,EAAa/R,GACtBuhB,gBACAU,SAAU,IAAK5X,EAAUpR,WAAYwoB,IAEzC,KAAO,CACL,MAAMS,GAAqB7X,EAAStR,OAAS,IAAIhG,IAAK6M,IAAI,IAAAF,EAAAC,EAAAkH,EAAAC,EAAAC,EAAAC,EAAA,MAAM,CAC9DC,KAAMrH,EAAKqH,KAAO,CAAEhU,MAA4B,kBAAd2M,EAAKqH,KAAoBrH,EAAKqH,KAAOrH,EAAKqH,KAAKhU,OAAS,IAAO,KACjGsjB,gBAAiB3W,EAAK2W,gBAClB,CAAEtjB,MAAuC,kBAAzB2M,EAAK2W,gBAA+B3W,EAAK2W,gBAAkB3W,EAAK2W,gBAAgBtjB,OAAS,IACzG,KACJiU,UAAWvU,MAAMC,QAAQgN,EAAKsH,WAC1BtH,EAAKsH,UACFnU,IAAK4F,IAAC,CAAQ1F,MAAoB,kBAAN0F,EAAiBA,EAAIA,EAAE1F,OAAS,MAC5DE,OAAQwF,GAAMA,EAAE1F,MACnB,GACJujB,qBAAsB5W,EAAK4W,qBACvB,CAAEvjB,MAA4C,kBAA9B2M,EAAK4W,qBAAoC5W,EAAK4W,qBAAuB5W,EAAK4W,qBAAqBvjB,OAAS,IACxH,KACJmM,QAASQ,EAAKR,QAAU,CAAEnM,MAA+B,kBAAjB2M,EAAKR,QAAuBQ,EAAKR,QAAUQ,EAAKR,QAAQnM,OAAS,IAAO,KAChHkU,MAAOvH,EAAKuH,MAAQ,CAAElU,MAA6B,kBAAf2M,EAAKuH,MAAqBvH,EAAKuH,MAAQvH,EAAKuH,MAAMlU,OAAS,IAAO,KACtGmU,UAAWxH,EAAKwH,QAChBK,KAAM7H,EAAK6H,KAAO,CAAExU,MAA4B,kBAAd2M,EAAK6H,KAAoB7H,EAAK6H,KAAO7H,EAAK6H,KAAKxU,OAAS,IAAO,KACjGwE,QAASmI,EAAKnI,QACV,CAAExE,MAA+B,kBAAjB2M,EAAKnI,QAAuBmI,EAAKnI,QAAUmI,EAAKnI,QAAQxE,OAAS,YACjF,CAAEA,KAAM,YACZoU,MAAO1U,MAAMC,QAAQgN,EAAKyH,OACtBzH,EAAKyH,MACFtU,IAAKV,IAAC,CAAQY,MAAoB,kBAANZ,EAAiBA,EAAIA,EAAEY,OAAS,MAC5DE,OAAQd,GAAMA,EAAEY,MACnB,GACJqU,UAAW3U,MAAMC,QAAQgN,EAAK0H,WAC1B1H,EAAK0H,UAAUvU,IAAKmD,IAAC,CACnBjD,KAAMiD,EAAEjD,MAAQ,GAChBmM,QAASlJ,EAAEkJ,SAAW,GACtBmI,YAAarR,EAAEqR,aAAe,GAC9B7I,SAAUxM,OAAOgE,EAAEwI,WAAa,KAElC,GACJ8I,MAAO5H,EAAK4H,OAAS,GACrBrH,QAAS,CACPA,SAAqB,QAAZT,EAAAE,EAAKO,eAAO,IAAAT,OAAA,EAAZA,EAAcS,UAAW,GAClCE,aAAyB,QAAZV,EAAAC,EAAKO,eAAO,IAAAR,OAAA,EAAZA,EAAcU,cAAe,GAC1CqH,aAAyB,QAAZb,EAAAjH,EAAKO,eAAO,IAAA0G,OAAA,EAAZA,EAAca,cAAe,GAC1CC,WAAuB,QAAZb,EAAAlH,EAAKO,eAAO,IAAA2G,OAAA,EAAZA,EAAca,YAAa,GACtCC,eAA2B,QAAZb,EAAAnH,EAAKO,eAAO,IAAA4G,OAAA,EAAZA,EAAca,gBAAiB,GAC9CC,aAAyB,QAAZb,EAAApH,EAAKO,eAAO,IAAA6G,OAAA,EAAZA,EAAca,cAAe,OAI9C2Z,EAAiB,IAAKA,EAAgBzoB,MAAOmpB,SACvC3R,EAAAA,EAAAA,KAAUtN,EAAAA,EAAAA,IAAIkK,EAAAA,GAAI,SAAU4E,EAAa/R,IAAKwhB,GAEpD9F,GAAY,iCAA8B3J,EAAa/R,KAAM,CAC3DgiB,QAASjQ,EAAa/R,GACtBuhB,gBACAU,SAAU,IAAK5X,EAAUtR,MAAOmpB,IAEpC,CAEAlQ,EAAgB,MAChB9L,EAAW,oCACb,CAAE,MAAOxD,GACP6P,EAAS,qBAAqB7P,EAAME,UACtC,CAAC,QACCuY,GAAa,EACf,CA/HyB,GA6crB/I,qBAAsBA,EACtBnH,wBAAyBA,EACzBoH,YAAaA,EACbC,eAAgBA,EAChBtH,sBAAuBA,GACvBuH,SAAUA,EACVrM,WAAYA,EACZsM,kBAAmBA,EACnBtH,qBAAsBA,EACtBuH,aAAcA,GACdC,kCAxLoCA,CAACkI,EAAWvF,EAAO1hB,KAC3D8nB,GAAiB7L,IACf,MAAMwR,EAAW,IAAIxR,EAAK7W,OAI1B,GAHKqoB,EAASxG,KACZwG,EAASxG,GAAa,CAAEza,QAAS,CAAC,EAAG1I,QAAS,CAAC,EAAGgQ,KAAM,CAAC,IAEvD4N,EAAM1d,SAAS,KAAM,CACvB,MAAO2d,EAAQC,GAASF,EAAMrP,MAAM,KACpCob,EAASxG,GAAa,IAAKwG,EAASxG,GAAY,CAACtF,GAAS,IAAK8L,EAASxG,GAAWtF,GAAS,CAACC,GAAQ5hB,GACvG,MACEytB,EAASxG,GADU,UAAVvF,EACa,IACjB+L,EAASxG,GACZvT,MAAO1T,EACJqS,MAAM,KACNjT,IAAKV,IAAC,CAAQY,KAAMZ,EAAEE,UACtBY,OAAQd,GAAMA,EAAEY,OAEF,cAAVoiB,EACa,IACjB+L,EAASxG,GACZtT,UAAW3T,EACRqS,MAAM,KACNjT,IAAKmD,IACJ,MAAOjD,EAAMouB,EAAuB,GAAI3iB,EAAW,KAAOxI,EAAE8P,MAAM,KAClE,MAAO,CACL/S,KAAMA,EAAKV,OACX,CAAC8uB,EAAqB1pB,SAAS,OAAS,cAAgB,WAAY0pB,EAAqB9uB,OACzFmM,SAAUxM,OAAOwM,IAAa,KAGjCvL,OAAQ+C,GAAMA,EAAEjD,OAEF,cAAVoiB,EACa,IACjB+L,EAASxG,GACZ1T,UAAWvT,EACRqS,MAAM,KACNjT,IAAK4F,IAAC,CAAQ1F,KAAM0F,EAAEpG,UACtBY,OAAQwF,GAAMA,EAAE1F,OAGC,IAAKmuB,EAASxG,GAAY,CAACvF,GAAQ1hB,GAE3D,MAAO,IAAKic,EAAM7W,MAAOqoB,MA8IvBzO,0BA7L4BA,CAAC0C,EAAO1hB,KACxC8nB,GAAiB7L,IAAI,IAAWA,EAAM,CAACyF,GAAQ1hB,MA6L3Cif,qBA3IuB/W,UAC3Bsf,GAAa,GACb,IACE,MAAMgH,EAAkB1P,GAAa1Z,MAAMhG,IAAK6M,IAAI,IAC/CA,EACHqH,KAAMrH,EAAKqH,KAAO,CAAEhU,KAAM2M,EAAKqH,MAAS,KACxCsP,gBAAiB3W,EAAK2W,gBAAkB,CAAEtjB,KAAM2M,EAAK2W,iBAAoB,KACzErP,UAAWvU,MAAMC,QAAQgN,EAAKsH,WAC1BtH,EAAKsH,UAAUnU,IAAK4F,IAAC,CAAQ1F,KAAM0F,EAAE1F,MAAQ0F,KAC7CiH,EAAKsH,UACL,CAAC,CAAEjU,KAAM2M,EAAKsH,YACd,GACJsP,qBAAsB5W,EAAK4W,qBAAuB,CAAEvjB,KAAM2M,EAAK4W,sBAAyB,KACxFpX,QAASQ,EAAKR,QAAU,CAAEnM,KAAM2M,EAAKR,SAAY,KACjD+H,MAAOvH,EAAKuH,MAAQ,CAAElU,KAAM2M,EAAKuH,OAAU,KAC3CC,QAASxH,EAAKwH,QAAU,CAAEnU,KAAM2M,EAAKwH,SAAY,KACjDK,KAAM7H,EAAK6H,KAAO,CAAExU,KAAM2M,EAAK6H,MAAS,KACxChQ,QAASgb,GAAahb,QAAU,CAAExE,KAAMwf,GAAahb,SAAY,CAAExE,KAAM,YACzEoU,MAAO1U,MAAMC,QAAQgN,EAAKyH,OAASzH,EAAKyH,MAAMtU,IAAKV,IAAC,CAAQY,KAAMZ,EAAEY,MAAQZ,KAAQ,GACpFiV,UAAW3U,MAAMC,QAAQgN,EAAK0H,WAC1B1H,EAAK0H,UAAUvU,IAAKmD,IAAC,CACnBjD,KAAMiD,EAAEjD,MAAQ,GAChBmM,QAASlJ,EAAEkJ,SAAW,GACtBmI,YAAarR,EAAEqR,aAAe,GAC9B7I,SAAUxI,EAAEwI,UAAY,KAE1B,MAGA+d,EAAiB,CACrBC,SAAmC,aAAzBjK,GAAahb,SAAyBvF,OAAOugB,GAAa/e,QAAc,EAClFipB,UAAoC,cAAzBlK,GAAahb,SAA0BvF,OAAOugB,GAAa/e,QAAc,EACpFkpB,MAAgC,UAAzBnK,GAAahb,SAAsBvF,OAAOugB,GAAa/e,QAAc,GAGxE0uB,EAAY,IACb3P,GACH1Z,MAAOopB,EACPzuB,MAAOxB,OAAOugB,GAAa/e,QAAU,EACrCiH,OAAQ8X,GAAa9X,QAAU,YAC/BlD,QAASgb,GAAahb,SAAW,WACjCgJ,eAAgBgS,GAAahS,gBAAkB,cAC/Cgc,iBACA3U,WAAWkU,EAAAA,EAAAA,MACXpmB,KAAM6c,GAAa7c,MAAQ,SAGvB+W,EAAuC,cAAtB8F,GAAa7c,KAAuB,0BAA4B,SACjFsqB,QAAepE,EAAAA,EAAAA,KAAOhH,EAAAA,EAAAA,IAAW3H,EAAAA,GAAIR,GAAiByV,GAC5Dlc,EAAW,iCACXwV,GAAY,sCAAmCjJ,GAAa/e,MAAMwD,eAAe,YAAa,CAC5F8qB,QAAS9B,EAAOlgB,GAChBqiB,gBAAiB,IAAK5P,GAAc1Z,MAAOopB,KAE7CjX,GAAqB,GACrBuQ,GAAgB,CACd1iB,MAAO,CACL,CACEkO,KAAM,GACNsP,gBAAiB,GACjBrP,UAAW,CAAC,CAAEjU,KAAM,KACpBujB,qBAAsB,GACtBpX,QAAS,GACT+H,MAAO,GACPC,QAAS,GACTC,MAAO,GACPC,UAAW,GACXE,MAAO,GACPrH,QAAS,CACPA,QAAS,GACTE,YAAa,GACbqH,YAAa,GACbC,UAAW,GACXC,cAAe,IAEjBH,KAAM,GACNhQ,QAAS,aAGb/D,MAAO,EACPiH,OAAQ,YACRlD,QAAS,WACTgJ,eAAgB,cAChB7K,KAAM,SAEV,CAAE,MAAO8M,GACP6P,EAAS,2BAA2B7P,EAAME,UAC5C,CAAC,QACCuY,GAAa,EACf,GAmDI9P,sBAAuBA,MAGzB1V,EAAAA,EAAAA,KAAC2sB,EAAY,CACX7uB,MAAOA,EACPuG,OAAQA,EACRoP,WAAYA,EACZC,cAAeA,EACfvN,OAAQ2iB,GACRnV,UAAWA,EACXC,gBAAiBA,GACjBC,YAAaA,EACbC,WAAYA,GACZC,eAAgBA,EAChBC,aAAcA,EACdC,gBAAiBA,EACjB7N,gBAAiBwkB,GACjB1W,gBAAiBA,GACjBC,kBA1WoBjO,UACxBsf,GAAa,GACb,IACE,MAAMoH,EAAgBvoB,EAAOjD,KAAM0E,GAAMA,EAAEuE,KAAOgiB,SAC5C/J,EAAAA,EAAAA,KAAUhV,EAAAA,EAAAA,IAAIkK,EAAAA,GAA2B,cAAvBoV,EAAc3sB,KAAuB,0BAA4B,SAAUosB,IACnG9b,EAAW,mCACPqc,EACF7G,GAAY,gCAA6BsG,IAAW,CAClDA,UACAQ,oBAAqB,CACnBzpB,MAAOwpB,EAAcxpB,MACrBrF,MAAO6uB,EAAc7uB,MACrBiH,OAAQ4nB,EAAc5nB,OACtBlD,QAAS8qB,EAAc9qB,QACvBgJ,eAAgB8hB,EAAc9hB,eAC9B7K,KAAM2sB,EAAc3sB,QAIxB8lB,GAAY,gCAA6BsG,8BAE7C,CAAE,MAAOtf,GACP6P,EAAS,sBAAsB7P,EAAME,UACvC,CAAC,QACCuY,GAAa,EACf,GAkVIpR,mBAvTqBlO,MAAOmmB,EAASS,KACzC,IACE,MAAMnB,EAAWtnB,EAAOjD,KAAM0E,GAAMA,EAAEuE,KAAOgiB,GACvCU,EAAiBpB,EAAWA,EAAS3mB,OAAS,cAC9CgS,EAAmC,cAAlB2U,EAAS1rB,KAAuB,0BAA4B,SAInF,SAFM2a,EAAAA,EAAAA,KAAUtN,EAAAA,EAAAA,IAAIkK,EAAAA,GAAIR,EAAgBqV,GAAU,CAAErnB,OAAQ8nB,EAAWza,UAAW,IAAIlJ,OAEpE,cAAd2jB,GAA6BnB,GAA+B,cAAnBoB,EAAgC,CAC3E,MAAM1F,EAActgB,EAAU4kB,EAAS7pB,SAAW,YAC5ClD,EAAS+sB,EAAS5tB,OAAS,EAC3B+M,EAAiB/D,EAAU4kB,EAAS7gB,gBAAkB,IAE5Dya,EAAWtL,IACT,MAAM0M,EAAY,IAAK1M,GAQvB,MAPkC,aAA9BoN,EAAYxqB,cACd8pB,EAAU9iB,KAAOxH,KAAKiF,IAAI,EAAGqlB,EAAU9iB,KAAOjF,GACP,cAA9ByoB,EAAYxqB,cACrB8pB,EAAU3iB,UAAY3H,KAAKiF,IAAI,EAAGqlB,EAAU3iB,UAAYpF,GACjB,UAA9ByoB,EAAYxqB,gBACrB8pB,EAAU5iB,MAAQ1H,KAAKiF,IAAI,EAAGqlB,EAAU5iB,MAAQnF,IAE3C+nB,IAGL7b,GAAqC,gBAAnBA,GACpB2a,EAAoBxL,IAClB,MAAM4M,EAAqB,IAAK5M,GAChC,GAAI4M,EAAmB/b,GAAiB,CAAC,IAADkiB,EAAAC,EACtC,MAAMha,EAA2B,cAAlB0Y,EAAS1rB,KAAuB,WAAa,WACtD+S,EAAS,IAAK6T,EAAmB/b,IACjCtK,EAAI,IACJwS,EAAOC,IAAW,CAAEkU,SAAU,EAAGnjB,UAAW,EAAGD,MAAO,EAAGhG,MAAO,IAGhEmvB,EAAK7F,EAAYxqB,cACZ,aAAPqwB,EAAmB1sB,EAAE2mB,SAAW9qB,KAAKiF,IAAI,GAAId,EAAE2mB,UAAY,GAAKvoB,GACpD,cAAPsuB,EAAoB1sB,EAAEwD,UAAY3H,KAAKiF,IAAI,GAAId,EAAEwD,WAAa,GAAKpF,GAC5D,UAAPsuB,IAAgB1sB,EAAEuD,MAAQ1H,KAAKiF,IAAI,GAAId,EAAEuD,OAAS,GAAKnF,IAChE4B,EAAEzC,MAAQ1B,KAAKiF,IAAI,GAAId,EAAEzC,OAAS,GAAKa,GAEvCoU,EAAOC,GAAUzS,EACjBqmB,EAAmB/b,GAAkBkI,EAGnB,MADgB,QAAfga,EAAAha,EAAOkU,gBAAQ,IAAA8F,OAAA,EAAfA,EAAiBjvB,QAAS,KAAqB,QAAfkvB,EAAAja,EAAOoU,gBAAQ,IAAA6F,OAAA,EAAfA,EAAiBlvB,QAAS,WACjD8oB,EAAmB/b,EACjD,CACA,OAAO+b,GAGb,CAEAtW,EAAW,qCACXwV,GAAY,qCAAkCsG,QAAcS,IAAa,CACvET,UACAU,iBACAD,aAEJ,CAAE,MAAO/f,GACP6P,EAAS,+BAA+B7P,EAAME,UAChD,GA4PIoH,WAntBc5U,IACdimB,IAAWjmB,EACbmmB,EAA2B,QAAd/Q,EAAsB,OAAS,QAE5C8Q,EAAUlmB,GACVmmB,EAAa,QAEf7R,EAAe,IA6sBXO,YA1sBe7U,GACfimB,IAAWjmB,EAAY,KACN,QAAdoV,GACL7U,EAAAA,EAAAA,KAAA,OAAKH,UAAU,sBAAsBwI,KAAK,OAAO8kB,OAAO,eAAeC,QAAQ,YAAWrtB,UACxFC,EAAAA,EAAAA,KAAA,QAAMqtB,cAAc,QAAQC,eAAe,QAAQC,YAAY,IAAIjO,EAAE,qBAGvEtf,EAAAA,EAAAA,KAAA,OAAKH,UAAU,sBAAsBwI,KAAK,OAAO8kB,OAAO,eAAeC,QAAQ,YAAWrtB,UACxFC,EAAAA,EAAAA,KAAA,QAAMqtB,cAAc,QAAQC,eAAe,QAAQC,YAAY,IAAIjO,EAAE,qBAmsBrE/K,mBAAoBA,EACpBC,kBAAmBA,EACnBC,qBAAsBA,EACtBC,SAAUA,EACVC,YAAaA,EACbC,qBAhQuB1O,MAAOmmB,EAASvhB,KAC3C,IACE,MAAM6gB,EAAWtnB,EAAOjD,KAAM0E,GAAMA,EAAEuE,KAAOgiB,GACvCrV,EAAmC,cAAlB2U,EAAS1rB,KAAuB,0BAA4B,SAC7EutB,EAAyB7B,EAAWA,EAAS7gB,eAAiB,oBAE9D8P,EAAAA,EAAAA,KAAUtN,EAAAA,EAAAA,IAAIkK,EAAAA,GAAIR,EAAgBqV,GAAU,CAChDvhB,eAAgBA,GAAkB,KAClCuH,UAAW,IAAIlJ,OAEjBsL,EAAqB,MACrBlE,EAAW,2CACXwV,GAAY,sDAAgDsG,QAAcvhB,GAAkB,gBAAiB,CAC3GuhB,UACAmB,yBACAC,kBAAmB3iB,GAAkB,eAEzC,CAAE,MAAOiC,GACP6P,EAAS,qCAAqC7P,EAAME,UACtD,GA8OI4H,UAAWA,EACXC,iBAAkBA,EAClBC,oBAAqBA,EACrBC,WAAYA,EACZC,cAAeA,EACfC,kBAhPoBA,KACxB,MAAMwY,EAAgBphB,OAAOqhB,KAAK,GAAI,UACtCD,EAAcvhB,SAASyhB,MCl0BQC,EAACxpB,EAAQ8B,EAAQC,KAAqB,IAAD+G,EAAAC,EAAAC,EACtE,IAAIzD,EAAc,EAClB,MAAMwE,EAAc/J,EAAOoM,QAAStO,GAC7BA,GAAUnF,MAAMC,QAAQkF,EAAMiB,QAAiC,IAAvBjB,EAAMiB,MAAMlG,OAClDiF,EAAMiB,MAAM5F,OAAOyM,GAAQA,GAAM7M,IAAK6M,IAAU,IAADF,EAAAC,EAAAsE,EAEpD,OADA1E,GAAe,EACR,CACLA,GACI,OAAJK,QAAI,IAAJA,GAAa,QAATF,EAAJE,EAAMO,eAAO,IAAAT,OAAT,EAAJA,EAAeS,UAAW,IACtB,OAAJP,QAAI,IAAJA,GAAa,QAATD,EAAJC,EAAMO,eAAO,IAAAR,OAAT,EAAJA,EAAeU,cAAe,GAC9B,KAAe,QAAX4D,EAAAnM,EAAMpE,aAAK,IAAAuQ,OAAA,EAAXA,EAAa/M,eAAe,WAAY,OACvC,OAALY,QAAK,IAALA,OAAK,EAALA,EAAO2I,iBAAkB,MARiD,IAarD,IAAvBsD,EAAYlR,QAAckR,EAAYtK,KAAK9G,MAAM,GAAGqL,KAAK,MAE7D,MAAM0H,EAAetE,OAAOC,QAAQtF,GAAiBhJ,IAAIS,IAAA,IAAAmS,EAAAC,EAAAC,EAAAC,EAAA,IAAE7S,EAAMsO,GAAK/N,EAAA,MAAK,CACzEP,GAAQ,GACR,KAAa,QAAT0S,EAAApE,EAAK/H,YAAI,IAAAmM,OAAA,EAATA,EAAWzO,eAAe,WAAY,MAC1C,KAAkB,QAAd0O,EAAArE,EAAK5H,iBAAS,IAAAiM,OAAA,EAAdA,EAAgB1O,eAAe,WAAY,MAC/C,KAAc,QAAV2O,EAAAtE,EAAK7H,aAAK,IAAAmM,OAAA,EAAVA,EAAY3O,eAAe,WAAY,MAC3C,KAAc,QAAV4O,EAAAvE,EAAK7N,aAAK,IAAAoS,OAAA,EAAVA,EAAY5O,eAAe,WAAY,SAGvCqM,EAAM,IAAIzE,KAIhB,MAAO,wwCAHSyE,EAAIE,mBAAmB,YACvBF,EAAII,mBAAmB,QAAS,CAAEC,KAAM,UAAWC,OAAQ,UAAWC,QAAQ,8SAwClFC,EAAYhR,IAAIkO,GAAO,6CAEfA,EAAI,gCACJA,EAAI,gCACJA,EAAI,gCACJA,EAAI,gCACJA,EAAI,8CAEXpH,KAAK,iSAMwFkK,EAAYlR,OAAS,EAAI,KAAe,QAAXiQ,EAAAhH,EAAOtC,YAAI,IAAAsJ,OAAA,EAAXA,EAAa5L,eAAe,WAAY,MAAQ,8HAC5E6M,EAAYlR,OAAS,EAAI,KAAoB,QAAhBkQ,EAAAjH,EAAOnC,iBAAS,IAAAoJ,OAAA,EAAhBA,EAAkB7L,eAAe,WAAY,MAAQ,0HACtF6M,EAAYlR,OAAS,EAAI,KAAgB,QAAZmQ,EAAAlH,EAAOpC,aAAK,IAAAsJ,OAAA,EAAZA,EAAc9L,eAAe,WAAY,MAAQ,4HAC5E6M,EAAYlR,OAAS,EAAI,KAAKiJ,EAAOtC,KAAOsC,EAAOnC,UAAYmC,EAAOpC,OAAS,GAAGxC,eAAe,WAAa,ucAe3MwO,EAAa3S,IAAIkO,GAAO,6CAEhBA,EAAI,gCACJA,EAAI,gCACJA,EAAI,gCACJA,EAAI,gCACJA,EAAI,8CAEXpH,KAAK,uTDstBa2pB,CAAoBtF,GAAgBO,GAAiB1iB,IAClFsnB,EAAcvhB,SAAS2hB,QACvB/H,GAAY,4CAA0C,CAAE9lB,KAAM,iBA6O1DkV,uBA1OyBA,KAC7B,MAAMuY,EAAgBphB,OAAOqhB,KAAK,GAAI,UACtCD,EAAcvhB,SAASyhB,MEz0Ba,SAACvpB,EAAQ8B,EAAQC,GAA2D,IAA1CC,EAAiB5C,UAAAvG,OAAA,QAAAwG,IAAAD,UAAA,GAAAA,UAAA,GAAG,EAAG6C,EAAQ7C,UAAAvG,OAAA,QAAAwG,IAAAD,UAAA,GAAAA,UAAA,GAAG,GACtGmG,EAAc,EAClB,MAAMwE,EAAc/J,EAAOjH,IAAK+E,IAAW,IAADE,EAAAgM,EAAAvE,EAAAC,EAAAC,EAAAsE,EACxC1E,GAAe,EACf,MAAMK,GAAkB,QAAX5H,EAAAF,EAAMiB,aAAK,IAAAf,OAAA,EAAXA,EAAc,KAAM,CAAC,EAC5BP,GAAuB,QAAbuM,EAAAlM,EAAML,eAAO,IAAAuM,OAAA,EAAbA,EAAe/Q,OAAQ6E,EAAML,UAAe,OAAJmI,QAAI,IAAJA,GAAa,QAATH,EAAJG,EAAMnI,eAAO,IAAAgI,OAAT,EAAJA,EAAexM,QAAY,OAAJ2M,QAAI,IAAJA,OAAI,EAAJA,EAAMnI,UAAW,WAEhG,MAAO,CACL8H,GACI,OAAJK,QAAI,IAAJA,GAAa,QAATF,EAAJE,EAAMO,eAAO,IAAAT,OAAT,EAAJA,EAAeS,UAAW,IACtB,OAAJP,QAAI,IAAJA,GAAa,QAATD,EAAJC,EAAMO,eAAO,IAAAR,OAAT,EAAJA,EAAeU,cAAe,GAC9B,KAAe,QAAX4D,EAAAnM,EAAMpE,aAAK,IAAAuQ,OAAA,EAAXA,EAAa/M,eAAe,WAAY,MAC5CO,GACK,OAALK,QAAK,IAALA,OAAK,EAALA,EAAO2I,iBAAkB,MAIF,IAAvBsD,EAAYlR,QAAckR,EAAYtK,KAAK9G,MAAM,GAAGqL,KAAK,MAE7D,MAAM0H,EAAetE,OAAOC,QAAQtF,GAAiBhJ,IAAIS,IAAA,IAAAmS,EAAAC,EAAAC,EAAAC,EAAA,IAAE7S,EAAMsO,GAAK/N,EAAA,MAAK,CACzEP,GAAQ,GACR,KAAa,QAAT0S,EAAApE,EAAK/H,YAAI,IAAAmM,OAAA,EAATA,EAAWzO,eAAe,WAAY,MAC1C,KAAkB,QAAd0O,EAAArE,EAAK5H,iBAAS,IAAAiM,OAAA,EAAdA,EAAgB1O,eAAe,WAAY,MAC/C,KAAc,QAAV2O,EAAAtE,EAAK7H,aAAK,IAAAmM,OAAA,EAAVA,EAAY3O,eAAe,WAAY,MAC3C,KAAc,QAAV4O,EAAAvE,EAAK7N,aAAK,IAAAoS,OAAA,EAAVA,EAAY5O,eAAe,WAAY,SAGvCwsB,EAAmC,IAApBznB,EAASpJ,OAC1B,CAAC,CAAC,IAAK,MACPoJ,EAASlJ,IAAI,CAACqM,EAASC,KAAW,IAADskB,EAC/B,MAAMC,EAAgBvkB,IAAUpD,EAASpJ,OAAS,EAC5CgxB,EAASxkB,IAAUpD,EAASpJ,OAAS,EAC3C,MAAO,CACLuM,EAAQnM,MAAQ,cACA,QAAhB0wB,EAAAvkB,EAAQV,gBAAQ,IAAAilB,OAAA,EAAhBA,EAAkBzsB,eAAe,WAAY,IAC7C0sB,EAAgB,sBAAqBC,EAAS,gBAAkB,GAChED,EAAgB5nB,EAAkB9E,eAAe,SAAW2sB,GAAS,IAAI/kB,MAAO2E,mBAAmB,QAAS,CAAEgI,IAAK,UAAWD,MAAO,UAAWsY,KAAM,YAAe,MAKvKC,EAAmB,CACvBvqB,KAAMsC,EAAOtC,MAAQ,EACrBG,UAAWmC,EAAOnC,WAAa,EAC/BD,MAAOoC,EAAOpC,OAAS,GAEnBsqB,EAAeD,EAAiBvqB,KAAOuqB,EAAiBpqB,UAAYoqB,EAAiBrqB,MAE3F,MAAO,uxFAwDOgqB,EAAa3wB,IAAI,CAACkO,EAAK5B,KACvB,MAAM4kB,EAAchjB,EAAI,GAAK,oPAG2EA,EAAI,uOAE2B,wBAAXA,EAAI,GAA4B,OAAS,cAAcA,EAAI,kFAGnL,2DAEJ,MAAO,4DAEUA,EAAI,OAAOA,EAAI,+DACKA,EAAI,gCACnCgjB,iDAGLpqB,KAAK,gdAmBRkK,EAAYhR,IAAIkO,GAAO,6CAEfA,EAAI,gCACJA,EAAI,gCACJA,EAAI,gCACJA,EAAI,gCACJA,EAAI,gCACJA,EAAI,8CAEXpH,KAAK,qVAWqDkqB,EAAiBvqB,KAAKtC,eAAe,+FACpC6sB,EAAiBpqB,UAAUzC,eAAe,2FAC9C6sB,EAAiBrqB,MAAMxC,eAAe,6FACpC8sB,EAAa9sB,eAAe,ghBAkBtFwO,EAAa3S,IAAIkO,GAAO,6CAEhBA,EAAI,gCACJA,EAAI,gCACJA,EAAI,gCACJA,EAAI,gCACJA,EAAI,8CAEXpH,KAAK,4aAYpB,CFgoBMqqB,CAAyBhG,GAAgBO,GAAiB1iB,EAAiBC,GAAmBC,IAEhGonB,EAAcvhB,SAAS2hB,QACvB/H,GAAY,8CAA4C,CAAE9lB,KAAM,mBAqO5DmV,aAp9BeA,CAACoZ,EAAgBC,KACpC,IACED,EAAenqB,EAAQ8B,EAAQC,EAAiBC,GAAmBC,GACnEiK,EAAW,gCAAgCke,MAC3C1I,GAAY,2BAAwB0I,IAAU,CAAEA,UAClD,CAAE,MAAO1hB,GACP5C,QAAQ4C,MAAM,qBAAqB0hB,KAAW1hB,GAC9C6P,EAAS,qBAAqB6R,MAAW1hB,EAAME,UACjD,GA68BIoI,sBAAuBA,GACvBC,wBAAyBA,EACzBrP,cAAeA,EACfiH,YAAaA,EACboD,YAAaA,EACbiF,qBAAsBA,EACtBC,gBAAiBA,GACjBC,mBAAoBA,GACpBC,sBAAuBA,Q,iBG3jCxB,SAAS5V,IAAwB,IAAD,IAAA4uB,EAAAjrB,UAAAvG,OAATyxB,EAAO,IAAA3xB,MAAA0xB,GAAAE,EAAA,EAAAA,EAAAF,EAAAE,IAAPD,EAAOC,GAAAnrB,UAAAmrB,GACnC,OAAOD,EAAQnxB,OAAOC,SAASyG,KAAK,IACtC,C","sources":["components/common/PaymentSplitEditor.js","utils/payments.js","components/Admin/utilities/exportToExcel.js","components/Admin/utilities/exportToPDF.js","components/Admin/utilities/exportToCSV.js","components/Admin/utils.js","components/Admin/TablaPedidos.js","components/Admin/InteraccionesPedidos.js","components/Admin/OrderManagement.js","components/Admin/utilities/previewOrders.js","components/Admin/utilities/previewExcel.js","utils/classNames.js"],"sourcesContent":["// src/components/common/PaymentSplitEditor.jsx\r\nimport React, { useEffect, useMemo, useState } from 'react';\r\nimport { classNames } from '../../utils/classNames';\r\n\r\nconst toInt = (v) => {\r\n  const n = Math.floor(Number(v || 0));\r\n  return Number.isFinite(n) ? n : 0;\r\n};\r\n\r\nconst normKey = (s) => (s || '').toString().trim().toLowerCase();\r\n\r\nconst buildMethodOptions = (catalogMethods) => {\r\n  if (Array.isArray(catalogMethods) && catalogMethods.length) {\r\n    const names = catalogMethods\r\n      .map((m) => (typeof m === 'string' ? m : (m?.name || m?.label || '')))\r\n      .filter(Boolean);\r\n    return Array.from(new Set(names));\r\n  }\r\n  return ['Efectivo', 'Nequi', 'Daviplata'];\r\n};\r\n\r\nexport default function PaymentSplitEditor({\r\n  theme = 'light',\r\n  total = 0,\r\n  value = [],\r\n  onChange,\r\n  catalogMethods = [],\r\n  disabled = false,\r\n}) {\r\n  const methods = useMemo(() => buildMethodOptions(catalogMethods), [catalogMethods]);\r\n\r\n  const [rows, setRows] = useState(() => {\r\n    const sanitized = Array.isArray(value) ? value : [];\r\n    if (sanitized.length) {\r\n      return sanitized.map((r) => ({\r\n        method: typeof r.method === 'string' ? r.method : (r?.method?.name || ''),\r\n        amount: toInt(r.amount),\r\n        note: r.note || '',\r\n      }));\r\n    }\r\n    return [{ method: 'Efectivo', amount: toInt(total), note: '' }];\r\n  });\r\n\r\n  useEffect(() => {\r\n    const sanitized = Array.isArray(value) ? value : [];\r\n    if (sanitized.length) {\r\n      setRows(\r\n        sanitized.map((r) => ({\r\n          method: typeof r.method === 'string' ? r.method : (r?.method?.name || ''),\r\n          amount: toInt(r.amount),\r\n          note: r.note || '',\r\n        }))\r\n      );\r\n    }\r\n  }, [value]);\r\n\r\n  const sum = rows.reduce((acc, r) => acc + toInt(r.amount), 0);\r\n  const diff = toInt(total) - sum;\r\n  const ok = diff === 0;\r\n\r\n  const emit = (next) => {\r\n    setRows(next);\r\n    onChange &&\r\n      onChange(\r\n        next.map((r) => ({\r\n          method: r.method,\r\n          amount: toInt(r.amount),\r\n          note: r.note || '',\r\n        }))\r\n      );\r\n  };\r\n\r\n  const handleChange = (idx, key, val) => {\r\n    const next = rows.map((r, i) => (i === idx ? { ...r, [key]: key === 'amount' ? toInt(val) : val } : r));\r\n    emit(next);\r\n  };\r\n\r\n  const addRow = () => {\r\n    const unused = methods.find((m) => !rows.some((r) => normKey(r.method) === normKey(m))) || methods[0];\r\n    const next = [...rows, { method: unused, amount: Math.max(0, diff), note: '' }];\r\n    emit(next);\r\n  };\r\n\r\n  const removeRow = (idx) => {\r\n    const next = rows.filter((_, i) => i !== idx);\r\n    emit(next.length ? next : [{ method: 'Efectivo', amount: toInt(total), note: '' }]);\r\n  };\r\n\r\n  const fill5050 = () => {\r\n    if (methods.length < 2) return;\r\n    const half = Math.floor(toInt(total) / 2);\r\n    const rest = toInt(total) - half;\r\n    emit([\r\n      { method: methods[0], amount: half, note: '' },\r\n      { method: methods[1], amount: rest, note: '' },\r\n    ]);\r\n  };\r\n\r\n  const split3 = () => {\r\n    const a = Math.floor(toInt(total) / 3);\r\n    const b = Math.floor((toInt(total) - a) / 2);\r\n    const c = toInt(total) - a - b;\r\n    emit([\r\n      { method: methods[0] || 'Efectivo', amount: a, note: '' },\r\n      { method: methods[1] || 'Nequi', amount: b, note: '' },\r\n      { method: methods[2] || 'Daviplata', amount: c, note: '' },\r\n    ]);\r\n  };\r\n\r\n  const setAllTo = (m) => {\r\n    emit([{ method: m, amount: toInt(total), note: '' }]);\r\n  };\r\n\r\n  return (\r\n    <div className={classNames(\"p-3 rounded-lg border\", theme === 'dark' ? 'border-gray-600 bg-gray-800' : 'border-gray-200 bg-gray-50')}>\r\n      <div className=\"flex flex-wrap items-center justify-between gap-2 mb-2\">\r\n        <h5 className=\"font-semibold text-sm\">Dividir pago</h5>\r\n        <div className=\"flex flex-wrap gap-2\">\r\n          <button type=\"button\" disabled={disabled} onClick={fill5050}\r\n            className={classNames(\"px-2 py-1 rounded text-xs border\", theme==='dark'?'border-gray-500 hover:bg-gray-700':'border-gray-300 hover:bg-white')}>\r\n            50 / 50\r\n          </button>\r\n          <button type=\"button\" disabled={disabled} onClick={split3}\r\n            className={classNames(\"px-2 py-1 rounded text-xs border\", theme==='dark'?'border-gray-500 hover:bg-gray-700':'border-gray-300 hover:bg-white')}>\r\n            1/3 cada uno\r\n          </button>\r\n          {methods.map((m) => (\r\n            <button key={m} type=\"button\" disabled={disabled} onClick={() => setAllTo(m)}\r\n              className={classNames(\"px-2 py-1 rounded text-xs border\", theme==='dark'?'border-gray-500 hover:bg-gray-700':'border-gray-300 hover:bg-white')}>\r\n              Todo {m}\r\n            </button>\r\n          ))}\r\n        </div>\r\n      </div>\r\n\r\n      <div className=\"space-y-2\">\r\n        {rows.map((r, idx) => (\r\n          <div key={idx} className=\"grid grid-cols-1 sm:grid-cols-12 gap-2 items-center\">\r\n            <select\r\n              disabled={disabled}\r\n              value={r.method}\r\n              onChange={(e) => handleChange(idx, 'method', e.target.value)}\r\n              className={classNames(\"sm:col-span-4 p-2 rounded border text-sm\", theme==='dark'?'border-gray-600 bg-gray-700 text-white':'border-gray-300 bg-white')}\r\n            >\r\n              {methods.map((m) => (\r\n                <option key={m} value={m}>{m}</option>\r\n              ))}\r\n            </select>\r\n\r\n            <input\r\n              disabled={disabled}\r\n              type=\"number\"\r\n              min=\"0\"\r\n              step=\"1\"\r\n              value={r.amount}\r\n              onChange={(e) => handleChange(idx, 'amount', e.target.value)}\r\n              className={classNames(\"sm:col-span-4 p-2 rounded border text-sm\", theme==='dark'?'border-gray-600 bg-gray-700 text-white':'border-gray-300 bg-white')}\r\n              placeholder=\"Monto en COP\"\r\n            />\r\n\r\n            <input\r\n              disabled={disabled}\r\n              type=\"text\"\r\n              value={r.note || ''}\r\n              onChange={(e) => handleChange(idx, 'note', e.target.value)}\r\n              className={classNames(\"sm:col-span-3 p-2 rounded border text-sm\", theme==='dark'?'border-gray-600 bg-gray-700 text-white':'border-gray-300 bg-white')}\r\n              placeholder=\"Nota (opcional)\"\r\n            />\r\n\r\n            <div className=\"sm:col-span-1 flex justify-end\">\r\n              <button type=\"button\" disabled={disabled} onClick={() => removeRow(idx)}\r\n                className={classNames(\"px-2 py-1 rounded text-xs border\", theme==='dark'?'border-gray-500 hover:bg-gray-700':'border-gray-300 hover:bg-white')}>\r\n                \r\n              </button>\r\n            </div>\r\n          </div>\r\n        ))}\r\n      </div>\r\n\r\n      <div className=\"mt-3 flex items-center justify-between text-sm\">\r\n        <button type=\"button\" disabled={disabled} onClick={addRow}\r\n          className={classNames(\"px-3 py-1 rounded border\", theme==='dark'?'border-gray-500 hover:bg-gray-700':'border-gray-300 hover:bg-white')}>\r\n          + Aadir lnea\r\n        </button>\r\n\r\n        <div className=\"flex items-center gap-2\">\r\n          <span>Total pedido:</span>\r\n          <strong>${toInt(total).toLocaleString('es-CO')}</strong>\r\n        </div>\r\n      </div>\r\n\r\n      <div className=\"mt-2\">\r\n        {ok ? (\r\n          <span className={classNames(\"inline-block text-xs px-2 py-1 rounded\", theme==='dark'?'bg-green-700 text-white':'bg-green-100 text-green-800')}>\r\n             Suma exacta\r\n          </span>\r\n        ) : diff > 0 ? (\r\n          <span className={classNames(\"inline-block text-xs px-2 py-1 rounded\", theme==='dark'?'bg-yellow-700 text-white':'bg-yellow-100 text-yellow-800')}>\r\n            Falta asignar ${diff.toLocaleString('es-CO')}\r\n          </span>\r\n        ) : (\r\n          <span className={classNames(\"inline-block text-xs px-2 py-1 rounded\", theme==='dark'?'bg-red-700 text-white':'bg-red-100 text-red-800')}>\r\n            Sobran ${Math.abs(diff).toLocaleString('es-CO')}\r\n          </span>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n","// src/utils/payments.js\r\n// Utilidades para normalizar mtodos de pago y sumar exactamente por split o legado.\r\n\r\nconst norm = (s) => (s ?? '').toString().trim().toLowerCase();\r\n\r\nexport const normalizePaymentMethodKey = (methodLike) => {\r\n  const raw =\r\n    typeof methodLike === 'string'\r\n      ? methodLike\r\n      : methodLike?.name || methodLike?.label || methodLike?.title || methodLike?.method || methodLike?.type || methodLike?.payment || '';\r\n  const t = norm(raw);\r\n  if (t.includes('efect') || t.includes('cash')) return 'cash';\r\n  if (t.includes('nequi')) return 'nequi';\r\n  if (t.includes('davi')) return 'daviplata';\r\n  return 'other';\r\n};\r\n\r\nconst pickMethodLabel = (methodLike) => {\r\n  if (typeof methodLike === 'string') return methodLike;\r\n  return (\r\n    methodLike?.name ||\r\n    methodLike?.label ||\r\n    methodLike?.title ||\r\n    methodLike?.method ||\r\n    methodLike?.type ||\r\n    methodLike?.payment ||\r\n    'Otro'\r\n  );\r\n};\r\n\r\n/**\r\n * Extrae filas [{methodKey, amount, rawLabel}] desde una orden.\r\n * - Si existe order.payments (split), lo usa.\r\n * - Sino, detecta mtodo legado y asigna 100% del total.\r\n * - Sino, cae en {other}.\r\n */\r\nexport const extractOrderPayments = (order) => {\r\n  const total = Math.floor(Number(order?.total || 0)) || 0;\r\n\r\n  if (Array.isArray(order?.payments) && order.payments.length) {\r\n    return order.payments.map((p) => {\r\n      const amount = Math.floor(Number(p?.amount || 0)) || 0;\r\n      return {\r\n        methodKey: normalizePaymentMethodKey(p?.method),\r\n        amount,\r\n        rawLabel: pickMethodLabel(p?.method),\r\n      };\r\n    });\r\n  }\r\n\r\n  const legacySources = [\r\n    order?.meals?.[0]?.paymentMethod ?? order?.meals?.[0]?.payment,\r\n    order?.breakfasts?.[0]?.payment ?? order?.breakfasts?.[0]?.paymentMethod,\r\n    order?.paymentMethod ?? order?.payment,\r\n  ].filter(Boolean);\r\n\r\n  if (legacySources.length) {\r\n    const label = pickMethodLabel(legacySources[0]);\r\n    return [\r\n      {\r\n        methodKey: normalizePaymentMethodKey(legacySources[0]),\r\n        amount: total,\r\n        rawLabel: label,\r\n      },\r\n    ];\r\n  }\r\n\r\n  return [{ methodKey: 'other', amount: total, rawLabel: 'Otro' }];\r\n};\r\n\r\n/** Texto compacto: \"Efectivo $6.000 + Nequi $6.000\" */\r\nexport const summarizePayments = (paymentsRows = []) => {\r\n  if (!Array.isArray(paymentsRows) || !paymentsRows.length) return 'Sin pago';\r\n  const agg = paymentsRows.reduce((a, r) => {\r\n    const key = r.methodKey || normalizePaymentMethodKey(r?.method);\r\n    a[key] = (a[key] || 0) + (Math.floor(Number(r.amount || 0)) || 0);\r\n    return a;\r\n  }, {});\r\n  const asText = [];\r\n  if (agg.cash) asText.push(`Efectivo $${agg.cash.toLocaleString('es-CO')}`);\r\n  if (agg.nequi) asText.push(`Nequi $${agg.nequi.toLocaleString('es-CO')}`);\r\n  if (agg.daviplata) asText.push(`Daviplata $${agg.daviplata.toLocaleString('es-CO')}`);\r\n  if (agg.other && !asText.length) asText.push(`Otro $${agg.other.toLocaleString('es-CO')}`);\r\n  return asText.join(' + ') || 'Sin pago';\r\n};\r\n\r\n/**\r\n * Valor por defecto para el editor de split:\r\n * - Si hay split  se usa tal cual\r\n * - Si hay mtodo legado  100% al mtodo\r\n * - Sino  100% Efectivo\r\n */\r\nexport const defaultPaymentsForOrder = (order) => {\r\n  const rows = extractOrderPayments(order);\r\n  if (rows?.length) return rows.map(({ methodKey, amount }) => ({ method: methodKey, amount }));\r\n  const total = Math.floor(Number(order?.total || 0)) || 0;\r\n  return [{ method: 'cash', amount: total }];\r\n};\r\n\r\n/**\r\n * Totales simples por mtodo (para tiles/chips rpidos).\r\n * Devuelve: { cash, nequi, daviplata, other, total }\r\n */\r\nexport const sumPaymentsByMethod = (orders = []) => {\r\n  const out = { cash: 0, nequi: 0, daviplata: 0, other: 0, total: 0 };\r\n  for (const order of orders) {\r\n    const rows = extractOrderPayments(order);\r\n    for (const r of rows) {\r\n      const amt = Math.floor(Number(r.amount || 0)) || 0;\r\n      out[r.methodKey] = (out[r.methodKey] || 0) + amt;\r\n      out.total += amt;\r\n    }\r\n  }\r\n  return out;\r\n};\r\n\r\n/** Helpers de clasificacin por tipo/ubicacin */\r\nexport const isBreakfastOrder = (order) =>\r\n  order?.type === 'breakfast' || Array.isArray(order?.breakfasts);\r\n\r\nexport const isDeliveryOrder = (order) => {\r\n  const tag =\r\n    order?.orderType ||\r\n    order?.meals?.[0]?.orderType ||\r\n    order?.breakfasts?.[0]?.orderType ||\r\n    '';\r\n  const collection = (order?.__collection || '').toLowerCase();\r\n  const c = norm(tag);\r\n  if (collection.includes('delivery')) return true;\r\n  if (c.includes('delivery') || c.includes('domicil')) return true;\r\n  return false;\r\n};\r\n\r\nexport const isTableOrder = (order) => {\r\n  const collection = (order?.__collection || '').toLowerCase();\r\n  if (collection.includes('table')) return true;\r\n  const tableNumber =\r\n    order?.meals?.[0]?.tableNumber ?? order?.breakfasts?.[0]?.tableNumber;\r\n  return !!tableNumber;\r\n};\r\n\r\n/** Consideramos \"saln\" lo hecho por mesero: mesa o llevar desde mesa/breakfast table/takeaway */\r\nexport const isSalonOrder = (order) => {\r\n  const collection = (order?.__collection || '').toLowerCase();\r\n  // Cualquier cosa que provenga de colecciones de mesa pertenece a saln\r\n  if (collection.includes('table')) return true;\r\n\r\n  // Para desayunos creados como mesa o para llevar por mesero, tambin cuenta como saln\r\n  const t = norm(order?.orderType || order?.breakfasts?.[0]?.orderType || '');\r\n  if (Array.isArray(order?.breakfasts) && (t.includes('table') || t.includes('takeaway') || t.includes('para llevar') || t.includes('llevar'))) {\r\n    return true;\r\n  }\r\n\r\n  return false;\r\n};\r\n\r\n\r\n/** Marcas tpicas para saber si el domiciliario ya liquid el efectivo */\r\nexport const isCashSettled = (order) => {\r\n  if (order?.settlement?.status && norm(order.settlement.status) === 'liquidated') return true;\r\n  if (order?.liquidated === true) return true;\r\n  if (order?.cashSettled === true) return true;\r\n  if (order?.settledAt) return true;\r\n  return false;\r\n};\r\n\r\n/** Totales por mtodo con semntica de caja */\r\nexport const calcMethodTotalsAll = (orders = [], tableOrders = [], breakfastOrders = []) => {\r\n  const acc = {\r\n    nequiTotal: 0,\r\n    daviplataTotal: 0,\r\n    cashSalon: 0,\r\n    cashClientesSettled: 0,\r\n    cashClientesPendiente: 0,\r\n  };\r\n\r\n  const accumulate = (list = []) => {\r\n    for (const o of list) {\r\n      const rows = extractOrderPayments(o);\r\n      let cash = 0, nequi = 0, davi = 0;\r\n      for (const r of rows) {\r\n        const amt = Math.floor(Number(r?.amount || 0)) || 0;\r\n        if (r.methodKey === 'cash') cash += amt;\r\n        else if (r.methodKey === 'nequi') nequi += amt;\r\n        else if (r.methodKey === 'daviplata') davi += amt;\r\n      }\r\n      acc.nequiTotal += nequi;\r\n      acc.daviplataTotal += davi;\r\n\r\n      if (cash > 0) {\r\n        if (isSalonOrder(o)) acc.cashSalon += cash;\r\n        else if (isCashSettled(o)) acc.cashClientesSettled += cash;\r\n        else acc.cashClientesPendiente += cash;\r\n      }\r\n    }\r\n  };\r\n\r\n  accumulate(orders);\r\n  accumulate(tableOrders);\r\n  accumulate(breakfastOrders);\r\n\r\n  return { ...acc, cashCaja: acc.cashSalon + acc.cashClientesSettled };\r\n};\r\n","//src/components/Admin/utilities/exportToExcel.js\r\nimport ExcelJS from 'exceljs';\r\n\r\nexport const exportToExcel = async (orders, totals, deliveryPersons, totalProteinUnits, proteins) => {\r\n  try {\r\n    const workbook = new ExcelJS.Workbook();\r\n    const worksheet = workbook.addWorksheet('Gestin de Pedidos');\r\n\r\n    const cleanText = (text) => {\r\n      if (text == null || text === undefined) return '';\r\n      if (typeof text === 'string') return text.replace(' NUEVO', '').trim();\r\n      if (typeof text === 'boolean') return text.toString();\r\n      if (typeof text === 'object' && text !== null && 'name' in text && typeof text.name === 'string') {\r\n        return text.name.replace(' NUEVO', '').trim();\r\n      }\r\n      return String(text).replace(' NUEVO', '').trim();\r\n    };\r\n\r\n    const applyThinBorder = (cell) => {\r\n      cell.border = {\r\n        top: { style: 'thin', color: { argb: 'FF000000' } },\r\n        left: { style: 'thin', color: { argb: 'FF000000' } },\r\n        bottom: { style: 'thin', color: { argb: 'FF000000' } },\r\n        right: { style: 'thin', color: { argb: 'FF000000' } },\r\n      };\r\n    };\r\n\r\n    //  1. Resumen de Protenas\r\n    worksheet.addRow(['', 'PROTENAS DEL DA']);\r\n    const proteinHeaderRow = worksheet.lastRow.number;\r\n    worksheet.mergeCells(proteinHeaderRow, 2, proteinHeaderRow, 3);\r\n    const ourHeader = worksheet.getCell(`B${proteinHeaderRow}`);\r\n    ourHeader.font = { bold: true, color: { argb: 'FFFFFFFF' } };\r\n    ourHeader.fill = { type: 'pattern', pattern: 'solid', fgColor: { argb: 'FF0066CC' } };\r\n    ourHeader.alignment = { horizontal: 'center' };\r\n\r\n    worksheet.getRow(proteinHeaderRow + 1).values = ['', 'Protena', 'Unidades', '', ''];\r\n    const proteinTableHeader = worksheet.getRow(proteinHeaderRow + 1);\r\n    proteinTableHeader.eachCell((cell, colNumber) => {\r\n      if (colNumber === 2 || colNumber === 3) {\r\n        cell.fill = { type: 'pattern', pattern: 'solid', fgColor: { argb: 'FF28A745' } };\r\n        cell.font = { color: { argb: 'FFFFFFFF' }, bold: true };\r\n        cell.alignment = { horizontal: 'center' };\r\n        applyThinBorder(cell);\r\n      }\r\n      if (colNumber === 4 || colNumber === 5) {\r\n        cell.value = '';\r\n      }\r\n    });\r\n\r\n    const proteinData = proteins.length === 0\r\n      ? [{ name: '-', quantity: '-', extra: '', extraValue: '' }]\r\n      : [\r\n          ...proteins.slice(0, -2),\r\n          {\r\n            name: proteins[proteins.length - 2]?.name || '-',\r\n            quantity: proteins[proteins.length - 2]?.quantity || '-',\r\n            extra: 'TOTAL PROTENAS:',\r\n            extraValue: totalProteinUnits.toLocaleString('es-CO'),\r\n          },\r\n          {\r\n            name: proteins[proteins.length - 1]?.name || '-',\r\n            quantity: proteins[proteins.length - 1]?.quantity || '-',\r\n            extra: 'Fecha actual:',\r\n            extraValue: `${String(new Date().getDate()).padStart(2, '0')}/${String(new Date().getMonth() + 1).padStart(2, '0')}/${new Date().getFullYear()}`,\r\n          },\r\n        ];\r\n\r\n    proteinData.forEach((protein, index) => {\r\n      const row = worksheet.addRow(['', cleanText(protein.name), protein.quantity, protein.extra, protein.extraValue]);\r\n      row.eachCell((cell, colNumber) => {\r\n        if (colNumber >= 2) {\r\n          if (index >= proteinData.length - 2 || colNumber === 2 || colNumber === 3) {\r\n            applyThinBorder(cell);\r\n          }\r\n          if (colNumber === 3) {\r\n            cell.numFmt = '#,##0';\r\n            cell.alignment = { horizontal: 'right' };\r\n          }\r\n          if (colNumber === 4) cell.alignment = { horizontal: 'left' };\r\n          if (colNumber === 5) cell.alignment = { horizontal: 'right' };\r\n        }\r\n      });\r\n    });\r\n\r\n    worksheet.addRow({});\r\n    worksheet.addRow({});\r\n\r\n    //  2. Pedidos\r\n    let mealCounter = 0;\r\n    const pedidos = orders.map((order, index) => {\r\n      mealCounter += 1;\r\n      const meal = order.meals?.[0] || {};\r\n      const paymentValue = order.payment || (typeof meal.payment === 'object' && meal.payment?.name) || meal.payment || 'Efectivo';\r\n      if (!paymentValue || (typeof paymentValue === 'object' && !('name' in paymentValue))) {\r\n        console.warn(`Invalid payment data in order ${order.id || index}:`, { order, paymentValue });\r\n      }\r\n      return {\r\n        N: mealCounter,\r\n        Direccin: cleanText(meal.address?.address),\r\n        Telfono: cleanText(meal.address?.phoneNumber),\r\n        Total: order.total || 0,\r\n        MtodoDePago: cleanText(paymentValue),\r\n        Domiciliario: cleanText(order.deliveryPerson || 'Sin asignar'),\r\n      };\r\n    });\r\n\r\n    if (pedidos.length === 0) {\r\n      pedidos.push({ N: '-', Direccin: '-', Telfono: '-', Total: '-', MtodoDePago: '-', Domiciliario: '-' });\r\n    }\r\n\r\n    worksheet.columns = [\r\n      { key: 'N', width: 10 },\r\n      { key: 'Direccin', width: 30 },\r\n      { key: 'Telfono', width: 15 },\r\n      { key: 'Total', width: 15 },\r\n      { key: 'MtodoDePago', width: 15 },\r\n      { key: 'Domiciliario', width: 25 },\r\n    ];\r\n\r\n    const pedidosHeaderRow = proteinData.length + 4;\r\n    const headerRow = worksheet.getRow(pedidosHeaderRow);\r\n    headerRow.values = ['N', 'Direccin', 'Telfono', 'Total', 'Mtodo de Pago', 'Domiciliario'];\r\n    headerRow.eachCell(cell => {\r\n      cell.fill = { type: 'pattern', pattern: 'solid', fgColor: { argb: 'FF0066CC' } };\r\n      cell.font = { color: { argb: 'FFFFFFFF' }, bold: true };\r\n      cell.alignment = { horizontal: 'center' };\r\n      applyThinBorder(cell);\r\n    });\r\n\r\n    pedidos.forEach(pedido => {\r\n      const row = worksheet.addRow(pedido);\r\n      row.eachCell(cell => applyThinBorder(cell));\r\n    });\r\n\r\n    worksheet.addRow({});\r\n    worksheet.addRow({});\r\n\r\n    //  3. Resumen de Totales\r\n    worksheet.addRow([]);\r\n    const resumenRow = worksheet.lastRow.number;\r\n    worksheet.getCell(`C${resumenRow}`).value = 'Resumen de Totales';\r\n    worksheet.mergeCells(`C${resumenRow}:D${resumenRow}`);\r\n    const resumenCell = worksheet.getCell(`C${resumenRow}`);\r\n    resumenCell.font = { bold: true, color: { argb: 'FFFFFFFF' } };\r\n    resumenCell.fill = { type: 'pattern', pattern: 'solid', fgColor: { argb: 'FF0066CC' } };\r\n    resumenCell.alignment = { horizontal: 'center' };\r\n    applyThinBorder(resumenCell);\r\n    applyThinBorder(worksheet.getCell(`D${resumenRow}`));\r\n\r\n    const resumenData = [\r\n      ['Total Efectivo', totals.cash || 0],\r\n      ['Total Daviplata', totals.daviplata || 0],\r\n      ['Total Nequi', totals.nequi || 0],\r\n      ['Total General', (totals.cash || 0) + (totals.daviplata || 0) + (totals.nequi || 0)],\r\n    ];\r\n\r\n    resumenData.forEach(([label, value]) => {\r\n      const row = worksheet.addRow(['', '', label, value]);\r\n      row.getCell(3).alignment = { horizontal: 'left' };\r\n      row.getCell(4).alignment = { horizontal: 'right' };\r\n      row.getCell(4).numFmt = '$#,##0';\r\n      row.getCell(4).font = { bold: true };\r\n      applyThinBorder(row.getCell(3));\r\n      applyThinBorder(row.getCell(4));\r\n    });\r\n\r\n    worksheet.addRow({});\r\n    worksheet.addRow({});\r\n\r\n    //  4. Resumen por Domiciliarios\r\n    worksheet.addRow(['', 'Resumen por Domiciliarios']);\r\n    const resumenDomiciliariosRow = worksheet.lastRow.number;\r\n    worksheet.mergeCells(resumenDomiciliariosRow, 2, resumenDomiciliariosRow, 6);\r\n    const deliveryHeader = worksheet.getCell(`B${resumenDomiciliariosRow}`);\r\n    deliveryHeader.font = { bold: true, color: { argb: 'FFFFFFFF' } };\r\n    deliveryHeader.fill = { type: 'pattern', pattern: 'solid', fgColor: { argb: 'FF0066CC' } };\r\n    deliveryHeader.alignment = { horizontal: 'center' };\r\n    for (let i = 2; i <= 6; i++) applyThinBorder(worksheet.getCell(resumenDomiciliariosRow, i));\r\n\r\n    worksheet.addRow(['', 'Domiciliario', 'Efectivo', 'Daviplata', 'Nequi', 'Total']);\r\n    const domHeader = worksheet.lastRow;\r\n    domHeader.eachCell((cell, colNumber) => {\r\n      if (colNumber >= 2) {\r\n        cell.fill = { type: 'pattern', pattern: 'solid', fgColor: { argb: 'FF28A745' } };\r\n        cell.font = { color: { argb: 'FFFFFFFF' }, bold: true };\r\n        cell.alignment = { horizontal: 'center' };\r\n        applyThinBorder(cell);\r\n      }\r\n    });\r\n\r\n    Object.entries(deliveryPersons).forEach(([name, data]) => {\r\n      const row = worksheet.addRow([\r\n        '',\r\n        cleanText(name),\r\n        data.cash || 0,\r\n        data.daviplata || 0,\r\n        data.nequi || 0,\r\n        data.total || 0,\r\n      ]);\r\n      row.eachCell((cell, colNumber) => {\r\n        if (colNumber >= 2) {\r\n          if (colNumber >= 3) {\r\n            cell.numFmt = '$#,##0';\r\n            cell.alignment = { horizontal: 'right' };\r\n          }\r\n          applyThinBorder(cell);\r\n        }\r\n      });\r\n    });\r\n\r\n    const buffer = await workbook.xlsx.writeBuffer();\r\n    const blob = new Blob([buffer], { type: 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet' });\r\n    const link = document.createElement('a');\r\n    link.href = window.URL.createObjectURL(blob);\r\n    link.download = `pedidos_${new Date().toISOString().slice(0, 10)}.xlsx`;\r\n    document.body.appendChild(link);\r\n    link.click();\r\n    document.body.removeChild(link);\r\n  } catch (error) {\r\n    console.error('Error al exportar Excel:', error);\r\n    alert('Error al generar el archivo Excel: ' + error.message);\r\n  }\r\n};","// src/components/Admin/utilities/exportToPDF.js\r\nimport jsPDF from 'jspdf';\r\nimport autoTable from 'jspdf-autotable';\r\n\r\nexport const exportToPDF = async (orders, totals = {}, deliveryPersons = {}) => {\r\n  try {\r\n    const doc = new jsPDF();\r\n\r\n    const logoUrl = '/logo.png'; // Asegrate de que esta ruta sea accesible\r\n    try {\r\n      doc.addImage(logoUrl, 'PNG', 160, 10, 30, 20);\r\n    } catch (imgError) {\r\n      console.warn('No se pudo cargar el logo para el PDF:', imgError);\r\n    }\r\n\r\n    doc.setFontSize(16);\r\n    doc.text('Gestin de Pedidos', 14, 20);\r\n    doc.setFontSize(12);\r\n    const now = new Date();\r\n    const dateStr = now.toLocaleDateString('es-CO');\r\n    const timeStr = now.toLocaleTimeString('es-CO', { hour: '2-digit', minute: '2-digit', hour12: true });\r\n    doc.text(`Fecha: ${dateStr} ${timeStr}`, 14, 30);\r\n\r\nlet mealCounter = 0;\r\nconst pedidosBody = orders.map((order) => {\r\n  mealCounter += 1;\r\n  const meal = order.meals?.[0] || {};\r\n  const paymentMethod = order.payment?.name || order.payment || meal.payment?.name || meal.payment || 'Efectivo';\r\n\r\n  return [\r\n    mealCounter,\r\n    meal.address?.address || '',\r\n    meal.address?.phoneNumber || '',\r\n    `$${order.total?.toLocaleString('es-CO') || '0'}`,\r\n    paymentMethod,\r\n    order?.deliveryPerson || ''\r\n  ];\r\n});\r\n\r\nif (pedidosBody.length === 0) pedidosBody.push(Array(6).fill('-'));\r\n\r\n\r\n    if (pedidosBody.length === 0) pedidosBody.push(Array(5).fill('-'));\r\n\r\n    autoTable(doc, {\r\n      startY: 40,\r\n      head: [['N', 'Direccin', 'Telfono', 'Total', 'Domiciliario']],\r\n      body: pedidosBody,\r\n      styles: { fontSize: 8, cellPadding: 2, overflow: 'linebreak' },\r\n      headStyles: { fillColor: [0, 102, 204], textColor: 255, fontStyle: 'bold', lineWidth: 0.2, lineColor: [0, 0, 0] },\r\n      alternateRowStyles: { fillColor: [245, 245, 245] },\r\n      columnStyles: {\r\n        1: { cellWidth: 'wrap' },\r\n        3: { halign: 'right' }\r\n      },\r\n      tableLineColor: [0, 0, 0],\r\n      tableLineWidth: 0.2,\r\n      didDrawPage: (data) => {\r\n        doc.setFontSize(10);\r\n        doc.text(`Pgina ${data.pageNumber}`, 180, 287);\r\n      }\r\n    });\r\n\r\n    const finalY = doc.lastAutoTable.finalY + 10;\r\n    doc.setFontSize(14);\r\n    doc.text('Resumen de Totales', 14, finalY);\r\n\r\n    autoTable(doc, {\r\n      startY: finalY + 5,\r\n      head: [['Concepto', 'Monto']],\r\n      body: [\r\n        ['Total Efectivo', `$${totals.cash?.toLocaleString('es-CO') || '0'}`],\r\n        ['Total Daviplata', `$${totals.daviplata?.toLocaleString('es-CO') || '0'}`],\r\n        ['Total Nequi', `$${totals.nequi?.toLocaleString('es-CO') || '0'}`],\r\n        ['Total General', `$${(totals.cash + totals.daviplata + totals.nequi || 0).toLocaleString('es-CO')}`]\r\n      ],\r\n      styles: { fontSize: 10, cellPadding: 2, overflow: 'linebreak' },\r\n      headStyles: { fillColor: [0, 102, 204], textColor: 255, fontStyle: 'bold', lineWidth: 0.2, lineColor: [0, 0, 0] },\r\n      columnStyles: { 1: { halign: 'right' } },\r\n      tableLineColor: [0, 0, 0],\r\n      tableLineWidth: 0.2\r\n    });\r\n\r\n    const deliveryY = doc.lastAutoTable.finalY + 10;\r\n    doc.setFontSize(14);\r\n    doc.text('Resumen por Domiciliarios', 14, deliveryY);\r\n\r\n    const deliveryBody = Object.entries(deliveryPersons).map(([name, data]) => [\r\n      name || '',\r\n      `$${data.cash?.toLocaleString('es-CO') || '0'}`,\r\n      `$${data.daviplata?.toLocaleString('es-CO') || '0'}`,\r\n      `$${data.nequi?.toLocaleString('es-CO') || '0'}`,\r\n      `$${data.total?.toLocaleString('es-CO') || '0'}`\r\n    ]);\r\n\r\n    autoTable(doc, {\r\n      startY: deliveryY + 5,\r\n      head: [['Domiciliario', 'Efectivo', 'Daviplata', 'Nequi', 'Total']],\r\n      body: deliveryBody.length > 0 ? deliveryBody : [['-', '-', '-', '-', '-']],\r\n      styles: { fontSize: 8, cellPadding: 2, overflow: 'linebreak' },\r\n      headStyles: { fillColor: [0, 102, 204], textColor: 255, fontStyle: 'bold', lineWidth: 0.2, lineColor: [0, 0, 0] },\r\n      columnStyles: {\r\n        1: { halign: 'right' },\r\n        2: { halign: 'right' },\r\n        3: { halign: 'right' },\r\n        4: { halign: 'right' }\r\n      },\r\n      tableLineColor: [0, 0, 0],\r\n      tableLineWidth: 0.2\r\n    });\r\n\r\n    doc.save(`pedidos_${new Date().toISOString().split('T')[0]}.pdf`);\r\n  } catch (error) {\r\n    console.error('Error al generar el PDF:', error);\r\n    alert('Error al generar el PDF: ' + error.message);\r\n  }\r\n};","// src/components/Admin/utilities/exportToCSV.js\r\nexport const exportToCSV = (orders, totals, deliveryPersons, setSuccess) => {\r\n  const headers = [\r\n    'ID Pedido', 'N Bandeja', 'Sopa', 'Principio', 'Protena', 'Bebida', 'Cubiertos', 'Acompaamientos', 'Adiciones', 'Notas',\r\n    'Hora de Entrega', 'Direccin', 'Tipo de Lugar', 'Nombre del Local', 'Nombre del Destinatario', 'Detalles de Unidad',\r\n    'Telfono', 'Pago (Bandeja)', 'Total (COP)', 'Pago (General)', 'Domiciliario', 'Estado', 'Fecha de Creacin', 'ltima Actualizacin'\r\n  ];\r\n\r\n  const orderRows = orders.flatMap(order => \r\n    order.meals.map((meal, index) => [\r\n      order.id, index + 1, meal.soup?.name || meal.soup || 'Sin sopa',\r\n      Array.isArray(meal.principle) ? meal.principle.map(p => p.name || p).join(', ') : meal.principle?.name || meal.principle || 'Sin principio',\r\n      meal.protein?.name || meal.protein || 'Sin protena', meal.drink?.name || meal.drink || 'Sin bebida',\r\n      meal.cutlery?.name || meal.cutlery || 'No', meal.sides?.map(s => s.name || s).join(', ') || 'Ninguno',\r\n      meal.additions?.map(a => `${a.name || ''}${a.protein || a.replacement ? ` (${a.protein || a.replacement})` : ''} (${a.quantity || 1})`).join(', ') || 'Ninguna',\r\n      meal.notes || 'Ninguna', meal.time?.name || meal.time || 'No especificada', meal.address?.address || 'Sin direccin',\r\n      meal.address?.addressType || 'No especificado', meal.address?.localName || '', meal.address?.recipientName || '',\r\n      meal.address?.unitDetails || '', meal.address?.phoneNumber || 'No especificado',\r\n      meal.payment?.name || meal.payment || 'Efectivo', `$${order.total?.toLocaleString('es-CO') || '0'}`,\r\n      order.payment || 'Efectivo', order.deliveryPerson || 'Sin asignar', order.status || 'Pendiente',\r\n      order.createdAt ? new Date(order.createdAt.seconds * 1000).toLocaleString('es-CO') : 'N/A',\r\n      order.updatedAt ? new Date(order.updatedAt.seconds * 1000).toLocaleString('es-CO') : 'N/A',\r\n    ].map(cell => `\"${String(cell || '').replace(/\"/g, '\"\"')}\"`))\r\n  );\r\n\r\n  const totalsRows = [\r\n    ['Total Efectivo', `$${totals.cash.toLocaleString('es-CO')}`],\r\n    ['Total Daviplata', `$${totals.daviplata.toLocaleString('es-CO')}`],\r\n    ['Total Nequi', `$${totals.nequi.toLocaleString('es-CO')}`],\r\n    ['Total General', `$${(totals.cash + totals.daviplata + totals.nequi).toLocaleString('es-CO')}`],\r\n  ].map(row => row.map(cell => `\"${String(cell || '').replace(/\"/g, '\"\"')}\"`));\r\n\r\n  const deliveryRows = Object.entries(deliveryPersons).map(([name, data]) => [\r\n    name, `$${data.cash.toLocaleString('es-CO')}`, `$${data.daviplata.toLocaleString('es-CO')}`, \r\n    `$${data.nequi.toLocaleString('es-CO')}`, `$${data.total.toLocaleString('es-CO')}`\r\n  ].map(cell => `\"${String(cell || '').replace(/\"/g, '\"\"')}\"`));\r\n\r\n  const csvContent = [\r\n    headers.join(','),\r\n    ...orderRows,\r\n    '',\r\n    '\"Resumen de Totales\"',\r\n    '\"Concepto\",\"Monto (COP)\"',\r\n    ...totalsRows,\r\n    '\"Resumen por Domiciliarios\"',\r\n    '\"Domiciliario\",\"Efectivo (COP)\",\"Daviplata (COP)\",\"Nequi (COP)\",\"Total (COP)\"',\r\n    ...deliveryRows,\r\n  ].join('\\n');\r\n\r\n  const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });\r\n  const url = window.URL.createObjectURL(blob);\r\n  const a = document.createElement('a');\r\n  a.href = url;\r\n  a.download = `pedidos_${new Date().toISOString().split('T')[0]}.csv`;\r\n  a.click();\r\n  window.URL.revokeObjectURL(url);\r\n  setSuccess('Pedidos exportados a CSV.');\r\n};","// src/components/Admin/utils.js\r\nexport const cleanText = (text) => {\r\n  if (text == null) return '';\r\n  if (typeof text === 'string') return text.replace(' NUEVO', '').trim();\r\n  if (typeof text === 'boolean') return text.toString();\r\n  if (typeof text === 'object' && text?.name) return text.name.replace(' NUEVO', '').trim();\r\n  return String(text).replace(' NUEVO', '').trim();\r\n};\r\n\r\nexport const getNestedProperty = (obj, path) => {\r\n  if (!obj || !path) return '';\r\n  return path.split('.').reduce((acc, part) => (acc && acc[part] !== undefined ? acc[part] : ''), obj);\r\n};\r\n\r\nexport const getAddressDisplay = (address) => {\r\n  if (!address?.address) return 'Sin direccin';\r\n  let display = address.address;\r\n  switch (address.addressType) {\r\n    case 'school': if (address.recipientName) display += ` (Recibe: ${cleanText(address.recipientName)})`; break;\r\n    case 'complex': if (address.unitDetails) display += ` (${cleanText(address.unitDetails)})`; break;\r\n    case 'shop': if (address.localName) display += ` (${cleanText(address.localName)})`; break;\r\n    default: break;\r\n  }\r\n  return display;\r\n};\r\n\r\nexport const getMealDetailsDisplay = (meal) => {\r\n  const components = [];\r\n  const soupDisplay = meal.soupReplacement?.name || meal.soupReplacement ? `${cleanText(meal.soupReplacement?.name || meal.soupReplacement)} (por sopa)` : meal.soup?.name || meal.soup ? cleanText(meal.soup?.name || meal.soup) : 'Sin sopa';\r\n  components.push(`Sopa: ${soupDisplay}`);\r\n  let principleDisplay;\r\n  if (meal.principleReplacement?.name || meal.principleReplacement) {\r\n    principleDisplay = `${cleanText(meal.principleReplacement?.name || meal.principleReplacement)} (por principio)`;\r\n  } else if (Array.isArray(meal.principle) && meal.principle.length > 0) {\r\n    const principleNames = meal.principle.map(p => cleanText(p.name || p)).filter(Boolean);\r\n    principleDisplay = principleNames.length > 0 ? principleNames.join(', ') : 'Sin principio';\r\n  } else if (meal.principle?.name || meal.principle) {\r\n    principleDisplay = cleanText(meal.principle?.name || meal.principle);\r\n  } else {\r\n    principleDisplay = 'Sin principio';\r\n  }\r\n  components.push(`Principio: ${principleDisplay}`);\r\n  components.push(`Protena: ${meal.protein?.name || meal.protein ? cleanText(meal.protein?.name || meal.protein) : 'Sin protena'}`);\r\n  const drinkName = meal.drink?.name || meal.drink || '';\r\n  components.push(`Bebida: ${drinkName === 'Juego de mango' ? 'Jugo de mango' : cleanText(drinkName) || 'Sin bebida'}`);\r\n  components.push(`Cubiertos: ${meal.cutlery?.name === 'S' || meal.cutlery === true || meal.cutlery === 'true' ? 'S' : 'No'}`);\r\n  const sides = meal.sides?.length > 0 ? meal.sides.map(s => cleanText(s.name || s)).filter(Boolean).join(', ') : 'Ninguno';\r\n  components.push(`Acompaamientos: ${sides}`);\r\n  const additions = meal.additions?.length > 0 ? meal.additions.map(a => `${cleanText(a.name || a)}${a.protein || a.replacement ? ` (${cleanText(a.protein || a.replacement)})` : ''} (${a.quantity || 1})`).join(', ') : 'Ninguna';\r\n  components.push(`Adiciones: ${additions}`);\r\n  components.push(`Notas: ${meal.notes ? cleanText(meal.notes) : 'Ninguna'}`);\r\n  components.push(`Hora de Entrega: ${meal.time?.name || meal.time ? cleanText(meal.time?.name || meal.time) : 'No especificada'}`);\r\n  components.push(`Direccin: ${getAddressDisplay(meal.address)}`);\r\n  let addressTypeDisplay = '';\r\n  switch (meal.address?.addressType) {\r\n    case 'house': addressTypeDisplay = 'Casa/Apto'; break;\r\n    case 'school': addressTypeDisplay = 'Colegio/Oficina'; break;\r\n    case 'complex': addressTypeDisplay = 'Conjunto'; break;\r\n    case 'shop': addressTypeDisplay = 'Tienda/Local'; break;\r\n    default: addressTypeDisplay = 'No especificado'; break;\r\n  }\r\n  components.push(`Tipo de Lugar: ${addressTypeDisplay}`);\r\n  components.push(`Telfono: ${meal.address?.phoneNumber ? cleanText(meal.address.phoneNumber) : 'No especificado'}`);\r\n  if (meal.address?.addressType === 'shop' && meal.address?.localName) components.push(`Nombre del Local: ${cleanText(meal.address.localName)}`);\r\n  if (meal.address?.addressType === 'school' && meal.address?.recipientName) components.push(`Recibe: ${cleanText(meal.address.recipientName)}`);\r\n  if (meal.address?.addressType === 'complex' && meal.address?.unitDetails) components.push(`Unidad: ${cleanText(meal.address.unitDetails)}`);\r\n  components.push(`Pago: ${meal.payment?.name || meal.payment ? cleanText(meal.payment?.name || meal.payment) : 'Efectivo'}`);\r\n  return components.join('\\n');\r\n};\r\n\r\nexport const areMealsIdentical = (meals) => {\r\n  if (!meals || meals.length <= 1) return { areIdentical: false, count: 1 };\r\n  const fieldsToCompare = [\r\n    'soup', 'soupReplacement', 'principle', 'principleReplacement', 'protein', 'drink', 'cutlery', 'notes', 'time', 'payment',\r\n    'address.address', 'address.addressType', 'address.phoneNumber', 'address.localName', 'address.recipientName', 'address.unitDetails', 'sides', 'additions'\r\n  ];\r\n  const getMealSignature = (meal) => {\r\n    return fieldsToCompare.map(field => {\r\n      const value = getNestedProperty(meal, field);\r\n      if (field === 'sides' && Array.isArray(value)) return value.map(s => cleanText(s.name || s)).sort().join(',');\r\n      if (field === 'additions' && Array.isArray(value)) return value.map(a => `${cleanText(a.name || a)}${a.protein || a.replacement ? `:${cleanText(a.protein || a.replacement)}` : ''}:${a.quantity || 1}`).sort().join(';');\r\n      if (field === 'principle' && Array.isArray(value)) return value.map(p => cleanText(p.name || p)).sort().join(',');\r\n      return cleanText(value);\r\n    }).join('|');\r\n  };\r\n  const firstSignature = getMealSignature(meals[0]);\r\n  const areIdentical = meals.every(meal => getMealSignature(meal) === firstSignature);\r\n  return { areIdentical, count: meals.length };\r\n};","// src/components/Admin/TablaPedidos.js\r\nimport React, { useRef, useEffect, useState, useMemo } from 'react';\r\nimport { classNames } from '../../utils/classNames.js';\r\nimport { cleanText, getAddressDisplay } from './utils.js';\r\nimport { calculateMealPrice } from '../../utils/MealCalculations';\r\nimport {\r\n  ArrowDownTrayIcon,\r\n  ChevronLeftIcon,\r\n  ChevronRightIcon,\r\n  InformationCircleIcon,\r\n  PencilIcon,\r\n  TrashIcon,\r\n  EllipsisVerticalIcon,\r\n  PlusIcon\r\n} from '@heroicons/react/24/outline';\r\n\r\n// NUEVO: pagos\r\nimport PaymentSplitEditor from '../common/PaymentSplitEditor';\r\nimport { summarizePayments, sumPaymentsByMethod, defaultPaymentsForOrder } from '../../utils/payments';\r\n\r\n// Firestore para persistir pagos\r\nimport { db } from '../../config/firebase';\r\nimport { updateDoc, doc, getDoc } from 'firebase/firestore';\r\n\r\n/* ===========================\r\n   Helpers de resumen (in-file)\r\n   =========================== */\r\n\r\nconst normKey = (s) => (s || '').toString().trim().toLowerCase();\r\nconst normalizePaymentMethodKey = (method) => {\r\n  const raw = normKey(\r\n    typeof method === 'string'\r\n      ? method\r\n      : method?.name || method?.label || method?.title || method?.method || method?.type || ''\r\n  );\r\n  if (raw.includes('efect')) return 'cash';\r\n  if (raw.includes('cash')) return 'cash';\r\n  if (raw.includes('nequi')) return 'nequi';\r\n  if (raw.includes('davi')) return 'daviplata';\r\n  return 'other';\r\n};\r\n\r\nconst paymentsRowsFromOrder = (order, fallbackBuilder) => {\r\n  const total = Math.floor(Number(order?.total || 0)) || 0;\r\n\r\n  if (Array.isArray(order?.payments) && order.payments.length) {\r\n    return order.payments.map((p) => ({\r\n      methodKey: normalizePaymentMethodKey(p.method),\r\n      amount: Math.floor(Number(p.amount || 0)) || 0,\r\n    }));\r\n  }\r\n\r\n  const fb = typeof fallbackBuilder === 'function' ? (fallbackBuilder(order) || []) : [];\r\n  if (fb.length) {\r\n    return fb.map((p) => ({\r\n      methodKey: normalizePaymentMethodKey(p.method),\r\n      amount: Math.floor(Number(p.amount || 0)) || 0,\r\n    }));\r\n  }\r\n\r\n  return [{ methodKey: 'other', amount: total }];\r\n};\r\n\r\nconst sumPaymentsByDeliveryAndType = (orders, { fallbackBuilder } = {}) => {\r\n  const acc = {};\r\n  const ensureBucket = (person, bucket) => {\r\n    acc[person] = acc[person] || {};\r\n    acc[person][bucket] = acc[person][bucket] || { cash: 0, nequi: 0, daviplata: 0, other: 0, total: 0 };\r\n    return acc[person][bucket];\r\n  };\r\n  const bump = (obj, methodKey, amount) => {\r\n    if (!amount) return;\r\n    obj[methodKey] = (obj[methodKey] || 0) + amount;\r\n    obj.total += amount;\r\n  };\r\n\r\n  (orders || []).forEach((order) => {\r\n    const person = String(order?.deliveryPerson || 'JUAN').trim(); // default \"JUAN\" si no hay asignado\r\n    const isBreakfast = Array.isArray(order?.breakfasts) || order?.type === 'breakfast';\r\n    const bucket = isBreakfast ? 'breakfast' : 'lunch';\r\n    const rows = paymentsRowsFromOrder(order, fallbackBuilder);\r\n    const byType = ensureBucket(person, bucket);\r\n    const byTotal = ensureBucket(person, 'total');\r\n    rows.forEach(({ methodKey, amount }) => {\r\n      bump(byType, methodKey, amount);\r\n      bump(byTotal, methodKey, amount);\r\n    });\r\n  });\r\n\r\n  return acc;\r\n};\r\n\r\nconst money = (n) => `$${Math.floor(n || 0).toLocaleString('es-CO')}`;\r\n\r\n/* =======================\r\n   Component principal\r\n   ======================= */\r\n\r\nconst TablaPedidos = ({\r\n  theme,\r\n  orders,\r\n  searchTerm,\r\n  setSearchTerm,\r\n  totals, // puede venir del padre; si no, calculamos localmente con split\r\n  isLoading,\r\n  paginatedOrders,\r\n  currentPage,\r\n  totalPages,\r\n  setCurrentPage,\r\n  itemsPerPage,\r\n  setItemsPerPage,\r\n  deliveryPersons,\r\n  handleEditOrder,\r\n  handleDeleteOrder,\r\n  handleStatusChange,\r\n  handleSort,\r\n  getSortIcon,\r\n  setShowMealDetails,\r\n  editingDeliveryId,\r\n  setEditingDeliveryId,\r\n  editForm,\r\n  setEditForm,\r\n  handleDeliveryChange,\r\n  sortOrder,\r\n  showProteinModal,\r\n  setShowProteinModal,\r\n  isMenuOpen,\r\n  setIsMenuOpen,\r\n  handleOpenPreview,\r\n  handleOpenExcelPreview,\r\n  handleExport,\r\n  handleDeleteAllOrders,\r\n  setShowConfirmDeleteAll,\r\n  exportToExcel,\r\n  exportToPDF,\r\n  exportToCSV,\r\n  setShowAddOrderModal,\r\n  orderTypeFilter,\r\n  setOrderTypeFilter,\r\n  uniqueDeliveryPersons,\r\n}) => {\r\n  const currentDate = new Date().toLocaleDateString('es-CO', {\r\n    weekday: 'long',\r\n    month: 'long',\r\n    day: 'numeric',\r\n  });\r\n\r\n  const menuRef = useRef(null);\r\n  const [deliveryDraft, setDeliveryDraft] = useState('');\r\n  const lastAssignedRef = useRef('');\r\n\r\n  useEffect(() => {\r\n    function handleClickOutside(event) {\r\n      if (menuRef.current && !menuRef.current.contains(event.target)) {\r\n        setIsMenuOpen(false);\r\n      }\r\n    }\r\n    if (isMenuOpen) document.addEventListener('mousedown', handleClickOutside);\r\n    return () => document.removeEventListener('mousedown', handleClickOutside);\r\n  }, [isMenuOpen, setIsMenuOpen]);\r\n\r\n  // ====== Split de pagos: estado para modal local ======\r\n  const [editingPaymentsOrder, setEditingPaymentsOrder] = useState(null);\r\n\r\n  //  Incluye tus colecciones reales\r\n  const EXTRA_COLLECTIONS = [\r\n    'orders',\r\n    'deliveryOrders',\r\n    'tableOrders',\r\n    'deliveryBreakfastOrders', // < importante para desayunos\r\n    'breakfastOrders',\r\n    'domicilioOrders'\r\n  ];\r\n\r\n  //  Heurstica afinada a tus nombres reales\r\n  const resolveCollectionName = (order) => {\r\n    if (order?.__collection) return order.__collection;\r\n    if (order?.collectionName) return order.collectionName;\r\n\r\n    const isBreakfast =\r\n      order?.type === 'breakfast' ||\r\n      Array.isArray(order?.breakfasts);\r\n\r\n    if (isBreakfast) return 'deliveryBreakfastOrders';\r\n    return 'orders'; // almuerzos\r\n  };\r\n\r\n  //  Busca la orden probando todas las variantes conocidas\r\n  const findExistingOrderRef = async (order) => {\r\n    const id = order?.id;\r\n    if (!id) throw new Error('Order sin id');\r\n\r\n    const preferred = [];\r\n    if (order?.__collection) preferred.push(order.__collection);\r\n    if (order?.collectionName && order?.collectionName !== order?.__collection) {\r\n      preferred.push(order.collectionName);\r\n    }\r\n\r\n    const guess = resolveCollectionName(order);\r\n    const BASE = ['orders', 'deliveryOrders', 'tableOrders', 'deliveryBreakfastOrders', 'breakfastOrders'];\r\n    const orderedBase = [guess, ...BASE.filter((c) => c !== guess)];\r\n\r\n    const candidates = [\r\n      ...preferred.filter(Boolean),\r\n      ...orderedBase,\r\n      ...EXTRA_COLLECTIONS,\r\n    ].filter((v, i, a) => !!v && a.indexOf(v) === i); // nicos\r\n\r\n    for (const col of candidates) {\r\n      const ref = doc(db, col, id);\r\n      const snap = await getDoc(ref);\r\n      if (snap.exists()) return ref;\r\n    }\r\n\r\n    return null;\r\n  };\r\n\r\n  const savePaymentsForOrder = async (order, payments) => {\r\n    const sum = (payments || []).reduce(\r\n      (a, b) => a + (Math.floor(Number(b.amount || 0)) || 0),\r\n      0\r\n    );\r\n    const total = Math.floor(Number(order.total || 0)) || 0;\r\n\r\n    if (sum !== total) {\r\n      alert(\r\n        `La suma de pagos (${sum.toLocaleString(\r\n          'es-CO'\r\n        )}) no coincide con el total (${total.toLocaleString('es-CO')}).`\r\n      );\r\n      return false;\r\n    }\r\n\r\n    const ref = await findExistingOrderRef(order);\r\n    if (!ref) {\r\n      alert(\r\n        'No se pudo guardar los pagos: la orden no existe en ninguna coleccin conocida (orders/deliveryBreakfastOrders y variantes).'\r\n      );\r\n      return false;\r\n    }\r\n\r\n    const payload = {\r\n      payments: (payments || []).map((p) => ({\r\n        method: typeof p.method === 'string' ? p.method : p?.method?.name || '',\r\n        amount: Math.floor(Number(p.amount || 0)) || 0,\r\n        note: p.note || '',\r\n      })),\r\n      updatedAt: new Date(),\r\n    };\r\n\r\n    try {\r\n      await updateDoc(ref, payload);\r\n      return true;\r\n    } catch (e) {\r\n      console.error('[Pagos] updateDoc error', e);\r\n      const code = e?.code || '';\r\n      const msg = String(e?.message || '');\r\n      if (code === 'permission-denied') {\r\n        alert('No se pudo guardar los pagos: permisos insuficientes segn tus reglas de Firestore.');\r\n      } else {\r\n        alert('No se pudo guardar los pagos: ' + (msg || code || 'Error desconocido.'));\r\n      }\r\n      return false;\r\n    }\r\n  };\r\n\r\n  // Totales superiores (tiles)\r\nconst totalsDisplay = useMemo(() => sumPaymentsByMethod(orders || []), [orders]);\r\n\r\n  // ===== Resumen por Domiciliarios (exacto con split) =====\r\n  const resumen = useMemo(\r\n    () => sumPaymentsByDeliveryAndType(orders || [], { fallbackBuilder: defaultPaymentsForOrder }),\r\n    [orders]\r\n  );\r\n  const resumenPersons = useMemo(\r\n    () => Object.keys(resumen).sort((a, b) => a.localeCompare(b, 'es')),\r\n    [resumen]\r\n  );\r\n\r\n  const handleSettle = (person, buckets) => {\r\n    console.log('[Liquidar]', person, buckets);\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6\">\r\n        <h2 className=\"text-2xl sm:text-3xl font-bold text-gray-900 dark:text-gray-100 mb-6\">\r\n          Gestin de Pedidos Domicilios\r\n        </h2>\r\n\r\n        {/* Totals Section */}\r\n        <div className=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 mb-6 text-sm text-gray-700 dark:text-gray-300\">\r\n          <div className={classNames('p-3 sm:p-4 rounded-lg shadow-sm', theme === 'dark' ? 'bg-gray-700' : 'bg-gray-100')}>\r\n            <p className=\"font-semibold text-sm sm:text-base\">Total Efectivo</p>\r\n            <p className=\"text-lg sm:text-xl font-bold\">${Math.floor(totalsDisplay.cash || 0).toLocaleString('es-CO')}</p>\r\n          </div>\r\n          <div className={classNames('p-3 sm:p-4 rounded-lg shadow-sm', theme === 'dark' ? 'bg-gray-700' : 'bg-gray-100')}>\r\n            <p className=\"font-semibold text-sm sm:text-base\">Total Daviplata</p>\r\n            <p className=\"text-lg sm:text-xl font-bold\">${Math.floor(totalsDisplay.daviplata || 0).toLocaleString('es-CO')}</p>\r\n          </div>\r\n          <div className={classNames('p-3 sm:p-4 rounded-lg shadow-sm', theme === 'dark' ? 'bg-gray-700' : 'bg-gray-100')}>\r\n            <p className=\"font-semibold text-sm sm:text-base\">Total Nequi</p>\r\n            <p className=\"text-lg sm:text-xl font-bold\">${Math.floor(totalsDisplay.nequi || 0).toLocaleString('es-CO')}</p>\r\n          </div>\r\n          <div className={classNames('p-3 sm:p-4 rounded-lg shadow-sm', theme === 'dark' ? 'bg-gray-700' : 'bg-gray-100')}>\r\n            <p className=\"font-semibold text-sm sm:text-base\">Total General</p>\r\n            <p className=\"text-lg sm:text-xl font-bold\">\r\n              ${Math.floor((totalsDisplay.cash || 0) + (totalsDisplay.daviplata || 0) + (totalsDisplay.nequi || 0)).toLocaleString('es-CO')}\r\n            </p>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Search, Proteins, Date, and Menu */}\r\n        <div className=\"flex flex-wrap justify-center sm:justify-between items-center mb-6 gap-3 sm:gap-4\">\r\n          <input\r\n            type=\"text\"\r\n            value={searchTerm}\r\n            onChange={(e) => setSearchTerm(e.target.value)}\r\n            placeholder=\"Buscar pedidos...\"\r\n            className={classNames(\r\n              'p-2 sm:p-3 rounded-lg border focus:outline-none focus:ring-2 focus:ring-blue-500 w-full sm:max-w-xs shadow-sm text-sm sm:text-base transition-all duration-200',\r\n              theme === 'dark' ? 'border-gray-600 bg-gray-700 text-white' : 'border-gray-300 bg-white text-gray-900'\r\n            )}\r\n          />\r\n          <div className=\"flex flex-wrap items-center justify-center sm:justify-end gap-2\">\r\n            <button\r\n              onClick={() => setShowProteinModal(true)}\r\n              className={classNames(\r\n                'flex items-center justify-center gap-2 px-3 py-2 sm:px-5 sm:py-3 rounded-lg text-xs sm:text-sm font-semibold transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-blue-500 flex-shrink-0',\r\n                theme === 'dark' ? 'bg-gray-600 hover:bg-gray-500 text-white border border-gray-500' : 'bg-gray-200 hover:bg-gray-300 text-gray-900 border border-gray-400'\r\n              )}\r\n            >\r\n              <PlusIcon className=\"w-4 h-4\" />\r\n              <span className=\"hidden md:inline\">Protenas del Da</span>\r\n            </button>\r\n            <div\r\n              className={classNames(\r\n                'flex items-center justify-center gap-2 px-3 py-2 sm:px-5 sm:py-3 rounded-lg text-xs sm:text-sm font-semibold shadow-sm border transition-colors duration-200 flex-shrink-0',\r\n                theme === 'dark' ? 'bg-gray-700 text-white border-gray-500' : 'bg-gray-200 text-gray-900 border-gray-400'\r\n              )}\r\n            >\r\n              {currentDate}\r\n            </div>\r\n            <div className=\"relative flex-shrink-0\" ref={menuRef}>\r\n              <button\r\n                onClick={() => setIsMenuOpen(!isMenuOpen)}\r\n                className={classNames('flex items-center justify-center p-2 rounded-lg text-xs sm:text-sm font-medium transition-all duration-200', 'focus:outline-none focus:ring-2 focus:ring-blue-500')}\r\n                aria-label=\"Opciones de men\"\r\n              >\r\n                <EllipsisVerticalIcon className={classNames('w-6 h-6', theme === 'dark' ? 'text-gray-200 hover:text-white' : 'text-gray-700 hover:text-gray-900')} />\r\n              </button>\r\n              {isMenuOpen && (\r\n                <div className={classNames('absolute right-0 mt-2 w-48 rounded-lg shadow-xl z-50', theme === 'dark' ? 'bg-gray-700 text-gray-200' : 'bg-white text-gray-900')}>\r\n                  <div className=\"py-1\">\r\n                    <button onClick={() => { setOrderTypeFilter('breakfast'); setIsMenuOpen(false); }} className=\"block w-full text-left px-4 py-2 text-sm hover:bg-gray-100 dark:hover:bg-gray-600 transition-all duration-200\">Ver Desayunos</button>\r\n                    <button onClick={() => { setOrderTypeFilter('lunch'); setIsMenuOpen(false); }} className=\"block w-full text-left px-4 py-2 text-sm hover:bg-gray-100 dark:hover:bg-gray-600 transition-all duration-200\">Ver Almuerzos</button>\r\n                    <button onClick={() => { setOrderTypeFilter('all'); setIsMenuOpen(false); }} className=\"block w-full text-left px-4 py-2 text-sm hover:bg-gray-100 dark:hover:bg-gray-600 transition-all duration-200\">Ver Todos</button>\r\n                    <button onClick={() => { setShowAddOrderModal(true); setIsMenuOpen(false); }} className=\"block w-full text-left px-4 py-2 text-sm hover:bg-gray-100 dark:hover:bg-gray-600 transition-all duration-200\">Generar Orden</button>\r\n                    <button onClick={() => { handleOpenPreview(); setIsMenuOpen(false); }} className=\"block w-full text-left px-4 py-2 text-sm hover:bg-gray-100 dark:hover:bg-gray-600 transition-all duration-200\">Vista Previa PDF</button>\r\n                    <button onClick={() => { handleOpenExcelPreview(); setIsMenuOpen(false); }} className=\"block w-full text-left px-4 py-2 text-sm hover:bg-gray-100 dark:hover:bg-gray-600 transition-all duration-200\">Vista Previa Excel</button>\r\n                    <button onClick={() => { handleExport(exportToExcel, 'Excel'); setIsMenuOpen(false); }} className=\"block w-full text-left px-4 py-2 text-sm hover:bg-gray-100 dark:hover:bg-gray-600 transition-all duration-200 flex items-center\">\r\n                      <ArrowDownTrayIcon className=\"w-4 h-4 mr-2\" /> Exportar Excel\r\n                    </button>\r\n                    <button onClick={() => { handleExport(exportToPDF, 'PDF'); setIsMenuOpen(false); }} className=\"block w-full text-left px-4 py-2 text-sm hover:bg-gray-100 dark:hover:bg-gray-600 transition-all duration-200 flex items-center\">\r\n                      <ArrowDownTrayIcon className=\"w-4 h-4 mr-2\" /> Exportar PDF\r\n                    </button>\r\n                    <button onClick={() => { handleExport(exportToCSV, 'CSV'); setIsMenuOpen(false); }} className=\"block w-full text-left px-4 py-2 text-sm hover:bg-gray-100 dark:hover:bg-gray-600 transition-all duration-200 flex items-center\">\r\n                      <ArrowDownTrayIcon className=\"w-4 h-4 mr-2\" /> Exportar CSV\r\n                    </button>\r\n                    <button onClick={() => { setShowConfirmDeleteAll(true); setIsMenuOpen(false); }} className=\"block w-full text-left px-4 py-2 text-sm hover:bg-gray-100 dark:hover:bg-gray-600 transition-all duration-200 text-red-500\">Eliminar Todos</button>\r\n                  </div>\r\n                </div>\r\n              )}\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Orders Table */}\r\n        <div className={classNames('p-3 sm:p-4 rounded-2xl shadow-xl max-h-[70vh] overflow-y-auto custom-scrollbar transition-all duration-300', theme === 'dark' ? 'bg-gray-800' : 'bg-white')}>\r\n          {isLoading ? (\r\n            <div className=\"flex justify-center items-center h-40\">\r\n              <div className=\"animate-spin rounded-full h-12 w-12 border-t-4 border-blue-500\"></div>\r\n            </div>\r\n          ) : (\r\n            <>\r\n              <div className=\"overflow-x-auto\">\r\n                <table className=\"min-w-full text-left border-collapse text-sm\">\r\n                  <thead>\r\n                    <tr className={classNames('font-semibold sticky top-0 z-10 shadow-sm', theme === 'dark' ? 'bg-gray-700 text-gray-200' : 'bg-gray-100 text-gray-700')}>\r\n                      <th className=\"p-2 sm:p-3 border-b cursor-pointer whitespace-nowrap\" onClick={() => handleSort('orderNumber')}>N {getSortIcon('orderNumber')}</th>\r\n                      <th className=\"p-2 sm:p-3 border-b whitespace-nowrap\">Detalles</th>\r\n                      <th className=\"p-2 sm:p-3 border-b cursor-pointer whitespace-nowrap\" onClick={() => handleSort('address')}>Direccin {getSortIcon('address')}</th>\r\n                      <th className=\"p-2 sm:p-3 border-b cursor-pointer whitespace-nowrap\" onClick={() => handleSort('phone')}>Telfono {getSortIcon('phone')}</th>\r\n                      <th className=\"p-2 sm:p-3 border-b cursor-pointer whitespace-nowrap\" onClick={() => handleSort('time')}>Hora {getSortIcon('time')}</th>\r\n                      <th className=\"p-2 sm:p-3 border-b cursor-pointer whitespace-nowrap\" onClick={() => handleSort('payment')}>Pago {getSortIcon('payment')}</th>\r\n                      <th className=\"p-2 sm:p-3 border-b cursor-pointer whitespace-nowrap\" onClick={() => handleSort('total')}>Total {getSortIcon('total')}</th>\r\n                      <th className=\"p-2 sm:p-3 border-b cursor-pointer whitespace-nowrap\" onClick={() => handleSort('deliveryPerson')}>Domiciliario {getSortIcon('deliveryPerson')}</th>\r\n                      <th className=\"p-2 sm:p-3 border-b cursor-pointer whitespace-nowrap\" onClick={() => handleSort('status')}>Estado {getSortIcon('status')}</th>\r\n                      <th className=\"p-2 sm:p-3 border-b whitespace-nowrap\">Acciones</th>\r\n                    </tr>\r\n                  </thead>\r\n                  <tbody>\r\n                    {paginatedOrders.length === 0 ? (\r\n                      <tr>\r\n                        <td colSpan=\"10\" className=\"p-6 text-center text-gray-500 dark:text-gray-400\">No se encontraron pedidos. Intenta ajustar tu bsqueda o filtros.</td>\r\n                      </tr>\r\n                    ) : (\r\n                      paginatedOrders.map((order, index) => {\r\n                        const displayNumber =\r\n                          sortOrder === 'asc'\r\n                            ? (currentPage - 1) * itemsPerPage + index + 1\r\n                            : paginatedOrders.length - ((currentPage - 1) * itemsPerPage + index);\r\n\r\n                        const addressDisplay = getAddressDisplay(order.meals?.[0]?.address || order.breakfasts?.[0]?.address);\r\n\r\n                        const rawLegacy = cleanText(\r\n                          order.payment ||\r\n                          order.meals?.[0]?.payment?.name ||\r\n                          order.breakfasts?.[0]?.payment?.name ||\r\n                          'Sin pago'\r\n                        );\r\n\r\n                        const paymentDisplay =\r\n                          Array.isArray(order.payments) && order.payments.length\r\n                            ? summarizePayments(order.payments)\r\n                            : rawLegacy;\r\n\r\n                        const statusClass =\r\n                          order.status === 'Pendiente' ? 'bg-yellow-500 text-black'\r\n                            : order.status === 'Entregado' ? 'bg-green-500 text-white'\r\n                            : order.status === 'Cancelado' ? 'bg-red-500 text-white'\r\n                            : '';\r\n\r\n                        const timeValue = order.meals?.[0]?.time || order.breakfasts?.[0]?.time;\r\n                        let displayTime = 'N/A';\r\n                        if (typeof timeValue === 'string') displayTime = timeValue;\r\n                        else if (typeof timeValue === 'object' && timeValue !== null) displayTime = timeValue.name || 'N/A';\r\n\r\n                        return (\r\n                          <tr\r\n                            key={order.id}\r\n                            className={classNames(\r\n                              'border-b transition-colors duration-150',\r\n                              theme === 'dark' ? 'border-gray-700 hover:bg-gray-700' : 'border-gray-200 hover:bg-gray-50',\r\n                              index % 2 === 0 ? (theme === 'dark' ? 'bg-gray-750' : 'bg-gray-50') : ''\r\n                            )}\r\n                          >\r\n                            <td className=\"p-2 sm:p-3 text-gray-300\">{displayNumber}</td>\r\n                            <td className=\"p-2 sm:p-3 text-gray-300\">\r\n                              <button\r\n                                onClick={() => setShowMealDetails(order)}\r\n                                className=\"text-blue-400 hover:text-blue-300 text-xs sm:text-sm flex items-center\"\r\n                                title=\"Ver detalles de la bandeja\"\r\n                              >\r\n                                <InformationCircleIcon className=\"w-4 h-4 mr-1\" />\r\n                                Ver\r\n                              </button>\r\n                            </td>\r\n                            <td className=\"p-2 sm:p-3 text-gray-300 max-w-[150px] sm:max-w-xs overflow-hidden text-ellipsis whitespace-nowrap\">\r\n                              {addressDisplay}\r\n                            </td>\r\n                            <td className=\"p-2 sm:p-3 text-gray-300 whitespace-nowrap\">\r\n                              {order.meals?.[0]?.address?.phoneNumber ||\r\n                                order.breakfasts?.[0]?.address?.phoneNumber ||\r\n                                'N/A'}\r\n                            </td>\r\n                            <td className=\"p-2 sm:p-3 text-gray-300 whitespace-nowrap\">{displayTime}</td>\r\n                            <td className=\"p-2 sm:p-3 text-gray-300 whitespace-nowrap\">{paymentDisplay}</td>\r\n                            <td className=\"p-2 sm:p-3 text-gray-300 whitespace-nowrap\">\r\n                              ${order.total?.toLocaleString('es-CO') || '0'}\r\n                            </td>\r\n                            <td className=\"p-2 sm:p-3 text-gray-300 whitespace-nowrap\">\r\n                              {editingDeliveryId === order.id ? (\r\n                                <>\r\n                                  <input\r\n                                    list={`delivery-list-${order.id}`}\r\n                                    value={deliveryDraft}\r\n                                    onChange={(e) => setDeliveryDraft(e.target.value)}\r\n                                    onKeyDown={(e) => {\r\n                                      if (e.key === 'Enter') {\r\n                                        const valueToSave = (deliveryDraft || '').trim() || 'Sin asignar';\r\n                                        handleDeliveryChange(order.id, valueToSave);\r\n                                        if (valueToSave !== 'Sin asignar') lastAssignedRef.current = valueToSave;\r\n                                        setEditingDeliveryId(null);\r\n                                      } else if (e.key === 'Escape') {\r\n                                        setEditingDeliveryId(null);\r\n                                      }\r\n                                    }}\r\n                                    onBlur={() => {\r\n                                      const valueToSave = (deliveryDraft || '').trim() || 'Sin asignar';\r\n                                      handleDeliveryChange(order.id, valueToSave);\r\n                                      if (valueToSave !== 'Sin asignar') lastAssignedRef.current = valueToSave;\r\n                                      setEditingDeliveryId(null);\r\n                                    }}\r\n                                    placeholder=\"Escribe y Enter\"\r\n                                    className={classNames(\r\n                                      'w-40 p-1 rounded-md border text-sm',\r\n                                      theme === 'dark' ? 'border-gray-600 bg-gray-700 text-white' : 'border-gray-200 bg-white text-gray-900',\r\n                                      'focus:outline-none focus:ring-1 focus:ring-blue-500'\r\n                                    )}\r\n                                    autoFocus\r\n                                  />\r\n                                  <datalist id={`delivery-list-${order.id}`}>\r\n                                    <option value=\"Sin asignar\" />\r\n                                    {uniqueDeliveryPersons.map((person) => (\r\n                                      <option key={person} value={person} />\r\n                                    ))}\r\n                                  </datalist>\r\n                                </>\r\n                              ) : (\r\n                                <span\r\n                                  onClick={() => {\r\n                                    const initial = order.deliveryPerson || lastAssignedRef.current || '';\r\n                                    setDeliveryDraft(initial);\r\n                                    setEditingDeliveryId(order.id);\r\n                                  }}\r\n                                  className=\"cursor-pointer hover:text-blue-400\"\r\n                                  title=\"Click para editar; Enter para guardar\"\r\n                                >\r\n                                  {order.deliveryPerson || 'Sin asignar'}\r\n                                </span>\r\n                              )}\r\n                            </td>\r\n                            <td className=\"p-2 sm:p-3 whitespace-nowrap\">\r\n                              <select\r\n                                value={order.status || 'Pendiente'}\r\n                                onChange={(e) => handleStatusChange(order.id, e.target.value)}\r\n                                className={classNames(\r\n                                  'px-2 py-1 rounded-full text-xs font-semibold appearance-none cursor-pointer',\r\n                                  statusClass,\r\n                                  theme === 'dark' ? 'bg-opacity-70' : 'bg-opacity-90',\r\n                                  'focus:outline-none focus:ring-2 focus:ring-blue-500'\r\n                                )}\r\n                              >\r\n                                <option value=\"Pendiente\">Pendiente</option>\r\n                                <option value=\"En Preparacin\">En Preparacin</option>\r\n                                <option value=\"En Camino\">En Camino</option>\r\n                                <option value=\"Entregado\">Entregado</option>\r\n                                <option value=\"Cancelado\">Cancelado</option>\r\n                              </select>\r\n                            </td>\r\n                            <td className=\"p-2 sm:p-3 whitespace-nowrap\">\r\n                              <div className=\"flex gap-2\">\r\n                                <button\r\n                                  onClick={() => handleEditOrder(order)}\r\n                                  className=\"text-blue-500 hover:text-blue-400 transition-colors duration-150 p-1 rounded-md\"\r\n                                  title=\"Editar pedido\"\r\n                                  aria-label={`Editar pedido ${displayNumber}`}\r\n                                >\r\n                                  <PencilIcon className=\"w-5 h-5\" />\r\n                                </button>\r\n                                <button\r\n                                  onClick={() => setEditingPaymentsOrder(order)}\r\n                                  className=\"text-indigo-500 hover:text-indigo-400 transition-colors duration-150 p-1 rounded-md\"\r\n                                  title=\"Editar pagos (split)\"\r\n                                  aria-label={`Editar pagos del pedido ${displayNumber}`}\r\n                                >\r\n                                  \r\n                                </button>\r\n                                <button\r\n                                  onClick={() => handleDeleteOrder(order.id)}\r\n                                  className=\"text-red-500 hover:text-red-400 transition-colors duration-150 p-1 rounded-md\"\r\n                                  title=\"Eliminar pedido\"\r\n                                  aria-label={`Eliminar pedido ${displayNumber}`}\r\n                                >\r\n                                  <TrashIcon className=\"w-5 h-5\" />\r\n                                </button>\r\n                              </div>\r\n                            </td>\r\n                          </tr>\r\n                        );\r\n                      })\r\n                    )}\r\n                  </tbody>\r\n                </table>\r\n              </div>\r\n\r\n              {/* Pagination */}\r\n              <div className=\"flex flex-wrap justify-between items-center mt-6 gap-3\">\r\n                <div className=\"flex items-center gap-2 text-sm text-gray-700 dark:text-gray-300\">\r\n                  <span>Pedidos por pgina:</span>\r\n                  <select\r\n                    value={itemsPerPage}\r\n                    onChange={(e) => { setItemsPerPage(Number(e.target.value)); setCurrentPage(1); }}\r\n                    className={classNames('p-2 rounded-md border text-sm', theme === 'dark' ? 'border-gray-600 bg-gray-700 text-white' : 'border-gray-300 bg-white text-gray-900')}\r\n                  >\r\n                    <option value=\"10\">10</option>\r\n                    <option value=\"20\">20</option>\r\n                    <option value=\"30\">30</option>\r\n                    <option value=\"50\">50</option>\r\n                  </select>\r\n                </div>\r\n                <div className=\"flex items-center gap-2 text-sm text-gray-700 dark:text-gray-300\">\r\n                  <button\r\n                    onClick={() => setCurrentPage((prev) => Math.max(prev - 1, 1))}\r\n                    disabled={currentPage === 1}\r\n                    className={classNames(\r\n                      'p-2 rounded-md transition-colors duration-200',\r\n                      currentPage === 1 ? 'text-gray-400 dark:text-gray-600 cursor-not-allowed' : theme === 'dark' ? 'hover:bg-gray-700 text-gray-200' : 'hover:bg-gray-100 text-gray-700'\r\n                    )}\r\n                  >\r\n                    <ChevronLeftIcon className=\"w-5 h-5\" />\r\n                  </button>\r\n                  <span>Pgina {currentPage} de {totalPages}</span>\r\n                  <button\r\n                    onClick={() => setCurrentPage((prev) => Math.min(prev + 1, totalPages))}\r\n                    disabled={currentPage === totalPages}\r\n                    className={classNames(\r\n                      'p-2 rounded-md transition-colors duration-200',\r\n                      currentPage === totalPages ? 'text-gray-400 dark:text-gray-600 cursor-not-allowed' : theme === 'dark' ? 'hover:bg-gray-700 text-gray-200' : 'hover:bg-gray-100 text-gray-700'\r\n                    )}\r\n                  >\r\n                    <ChevronRightIcon className=\"w-5 h-5\" />\r\n                  </button>\r\n                </div>\r\n              </div>\r\n            </>\r\n          )}\r\n        </div>\r\n\r\n        {/* === Resumen por Domiciliarios (NICO) === */}\r\n        <div className=\"mt-8 space-y-6\">\r\n          <h2 className=\"text-xl sm:text-2xl font-bold\">Resumen por Domiciliarios</h2>\r\n\r\n          {resumenPersons.length === 0 ? (\r\n            <div className={classNames(\r\n              \"rounded-2xl p-6 text-center\",\r\n              theme === 'dark' ? 'bg-gray-800 text-gray-300' : 'bg-white text-gray-700'\r\n            )}>\r\n              No hay datos para el resumen de domiciliarios.\r\n            </div>\r\n          ) : (\r\n            <div className=\"grid grid-cols-1 gap-6\">\r\n              {resumenPersons.map((person) => {\r\n                const buckets = resumen[person] || {};\r\n                const lunch = buckets.lunch || { cash:0, nequi:0, daviplata:0, other:0, total:0 };\r\n                const breakfast = buckets.breakfast || { cash:0, nequi:0, daviplata:0, other:0, total:0 };\r\n                const overall = buckets.total || { cash:0, nequi:0, daviplata:0, other:0, total:0 };\r\n\r\n                return (\r\n                  <div key={person} className={classNames(\r\n                    \"rounded-2xl p-4 sm:p-5 shadow-sm\",\r\n                    theme === 'dark' ? 'bg-gray-800 border border-gray-700' : 'bg-white border border-gray-200'\r\n                  )}>\r\n                    <div className=\"flex items-center justify-between mb-3\">\r\n                      <h3 className=\"text-base sm:text-lg font-semibold\">{person}</h3>\r\n                      <button\r\n                        onClick={() => handleSettle(person, buckets)}\r\n                        className=\"text-xs px-3 py-1.5 rounded-md bg-indigo-600 hover:bg-indigo-700 text-white\"\r\n                      >\r\n                        Liquidar \r\n                      </button>\r\n                    </div>\r\n\r\n                    <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n                      {/* Almuerzo */}\r\n                      <div>\r\n                        <div className=\"text-sm font-medium mb-2\">Almuerzo</div>\r\n                        <div className={classNames(\r\n                          \"rounded-lg p-3 sm:p-4 border\",\r\n                          theme === 'dark' ? 'bg-gray-800/60 border-gray-700' : 'bg-gray-50 border-gray-200'\r\n                        )}>\r\n                          <div className=\"flex justify-between text-sm my-0.5\"><span>Efectivo</span><span className=\"font-semibold\">{money(lunch.cash)}</span></div>\r\n                          <div className=\"flex justify-between text-sm my-0.5\"><span>Daviplata</span><span className=\"font-semibold\">{money(lunch.daviplata)}</span></div>\r\n                          <div className=\"flex justify-between text-sm my-0.5\"><span>Nequi</span><span className=\"font-semibold\">{money(lunch.nequi)}</span></div>\r\n                          {lunch.other > 0 && (\r\n                            <div className=\"flex justify-between text-sm my-0.5\"><span>Otros</span><span className=\"font-semibold\">{money(lunch.other)}</span></div>\r\n                          )}\r\n                          <div className=\"h-px my-2 bg-gray-200 dark:bg-gray-700\" />\r\n                          <div className=\"flex justify-between text-sm\"><span className=\"font-medium\">Total</span><span className=\"font-bold\">{money(lunch.total)}</span></div>\r\n                        </div>\r\n                      </div>\r\n\r\n                      {/* Desayuno */}\r\n                      <div>\r\n                        <div className=\"text-sm font-medium mb-2\">Desayuno</div>\r\n                        <div className={classNames(\r\n                          \"rounded-lg p-3 sm:p-4 border\",\r\n                          theme === 'dark' ? 'bg-gray-800/60 border-gray-700' : 'bg-gray-50 border-gray-200'\r\n                        )}>\r\n                          <div className=\"flex justify-between text-sm my-0.5\"><span>Efectivo</span><span className=\"font-semibold\">{money(breakfast.cash)}</span></div>\r\n                          <div className=\"flex justify-between text-sm my-0.5\"><span>Daviplata</span><span className=\"font-semibold\">{money(breakfast.daviplata)}</span></div>\r\n                          <div className=\"flex justify-between text-sm my-0.5\"><span>Nequi</span><span className=\"font-semibold\">{money(breakfast.nequi)}</span></div>\r\n                          {breakfast.other > 0 && (\r\n                            <div className=\"flex justify-between text-sm my-0.5\"><span>Otros</span><span className=\"font-semibold\">{money(breakfast.other)}</span></div>\r\n                          )}\r\n                          <div className=\"h-px my-2 bg-gray-200 dark:bg-gray-700\" />\r\n                          <div className=\"flex justify-between text-sm\"><span className=\"font-medium\">Total</span><span className=\"font-bold\">{money(breakfast.total)}</span></div>\r\n                        </div>\r\n                      </div>\r\n                    </div>\r\n\r\n                    <div className=\"mt-4\">\r\n                      <div className=\"text-sm font-medium mb-2\">Total general</div>\r\n                      <div className={classNames(\r\n                        \"rounded-lg p-3 sm:p-4 border\",\r\n                        theme === 'dark' ? 'bg-gray-800/60 border-gray-700' : 'bg-gray-50 border-gray-200'\r\n                      )}>\r\n                        <div className=\"flex justify-between text-sm my-0.5\"><span>Efectivo</span><span className=\"font-semibold\">{money(overall.cash)}</span></div>\r\n                        <div className=\"flex justify-between text-sm my-0.5\"><span>Daviplata</span><span className=\"font-semibold\">{money(overall.daviplata)}</span></div>\r\n                        <div className=\"flex justify-between text-sm my-0.5\"><span>Nequi</span><span className=\"font-semibold\">{money(overall.nequi)}</span></div>\r\n                        {overall.other > 0 && (\r\n                          <div className=\"flex justify-between text-sm my-0.5\"><span>Otros</span><span className=\"font-semibold\">{money(overall.other)}</span></div>\r\n                        )}\r\n                        <div className=\"h-px my-2 bg-gray-200 dark:bg-gray-700\" />\r\n                        <div className=\"flex justify-between text-sm\"><span className=\"font-medium\">Total</span><span className=\"font-bold\">{money(overall.total)}</span></div>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                );\r\n              })}\r\n            </div>\r\n          )}\r\n        </div>\r\n      </div>\r\n\r\n      {/* Modal de edicin de pagos (split) */}\r\n      {editingPaymentsOrder && (\r\n        <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[10001]\">\r\n          <div className={classNames('p-4 sm:p-6 rounded-lg max-w-xl w-full max-h-[80vh] overflow-y-auto', theme === 'dark' ? 'bg-gray-800 text-gray-200' : 'bg-white text-gray-900')}>\r\n            <h3 className=\"text-lg font-semibold mb-4\">\r\n              Editar pagos  Orden #{editingPaymentsOrder.id.slice(0, 8)}\r\n            </h3>\r\n\r\n            <PaymentSplitEditor\r\n              theme={theme}\r\n              total={editingPaymentsOrder.total || 0}\r\n              value={\r\n                Array.isArray(editingPaymentsOrder.payments) && editingPaymentsOrder.payments.length\r\n                  ? editingPaymentsOrder.payments\r\n                  : defaultPaymentsForOrder(editingPaymentsOrder)\r\n              }\r\n              onChange={(rows) => {\r\n                setEditingPaymentsOrder((prev) => ({ ...prev, payments: rows }));\r\n              }}\r\n            />\r\n\r\n            <div className=\"mt-4 flex gap-2 justify-end\">\r\n              <button onClick={() => setEditingPaymentsOrder(null)} className=\"px-4 py-2 bg-gray-600 text-white rounded hover:bg-gray-700 text-sm\">\r\n                Cancelar\r\n              </button>\r\n              <button\r\n                onClick={async () => {\r\n                  const ok = await savePaymentsForOrder(editingPaymentsOrder, editingPaymentsOrder.payments || []);\r\n                  if (ok) setEditingPaymentsOrder(null);\r\n                }}\r\n                className=\"px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700 text-sm\"\r\n              >\r\n                Guardar\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n    </>\r\n  );\r\n};\r\n\r\nexport default TablaPedidos;\r\n","// src/components/Admin/InteraccionesPedidos.js\r\nimport React, { useState, useEffect } from 'react';\r\nimport { Dialog, Transition } from '@headlessui/react';\r\nimport { XMarkIcon, TrashIcon, PencilIcon } from '@heroicons/react/24/outline';\r\nimport { classNames } from '../../utils/classNames';\r\nimport OrderSummary from '../OrderSummary';\r\nimport BreakfastOrderSummary from '../BreakfastOrderSummary';\r\nimport { db } from '../../config/firebase';\r\nimport { deleteDoc, doc, updateDoc, onSnapshot, collection } from 'firebase/firestore';\r\nimport OptionSelector from '../OptionSelector';\r\nimport { calculateTotal } from '../../utils/MealCalculations';\r\nimport { calculateBreakfastPrice } from '../../utils/BreakfastCalculations';\r\n\r\n\r\n// ===================== Helpers para hidratacin =====================\r\nconst normalizeName = (s) => (s || '').replace(/\\s*NUEVO\\s*$/i, '').trim();\r\n\r\nconst byName = (list, value) => {\r\n  if (!value) return null;\r\n  const name = typeof value === 'string' ? value : value?.name;\r\n  return list.find((o) => normalizeName(o.name) === normalizeName(name)) || null;\r\n};\r\n\r\nconst manyByName = (list, arr) => (Array.isArray(arr) ? arr.map((v) => byName(list, v)).filter(Boolean) : []);\r\n\r\nconst ensureAddress = (addr = {}, fallback = {}) => ({\r\n  address: addr.address ?? fallback.address ?? '',\r\n  phoneNumber: addr.phoneNumber ?? fallback.phoneNumber ?? '',\r\n  addressType: addr.addressType ?? fallback.addressType ?? '',\r\n  localName: addr.localName ?? fallback.localName ?? '',\r\n  unitDetails: addr.unitDetails ?? fallback.unitDetails ?? '',\r\n  recipientName: addr.recipientName ?? fallback.recipientName ?? '',\r\n});\r\n\r\nconst InteraccionesPedidos = ({\r\n  theme,\r\n  showProteinModal,\r\n  setShowProteinModal,\r\n  newProtein,\r\n  setNewProtein,\r\n  handleAddProtein,\r\n  proteins,\r\n  totalProteinUnits,\r\n  isLoading,\r\n  showMealDetails,\r\n  setShowMealDetails,\r\n  editingOrder,\r\n  setEditingOrder,\r\n  editForm,\r\n  handleMealFormFieldChange,\r\n  handleEditFormFieldChange,\r\n  handleSaveEdit,\r\n  showConfirmDeleteAll,\r\n  setShowConfirmDeleteAll,\r\n  confirmText,\r\n  setConfirmText,\r\n  handleDeleteAllOrders,\r\n  setError,\r\n  setSuccess,\r\n  showAddOrderModal,\r\n  setShowAddOrderModal,\r\n  newOrderForm,\r\n  handleNewOrderMealFormFieldChange,\r\n  handleNewOrderFieldChange,\r\n  handleAddOrderSubmit,\r\n  uniqueDeliveryPersons,\r\n}) => {\r\n  const [soups, setSoups] = useState([]);\r\n  const [soupReplacements, setSoupReplacements] = useState([]);\r\n  const [principles, setPrinciples] = useState([]);\r\n  const [menuProteins, setMenuProteins] = useState([]);\r\n  const [drinks, setDrinks] = useState([]);\r\n  const [sides, setSides] = useState([]);\r\n  const [additions, setAdditions] = useState([]);\r\n  const [paymentMethods, setPaymentMethods] = useState([]);\r\n\r\n  const [breakfastEggs, setBreakfastEggs] = useState([]);\r\n  const [breakfastBroths, setBreakfastBroths] = useState([]);\r\n  const [breakfastRiceBread, setBreakfastRiceBread] = useState([]);\r\n  const [breakfastDrinks, setBreakfastDrinks] = useState([]);\r\n  const [breakfastAdditions, setBreakfastAdditions] = useState([]);\r\n  const [breakfastTypes, setBreakfastTypes] = useState([]);\r\n  const [breakfastProteins, setBreakfastProteins] = useState([]);\r\n\r\n  // NUEVO: estado usado por el modal de protenas\r\n  const [editingProtein, setEditingProtein] = useState(null);\r\n\r\n  // ===================== Carga de catlogos =====================\r\n  useEffect(() => {\r\n    const mapSetter = {\r\n      soups: setSoups,\r\n      soupReplacements: setSoupReplacements,\r\n      principles: setPrinciples,\r\n      proteins: setMenuProteins,\r\n      drinks: setDrinks,\r\n      sides: setSides,\r\n      additions: setAdditions,\r\n      paymentMethods: setPaymentMethods,\r\n      breakfastEggs: setBreakfastEggs,\r\n      breakfastBroths: setBreakfastBroths,\r\n      breakfastRiceBread: setBreakfastRiceBread,\r\n      breakfastDrinks: setBreakfastDrinks,\r\n      breakfastAdditions: setBreakfastAdditions,\r\n      breakfastTypes: setBreakfastTypes,\r\n      breakfastProteins: setBreakfastProteins,\r\n    };\r\n\r\n    const listen = (name) =>\r\n      onSnapshot(collection(db, name), (snap) => mapSetter[name](snap.docs.map((d) => ({ id: d.id, ...d.data() }))));\r\n\r\n    const unsubs = [\r\n      listen('soups'),\r\n      listen('soupReplacements'),\r\n      listen('principles'),\r\n      listen('proteins'),\r\n      listen('drinks'),\r\n      listen('sides'),\r\n      listen('additions'),\r\n      listen('paymentMethods'),\r\n      listen('breakfastEggs'),\r\n      listen('breakfastBroths'),\r\n      listen('breakfastRiceBread'),\r\n      listen('breakfastDrinks'),\r\n      listen('breakfastAdditions'),\r\n      listen('breakfastTypes'),\r\n      listen('breakfastProteins'),\r\n    ];\r\n    return () => unsubs.forEach((u) => u && u());\r\n  }, []);\r\n\r\n  // ===================== Editar Breakfast (setter anidado) =====================\r\n  const handleBreakfastFormFieldChange = (index, field, value) => {\r\n    const list = Array.isArray(editForm.breakfasts) ? [...editForm.breakfasts] : [];\r\n    if (!list[index]) list[index] = {};\r\n    if (field.includes('.')) {\r\n      const [parent, child] = field.split('.');\r\n      list[index] = { ...list[index], [parent]: { ...(list[index][parent] || {}), [child]: value } };\r\n    } else {\r\n      list[index] = { ...list[index], [field]: value };\r\n    }\r\n    handleEditFormFieldChange('breakfasts', list);\r\n  };\r\n\r\n  // Passthrough inmediato para OptionSelector de desayuno\r\n  const handleBreakfastImmediate = (idx, field, value) => {\r\n    handleBreakfastFormFieldChange(idx, field, value);\r\n  };\r\n\r\n  // ===================== Hidratacin segura del formulario =====================\r\n  const hydratedOrderIdRef = React.useRef(null);\r\n\r\n  // Reset de bandera cuando cierras/abres otra orden\r\n  useEffect(() => {\r\n    if (!editingOrder) hydratedOrderIdRef.current = null;\r\n  }, [editingOrder]);\r\n\r\n  useEffect(() => {\r\n    if (!editingOrder) return;\r\n\r\n    const catalogsLoaded =\r\n      soups.length ||\r\n      principles.length ||\r\n      menuProteins.length ||\r\n      drinks.length ||\r\n      sides.length ||\r\n      additions.length ||\r\n      breakfastTypes.length ||\r\n      breakfastBroths.length ||\r\n      breakfastEggs.length ||\r\n      breakfastRiceBread.length ||\r\n      breakfastDrinks.length ||\r\n      breakfastAdditions.length ||\r\n      breakfastProteins.length;\r\n\r\n    if (!catalogsLoaded) return;\r\n\r\n    if (hydratedOrderIdRef.current === editingOrder.id) return; // evita rehidrataciones\r\n\r\n    const fallbackAddress = editingOrder.address || {};\r\n\r\n    // Total preferimos recalcular solo para almuerzos; para desayuno respetamos total existente\r\n    const computedTotal =\r\n      typeof editingOrder.total === 'number'\r\n        ? editingOrder.total\r\n        : editingOrder.type === 'breakfast'\r\n        ? editingOrder.total || 0\r\n        : Array.isArray(editingOrder.meals)\r\n        ? Number(calculateTotal(editingOrder.meals) || 0)\r\n        : 0;\r\n\r\n    handleEditFormFieldChange('total', computedTotal);\r\n    handleEditFormFieldChange('payment', editingOrder.payment || '');\r\n    handleEditFormFieldChange('status', editingOrder.status || 'Pendiente');\r\n    handleEditFormFieldChange('deliveryPerson', editingOrder.deliveryPerson || '');\r\n\r\n    if (editingOrder.type === 'breakfast') {\r\n      const breakfasts = (editingOrder.breakfasts || []).map((b) => ({\r\n        type: byName(breakfastTypes, b.type),\r\n        broth: byName(breakfastBroths, b.broth),\r\n        eggs: byName(breakfastEggs, b.eggs),\r\n        riceBread: byName(breakfastRiceBread, b.riceBread),\r\n        drink: byName(breakfastDrinks, b.drink),\r\n        protein: byName(breakfastProteins, b.protein),\r\n        additions: Array.isArray(b.additions)\r\n          ? b.additions\r\n              .map((a) => {\r\n                const full = byName(breakfastAdditions, a);\r\n                return full ? { ...full, quantity: a.quantity || 1 } : null;\r\n              })\r\n              .filter(Boolean)\r\n          : [],\r\n        cutlery: !!b.cutlery,\r\n        time: typeof b.time === 'string' ? b.time : b.time?.name || '',\r\n        address: ensureAddress(b.address, fallbackAddress),\r\n        notes: b.notes || '',\r\n      }));\r\n      handleEditFormFieldChange('breakfasts', breakfasts);\r\n    } else {\r\n      const meals = (editingOrder.meals || []).map((m) => ({\r\n        soup: byName(soups, m.soup),\r\n        soupReplacement:\r\n          typeof m.soupReplacement === 'string' ? m.soupReplacement : m.soupReplacement?.replacement || '',\r\n        principle: Array.isArray(m.principle) ? m.principle.map((p) => byName(principles, p)).filter(Boolean) : [],\r\n        principleReplacement:\r\n          typeof m.principleReplacement === 'string'\r\n            ? m.principleReplacement\r\n            : m.principleReplacement?.replacement || '',\r\n        protein: byName(menuProteins, m.protein),\r\n        drink: byName(drinks, m.drink),\r\n        sides: manyByName(sides, m.sides),\r\n        additions: Array.isArray(m.additions)\r\n          ? m.additions\r\n              .map((a) => {\r\n                const full = byName(additions, a);\r\n                return full ? { ...full, quantity: a.quantity || 1, price: a.price ?? full.price ?? 0 } : null;\r\n              })\r\n              .filter(Boolean)\r\n          : [],\r\n        cutlery: !!m.cutlery,\r\n        time: typeof m.time === 'string' ? m.time : m.time?.name || '',\r\n        address: ensureAddress(m.address, fallbackAddress),\r\n        notes: m.notes || '',\r\n      }));\r\n      handleEditFormFieldChange('meals', meals);\r\n    }\r\n\r\n    hydratedOrderIdRef.current = editingOrder.id;\r\n  }, [\r\n    editingOrder,\r\n    soups,\r\n    principles,\r\n    menuProteins,\r\n    drinks,\r\n    sides,\r\n    additions,\r\n    breakfastTypes,\r\n    breakfastBroths,\r\n    breakfastEggs,\r\n    breakfastRiceBread,\r\n    breakfastDrinks,\r\n    breakfastAdditions,\r\n    breakfastProteins,\r\n    handleEditFormFieldChange,\r\n  ]);\r\n\r\n  // Recalcular total en edicin cuando cambian meals (solo almuerzo)\r\n  useEffect(() => {\r\n    if (!editingOrder || editingOrder.type === 'breakfast') return;\r\n    const computed = Number(calculateTotal(editForm.meals || [])) || 0;\r\n    if (computed !== (editForm.total || 0)) {\r\n      handleEditFormFieldChange('total', computed);\r\n    }\r\n  }, [editingOrder, editForm.meals, handleEditFormFieldChange, calculateTotal]);\r\n\r\n  // Soporta lunch (meals) y breakfast (breakfasts)\r\n  const mealsForDetails = Array.isArray(showMealDetails?.meals)\r\n    ? showMealDetails.meals\r\n    : Array.isArray(showMealDetails?.breakfasts)\r\n    ? showMealDetails.breakfasts\r\n    : [];\r\n\r\n    // Recalcular total en edicin cuando cambian breakfasts (solo desayunos)\r\nuseEffect(() => {\r\n  if (!editingOrder || editingOrder.type !== 'breakfast') return;\r\n  const list = editForm.breakfasts || [];\r\n  const computed = list.reduce(\r\n    (sum, b) => sum + Number(calculateBreakfastPrice(b, 3, breakfastTypes) || 0),\r\n    0\r\n  );\r\n  if (computed !== (editForm.total || 0)) {\r\n    handleEditFormFieldChange('total', computed);\r\n  }\r\n}, [editingOrder, editForm.breakfasts, breakfastTypes, handleEditFormFieldChange]);\r\n\r\n\r\n  const handleDeleteProtein = async (proteinId) => {\r\n    try {\r\n      await deleteDoc(doc(db, 'dailyProteins', proteinId));\r\n      setSuccess('Protena eliminada correctamente.');\r\n    } catch (error) {\r\n      setError(`Error al eliminar protena: ${error.message}`);\r\n    }\r\n  };\r\n\r\n  const handleEditProtein = (protein) => {\r\n    setEditingProtein(protein);\r\n  };\r\n\r\n  const handleUpdateProtein = async () => {\r\n    if (!editingProtein.name || !editingProtein.quantity || isNaN(editingProtein.quantity) || Number(editingProtein.quantity) <= 0) {\r\n      setError('Por favor, ingrese un nombre de protena vlido y una cantidad mayor a 0.');\r\n      return;\r\n    }\r\n    try {\r\n      await updateDoc(doc(db, 'dailyProteins', editingProtein.id), {\r\n        name: editingProtein.name.trim(),\r\n        quantity: Number(editingProtein.quantity),\r\n      });\r\n      setSuccess('Protena actualizada correctamente.');\r\n      setEditingProtein(null);\r\n    } catch (error) {\r\n      setError(`Error al actualizar protena: ${error.message}`);\r\n    }\r\n  };\r\n\r\n  const handleCancelEditProtein = () => {\r\n    setEditingProtein(null);\r\n  };\r\n\r\n  return (\r\n    <div>\r\n      {/* Dilogo para gestionar protenas */}\r\n      <Transition show={showProteinModal} as={React.Fragment}>\r\n        <Dialog as=\"div\" className=\"relative z-50\" onClose={() => { setShowProteinModal(false); setEditingProtein(null); }}>\r\n          <Transition.Child as={React.Fragment} enter=\"ease-out duration-300\" enterFrom=\"opacity-0\" enterTo=\"opacity-100\" leave=\"ease-in duration-200\" leaveFrom=\"opacity-100\" leaveTo=\"opacity-0\">\r\n            <div className=\"fixed inset-0 bg-black bg-opacity-50\" />\r\n          </Transition.Child>\r\n          <div className=\"fixed inset-0 flex items-center justify-center p-4\">\r\n            <Transition.Child as={React.Fragment} enter=\"ease-out duration-300\" enterFrom=\"opacity-0 scale-95\" enterTo=\"opacity-100 scale-100\" leave=\"ease-in duration-200\" leaveFrom=\"opacity-100 scale-100\" leaveTo=\"opacity-0 scale-95\">\r\n              <Dialog.Panel\r\n                className={\r\n                  classNames(\r\n                    'w-full max-w-md p-6 rounded-lg shadow-md',\r\n                    theme === 'dark' ? 'bg-gray-800 text-gray-200' : 'bg-gray-50 text-gray-900'\r\n                  )\r\n                }\r\n              >\r\n                <div className=\"flex justify-between items-center mb-4\">\r\n                  <Dialog.Title className=\"text-lg font-medium\">{editingProtein ? 'Editar Protena' : 'Gestionar Protenas'}</Dialog.Title>\r\n                  <button onClick={() => { setShowProteinModal(false); setEditingProtein(null); }} className=\"text-gray-500 hover:text-gray-400\" aria-label=\"Cerrar modal\">\r\n                    <XMarkIcon className=\"w-5 h-5\" />\r\n                  </button>\r\n                </div>\r\n                <div className=\"space-y-4\">\r\n                  {editingProtein ? (\r\n                    <>\r\n                      <div>\r\n                        <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">Nombre</label>\r\n                        <input\r\n                          type=\"text\"\r\n                          value={editingProtein.name}\r\n                          onChange={(e) => setEditingProtein({ ...editingProtein, name: e.target.value })}\r\n                          className={classNames(\r\n                            'w-full p-2 rounded-md border text-sm',\r\n                            theme === 'dark' ? 'border-gray-600 bg-gray-700 text-white' : 'border-gray-200 bg-white text-gray-900',\r\n                            'focus:outline-none focus:ring-1 focus:ring-blue-500'\r\n                          )}\r\n                          placeholder=\"Ej: Pollo\"\r\n                        />\r\n                      </div>\r\n                      <div>\r\n                        <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">Cantidad</label>\r\n                        <input\r\n                          type=\"number\"\r\n                          value={editingProtein.quantity}\r\n                          onChange={(e) => setEditingProtein({ ...editingProtein, quantity: e.target.value })}\r\n                          className={classNames(\r\n                            'w-full p-2 rounded-md border text-sm',\r\n                            theme === 'dark' ? 'border-gray-600 bg-gray-700 text-white' : 'border-gray-200 bg-white text-gray-900',\r\n                            'focus:outline-none focus:ring-1 focus:ring-blue-500'\r\n                          )}\r\n                          placeholder=\"Ej: 50\"\r\n                          min=\"0\"\r\n                        />\r\n                      </div>\r\n                      <div className=\"flex justify-end gap-2\">\r\n                        <button onClick={handleCancelEditProtein} className={classNames('px-4 py-2 rounded-md text-sm font-medium', theme === 'dark' ? 'bg-gray-600 hover:bg-gray-700 text-gray-200' : 'bg-gray-200 hover:bg-gray-300 text-gray-900')}>Cancelar</button>\r\n                        <button onClick={handleUpdateProtein} disabled={isLoading} className={classNames('px-4 py-2 rounded-md text-sm font-medium', isLoading ? 'bg-gray-400 cursor-not-allowed' : theme === 'dark' ? 'bg-blue-600 hover:bg-blue-700 text-white' : 'bg-blue-500 hover:bg-blue-600 text-white')}>\r\n                          {isLoading ? 'Guardando...' : 'Actualizar'}\r\n                        </button>\r\n                      </div>\r\n                    </>\r\n                  ) : (\r\n                    <>\r\n                      <div>\r\n                        <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">Nombre</label>\r\n                        <input\r\n                          type=\"text\"\r\n                          value={newProtein.name}\r\n                          onChange={(e) => setNewProtein({ ...newProtein, name: e.target.value })}\r\n                          className={classNames(\r\n                            'w-full p-2 rounded-md border text-sm',\r\n                            theme === 'dark' ? 'border-gray-600 bg-gray-700 text-white' : 'border-gray-200 bg-white text-gray-900',\r\n                            'focus:outline-none focus:ring-1 focus:ring-blue-500'\r\n                          )}\r\n                          placeholder=\"Ej: Pollo\"\r\n                        />\r\n                      </div>\r\n                      <div>\r\n                        <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">Cantidad</label>\r\n                        <input\r\n                          type=\"number\"\r\n                          value={newProtein.quantity}\r\n                          onChange={(e) => setNewProtein({ ...newProtein, quantity: e.target.value })}\r\n                          className={classNames(\r\n                            'w-full p-2 rounded-md border text-sm',\r\n                            theme === 'dark' ? 'border-gray-600 bg-gray-700 text-white' : 'border-gray-200 bg-white text-gray-900',\r\n                            'focus:outline-none focus:ring-1 focus:ring-blue-500'\r\n                          )}\r\n                          placeholder=\"Ej: 50\"\r\n                          min=\"0\"\r\n                        />\r\n                      </div>\r\n                      <div className=\"flex justify-end gap-2\">\r\n                        <button onClick={() => setShowProteinModal(false)} className={classNames('px-4 py-2 rounded-md text-sm font-medium', theme === 'dark' ? 'bg-gray-600 hover:bg-gray-700 text-gray-200' : 'bg-gray-200 hover:bg-gray-300 text-gray-900')}>Cancelar</button>\r\n                        <button onClick={handleAddProtein} disabled={isLoading} className={classNames('px-4 py-2 rounded-md text-sm font-medium', isLoading ? 'bg-gray-400 cursor-not-allowed' : theme === 'dark' ? 'bg-blue-600 hover:bg-blue-700 text-white' : 'bg-blue-500 hover:bg-blue-600 text-white')}>\r\n                          {isLoading ? 'Guardando...' : 'Agregar'}\r\n                        </button>\r\n                      </div>\r\n                    </>\r\n                  )}\r\n                </div>\r\n                <div className=\"mt-6\">\r\n                  <h3 className=\"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\r\n                    Protenas Registradas (Total: {totalProteinUnits} unidades)\r\n                  </h3>\r\n                  {proteins.length === 0 ? (\r\n                    <p className=\"text-sm text-gray-500 dark:text-gray-400\">No hay protenas registradas.</p>\r\n                  ) : (\r\n                    <ul className=\"space-y-2\">\r\n                      {proteins.map((protein) => (\r\n                        <li key={protein.id} className={classNames('flex justify-between items-center p-2 rounded-md', theme === 'dark' ? 'bg-gray-700' : 'bg-gray-100')}>\r\n                          <span className=\"text-sm\">\r\n                            {protein.name}: {protein.quantity} unidades\r\n                          </span>\r\n                          <div className=\"flex gap-2\">\r\n                            <button onClick={() => handleEditProtein(protein)} className=\"text-blue-500 hover:text-blue-400 transition-colors duration-150 p-1 rounded-md\" title=\"Editar protena\" aria-label={`Editar ${protein.name}`}>\r\n                              <PencilIcon className=\"w-4 h-4\" />\r\n                            </button>\r\n                            <button onClick={() => handleDeleteProtein(protein.id)} className=\"text-red-500 hover:text-red-400 transition-colors duration-150 p-1 rounded-md\" title=\"Eliminar protena\" aria-label={`Eliminar ${protein.name}`}>\r\n                              <TrashIcon className=\"w-4 h-4\" />\r\n                            </button>\r\n                          </div>\r\n                        </li>\r\n                      ))}\r\n                    </ul>\r\n                  )}\r\n                </div>\r\n              </Dialog.Panel>\r\n            </Transition.Child>\r\n          </div>\r\n        </Dialog>\r\n      </Transition>\r\n\r\n      {/* Dilogo para detalles del pedido */}\r\n      <Transition show={showMealDetails !== null} as={React.Fragment}>\r\n        <Dialog as=\"div\" className=\"relative z-50\" onClose={() => setShowMealDetails(null)}>\r\n          <Transition.Child as={React.Fragment} enter=\"ease-out duration-300\" enterFrom=\"opacity-0\" enterTo=\"opacity-100\" leave=\"ease-in duration-200\" leaveFrom=\"opacity-100\" leaveTo=\"opacity-0\">\r\n            <div className=\"fixed inset-0 bg-black bg-opacity-50\" />\r\n          </Transition.Child>\r\n          <div className=\"fixed inset-0 flex items-center justify-center p-4\">\r\n            <Transition.Child as={React.Fragment} enter=\"ease-out duration-300\" enterFrom=\"opacity-0 scale-95\" enterTo=\"opacity-100 scale-100\" leave=\"ease-in duration-200\" leaveFrom=\"opacity-100 scale-100\" leaveTo=\"opacity-0 scale-95\">\r\n              <Dialog.Panel className={classNames('w-full max-w-2xl p-6 rounded-lg shadow-xl max-h-[80vh] overflow-y-auto', theme === 'dark' ? 'bg-gray-800 text-gray-200' : 'bg-gray-50 text-gray-900')}>\r\n                <Dialog.Title className=\"text-lg font-medium mb-4 flex justify-between items-center\">\r\n                  Detalles del Pedido\r\n                  <button onClick={() => setShowMealDetails(null)} className=\"text-gray-500 hover:text-gray-400\" aria-label=\"Cerrar detalles\">\r\n                    <XMarkIcon className=\"w-5 h-5\" />\r\n                  </button>\r\n                </Dialog.Title>\r\n                {showMealDetails && (\r\n                  <>\r\n                    {showMealDetails?.type === 'breakfast' ? (\r\n                      <BreakfastOrderSummary items={showMealDetails.breakfasts || mealsForDetails} user={{ role: 3 }} statusClass=\"bg-white\" showSaveButton={false} />\r\n                    ) : (\r\n                      <OrderSummary meals={mealsForDetails} isTableOrder={false} isWaiterView={true} statusClass=\"bg-white\" />\r\n                    )}\r\n                    <div className=\"mt-3 text-xs sm:text-sm\">\r\n                      <p className=\"font-medium\">Estado: {showMealDetails.status || 'Pendiente'}</p>\r\n                      <p className=\"font-medium\">Domiciliario: {showMealDetails.deliveryPerson || 'Sin asignar'}</p>\r\n                 {showMealDetails?.type === 'breakfast' ? (\r\n  <p className=\"font-medium\">\r\n    Total del pedido: ${\r\n      ((showMealDetails.breakfasts || []).reduce(\r\n        (sum, b) => sum + Number(calculateBreakfastPrice(b, 3, breakfastTypes) || 0),\r\n        0\r\n      )).toLocaleString('es-CO')\r\n    }\r\n  </p>\r\n) : (\r\n  typeof showMealDetails.total === 'number' && (\r\n <p className=\"font-medium\">\r\n  Total del pedido: ${\r\n    (\r\n      Array.isArray(showMealDetails?.meals)\r\n        ? Number(calculateTotal(showMealDetails.meals) || 0)\r\n        : Number(showMealDetails?.total || 0)\r\n    ).toLocaleString('es-CO')\r\n  }\r\n</p>\r\n\r\n  )\r\n)}\r\n\r\n                    </div>\r\n                  </>\r\n                )}\r\n              </Dialog.Panel>\r\n            </Transition.Child>\r\n          </div>\r\n        </Dialog>\r\n      </Transition>\r\n\r\n      {/* Dilogo para editar pedido */}\r\n      <Transition show={editingOrder !== null} as={React.Fragment}>\r\n        <Dialog as=\"div\" className=\"relative z-50\" onClose={() => setEditingOrder(null)}>\r\n          <Transition.Child as={React.Fragment} enter=\"ease-out duration-300\" enterFrom=\"opacity-0\" enterTo=\"opacity-100\" leave=\"ease-in duration-200\" leaveFrom=\"opacity-100\" leaveTo=\"opacity-0\">\r\n            <div className=\"fixed inset-0 bg-black bg-opacity-50\" />\r\n          </Transition.Child>\r\n          <div className=\"fixed inset-0 flex items-center justify-center p-4\">\r\n            <Transition.Child as={React.Fragment} enter=\"ease-out duration-300\" enterFrom=\"opacity-0 scale-95\" enterTo=\"opacity-100 scale-100\" leave=\"ease-in duration-200\" leaveFrom=\"opacity-100 scale-100\" leaveTo=\"opacity-0 scale-95\">\r\n              <Dialog.Panel className={classNames('w-full max-w-2xl p-6 rounded-lg shadow-xl max-h-[80vh] overflow-y-auto', theme === 'dark' ? 'bg-gray-800 text-gray-200' : 'bg-gray-50 text-gray-900')}>\r\n                <Dialog.Title className=\"text-lg font-medium mb-4 flex justify-between items-center\">\r\n                  Editar Pedido\r\n                  <button onClick={() => setEditingOrder(null)} className=\"text-gray-500 hover:text-gray-400\" aria-label=\"Cerrar edicin\">\r\n                    <XMarkIcon className=\"w-5 h-5\" />\r\n                  </button>\r\n                </Dialog.Title>\r\n                {(() => {\r\n                  const editItems = editingOrder?.type === 'breakfast' ? editForm.breakfasts || [] : editForm.meals || [];\r\n\r\n                  return editItems.map((row, idx) => (\r\n                    <div key={idx} className=\"mb-6 p-4 border rounded-md border-gray-200 dark:border-gray-600\">\r\n                      <h3 className=\"font-medium mb-2\">{editingOrder?.type === 'breakfast' ? `Desayuno ${idx + 1}` : `Bandeja ${idx + 1}`}</h3>\r\n\r\n                      {editingOrder?.type === 'breakfast' ? (\r\n                        <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-4\">\r\n                          <div>\r\n                            <label className=\"block text-sm font-medium mb-1\">Tipo</label>\r\n                            <OptionSelector title=\"Tipo\" emoji=\"\" options={breakfastTypes} selected={row.type || null} multiple={false} onImmediateSelect={(v) => handleBreakfastImmediate(idx, 'type', v)} />\r\n                          </div>\r\n                          <div>\r\n                            <label className=\"block text-sm font-medium mb-1\">Caldo</label>\r\n                            <OptionSelector title=\"Caldo\" emoji=\"\" options={breakfastBroths} selected={row.broth || null} multiple={false} onImmediateSelect={(v) => handleBreakfastImmediate(idx, 'broth', v)} />\r\n                          </div>\r\n                          <div>\r\n                            <label className=\"block text-sm font-medium mb-1\">Huevos</label>\r\n                            <OptionSelector title=\"Huevos\" emoji=\"\" options={breakfastEggs} selected={row.eggs || null} multiple={false} onImmediateSelect={(v) => handleBreakfastImmediate(idx, 'eggs', v)} />\r\n                          </div>\r\n                          <div>\r\n                            <label className=\"block text-sm font-medium mb-1\">Arroz/Pan</label>\r\n                            <OptionSelector title=\"Arroz/Pan\" emoji=\"\" options={breakfastRiceBread} selected={row.riceBread || null} multiple={false} onImmediateSelect={(v) => handleBreakfastImmediate(idx, 'riceBread', v)} />\r\n                          </div>\r\n                          <div>\r\n                            <label className=\"block text-sm font-medium mb-1\">Bebida</label>\r\n                            <OptionSelector title=\"Bebida\" emoji=\"\" options={breakfastDrinks} selected={row.drink || null} multiple={false} onImmediateSelect={(v) => handleBreakfastImmediate(idx, 'drink', v)} />\r\n                          </div>\r\n                          <div>\r\n                            <label className=\"block text-sm font-medium mb-1\">Protena</label>\r\n                            <OptionSelector title=\"Protena\" emoji=\"\" options={breakfastProteins} selected={row.protein || null} multiple={false} onImmediateSelect={(v) => handleBreakfastImmediate(idx, 'protein', v)} />\r\n                          </div>\r\n                          <div className=\"sm:col-span-2\">\r\n                            <label className=\"block text-sm font-medium mb-1\">Adiciones</label>\r\n                            <OptionSelector\r\n                              title=\"Adiciones\"\r\n                              emoji=\"\"\r\n                              options={breakfastAdditions}\r\n                              selected={row.additions || []}\r\n                              multiple={true}\r\n                              onImmediateSelect={(sel) => handleBreakfastImmediate(idx, 'additions', sel.map((a) => ({ name: a.name, quantity: a.quantity || 1 })))}\r\n                            />\r\n                          </div>\r\n\r\n                          {/* Operativos desayuno */}\r\n                          <div>\r\n                            <label className=\"block text-sm font-medium mb-1\">Cubiertos</label>\r\n                            <input type=\"checkbox\" checked={!!row.cutlery} onChange={(e) => handleBreakfastFormFieldChange(idx, 'cutlery', e.target.checked)} className=\"h-4 w-4\" />\r\n                          </div>\r\n                          <div>\r\n                            <label className=\"block text-sm font-medium mb-1\">Hora de Entrega</label>\r\n                            <input\r\n                              type=\"text\"\r\n                              value={typeof row.time === 'string' ? row.time : row.time?.name || ''}\r\n                              onChange={(e) => handleBreakfastFormFieldChange(idx, 'time', e.target.value)}\r\n                              className={classNames('w-full p-2 rounded-md border text-sm', theme === 'dark' ? 'border-gray-600 bg-gray-700 text-white' : 'border-gray-200 bg-white text-gray-900', 'focus:outline-none focus:ring-1 focus:ring-blue-500')}\r\n                            />\r\n                          </div>\r\n                          <div className=\"sm:col-span-2\">\r\n                            <label className=\"block text-sm font-medium mb-1\">Direccin</label>\r\n                            <input\r\n                              type=\"text\"\r\n                              value={row.address?.address || ''}\r\n                              onChange={(e) => handleBreakfastFormFieldChange(idx, 'address.address', e.target.value)}\r\n                              className={classNames('w-full p-2 rounded-md border text-sm', theme === 'dark' ? 'border-gray-600 bg-gray-700 text-white' : 'border-gray-200 bg-white text-gray-900', 'focus:outline-none focus:ring-1 focus:ring-blue-500')}\r\n                            />\r\n                          </div>\r\n                          <div>\r\n                            <label className=\"block text-sm font-medium mb-1\">Telfono</label>\r\n                            <input\r\n                              type=\"text\"\r\n                              value={row.address?.phoneNumber || ''}\r\n                              onChange={(e) => handleBreakfastFormFieldChange(idx, 'address.phoneNumber', e.target.value)}\r\n                              className={classNames('w-full p-2 rounded-md border text-sm', theme === 'dark' ? 'border-gray-600 bg-gray-700 text-white' : 'border-gray-200 bg-white text-gray-900', 'focus:outline-none focus:ring-1 focus:ring-blue-500')}\r\n                            />\r\n                          </div>\r\n                          <div>\r\n                            <label className=\"block text-sm font-medium mb-1\">Tipo de Direccin</label>\r\n                            <select\r\n                              value={row.address?.addressType || ''}\r\n                              onChange={(e) => handleBreakfastFormFieldChange(idx, 'address.addressType', e.target.value)}\r\n                              className={classNames('w-full p-2 rounded-md border text-sm', theme === 'dark' ? 'border-gray-600 bg-gray-700 text-white' : 'border-gray-200 bg-white text-gray-900', 'focus:outline-none focus:ring-1 focus:ring-blue-500')}\r\n                            >\r\n                              <option value=\"\">Seleccione</option>\r\n                              <option value=\"house\">Casa/Apto</option>\r\n                              <option value=\"school\">Colegio/Oficina</option>\r\n                              <option value=\"complex\">Conjunto</option>\r\n                              <option value=\"shop\">Tienda/Local</option>\r\n                            </select>\r\n                          </div>\r\n                          {row.address?.addressType === 'shop' && (\r\n                            <div>\r\n                              <label className=\"block text-sm font-medium mb-1\">Nombre del Local</label>\r\n                              <input\r\n                                type=\"text\"\r\n                                value={row.address?.localName || ''}\r\n                                onChange={(e) => handleBreakfastFormFieldChange(idx, 'address.localName', e.target.value)}\r\n                                className={classNames('w-full p-2 rounded-md border text-sm', theme === 'dark' ? 'border-gray-600 bg-gray-700 text-white' : 'border-gray-200 bg-white text-gray-900', 'focus:outline-none focus:ring-1 focus:ring-blue-500')}\r\n                              />\r\n                            </div>\r\n                          )}\r\n                          {row.address?.addressType === 'school' && (\r\n                            <div>\r\n                              <label className=\"block text-sm font-medium mb-1\">Nombre del destinatario</label>\r\n                              <input\r\n                                type=\"text\"\r\n                                value={row.address?.recipientName || ''}\r\n                                onChange={(e) => handleBreakfastFormFieldChange(idx, 'address.recipientName', e.target.value)}\r\n                                className={classNames('w-full p-2 rounded-md border text-sm', theme === 'dark' ? 'border-gray-600 bg-gray-700 text-white' : 'border-gray-200 bg-white text-gray-900', 'focus:outline-none focus:ring-1 focus:ring-blue-500')}\r\n                              />\r\n                            </div>\r\n                          )}\r\n                          {row.address?.addressType === 'complex' && (\r\n                            <div>\r\n                              <label className=\"block text-sm font-medium mb-1\">Detalles (Torre/Apto)</label>\r\n                              <input\r\n                                type=\"text\"\r\n                                value={row.address?.unitDetails || ''}\r\n                                onChange={(e) => handleBreakfastFormFieldChange(idx, 'address.unitDetails', e.target.value)}\r\n                                className={classNames('w-full p-2 rounded-md border text-sm', theme === 'dark' ? 'border-gray-600 bg-gray-700 text-white' : 'border-gray-200 bg-white text-gray-900', 'focus:outline-none focus:ring-1 focus:ring-blue-500')}\r\n                              />\r\n                            </div>\r\n                          )}\r\n                          <div className=\"sm:col-span-2\">\r\n                            <label className=\"block text-sm font-medium mb-1\">Notas</label>\r\n                            <input\r\n                              type=\"text\"\r\n                              value={row.notes || ''}\r\n                              onChange={(e) => handleBreakfastFormFieldChange(idx, 'notes', e.target.value)}\r\n                              className={classNames('w-full p-2 rounded-md border text-sm', theme === 'dark' ? 'border-gray-600 bg-gray-700 text-white' : 'border-gray-200 bg-white text-gray-900', 'focus:outline-none focus:ring-1 focus:ring-blue-500')}\r\n                            />\r\n                          </div>\r\n                        </div>\r\n                      ) : (\r\n                        <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-4\">\r\n                          <div>\r\n                            <label className=\"block text-sm font-medium mb-1\">Sopa o reemplazo</label>\r\n                            <OptionSelector title=\"Sopa\" emoji=\"\" options={soups} selected={row.soup || null} multiple={false} onImmediateSelect={(v) => handleMealFormFieldChange(idx, 'soup', v)} />\r\n                          </div>\r\n                          <div>\r\n                            <label className=\"block text-sm font-medium mb-1\">Principio</label>\r\n                            <OptionSelector\r\n                              title=\"Principio\"\r\n                              emoji=\"\"\r\n                              options={principles}\r\n                              selected={row.principle || []}\r\n                              multiple={true}\r\n                              showConfirmButton={true}\r\n                              onImmediateSelect={(selection) => handleMealFormFieldChange(idx, 'principle', selection)}\r\n                              onConfirm={({ selection }) => handleMealFormFieldChange(idx, 'principle', selection)}\r\n                            />\r\n                          </div>\r\n                          <div>\r\n                            <label className=\"block text-sm font-medium mb-1\">Protena</label>\r\n                            <OptionSelector title=\"Protena\" emoji=\"\" options={menuProteins} selected={row.protein || null} multiple={false} onImmediateSelect={(v) => handleMealFormFieldChange(idx, 'protein', v)} />\r\n                          </div>\r\n                          <div>\r\n                            <label className=\"block text-sm font-medium mb-1\">Bebida</label>\r\n                            <OptionSelector title=\"Bebida\" emoji=\"\" options={drinks} selected={row.drink || null} multiple={false} onImmediateSelect={(v) => handleMealFormFieldChange(idx, 'drink', v)} />\r\n                          </div>\r\n                          <div className=\"sm:col-span-2\">\r\n                            <label className=\"block text-sm font-medium mb-1\">Acompaamientos</label>\r\n                            <OptionSelector title=\"Acompaamientos\" emoji=\"\" options={sides} selected={row.sides || []} multiple={true} onImmediateSelect={(selection) => handleMealFormFieldChange(idx, 'sides', selection)} />\r\n                          </div>\r\n                          <div className=\"sm:col-span-2\">\r\n                            <label className=\"block text-sm font-medium mb-1\">Adiciones</label>\r\n                            <OptionSelector\r\n                              title=\"Adiciones\"\r\n                              emoji=\"\"\r\n                              options={additions}\r\n                              selected={row.additions || []}\r\n                              multiple={true}\r\n                              onImmediateSelect={(sel) =>\r\n                                handleMealFormFieldChange(\r\n                                  idx,\r\n                                  'additions',\r\n                                  sel.map((a) => ({\r\n                                    id: a.id,\r\n                                    name: a.name,\r\n                                    price: a.price || 0,\r\n                                    protein: a.protein || '',\r\n                                    replacement: a.replacement || '',\r\n                                    quantity: a.quantity || 1,\r\n                                  }))\r\n                                )\r\n                              }\r\n                            />\r\n                          </div>\r\n\r\n                          {/* Operativos almuerzo */}\r\n                          <div>\r\n                            <label className=\"block text-sm font-medium mb-1\">Cubiertos</label>\r\n                            <input type=\"checkbox\" checked={!!row.cutlery} onChange={(e) => handleMealFormFieldChange(idx, 'cutlery', e.target.checked)} className=\"h-4 w-4\" />\r\n                          </div>\r\n                          <div>\r\n                            <label className=\"block text-sm font-medium mb-1\">Hora de Entrega</label>\r\n                            <input\r\n                              type=\"text\"\r\n                              value={typeof row.time === 'string' ? row.time : row.time?.name || ''}\r\n                              onChange={(e) => handleMealFormFieldChange(idx, 'time', e.target.value)}\r\n                              className={classNames('w-full p-2 rounded-md border text-sm', theme === 'dark' ? 'border-gray-600 bg-gray-700 text-white' : 'border-gray-200 bg-white text-gray-900', 'focus:outline-none focus:ring-1 focus:ring-blue-500')}\r\n                            />\r\n                          </div>\r\n                          <div className=\"sm:col-span-2\">\r\n                            <label className=\"block text-sm font-medium mb-1\">Direccin</label>\r\n                            <input\r\n                              type=\"text\"\r\n                              value={row.address?.address || ''}\r\n                              onChange={(e) => handleMealFormFieldChange(idx, 'address.address', e.target.value)}\r\n                              className={classNames('w-full p-2 rounded-md border text-sm', theme === 'dark' ? 'border-gray-600 bg-gray-700 text-white' : 'border-gray-200 bg-white text-gray-900', 'focus:outline-none focus:ring-1 focus:ring-blue-500')}\r\n                            />\r\n                          </div>\r\n                          <div>\r\n                            <label className=\"block text-sm font-medium mb-1\">Telfono</label>\r\n                            <input\r\n                              type=\"text\"\r\n                              value={row.address?.phoneNumber || ''}\r\n                              onChange={(e) => handleMealFormFieldChange(idx, 'address.phoneNumber', e.target.value)}\r\n                              className={classNames('w-full p-2 rounded-md border text-sm', theme === 'dark' ? 'border-gray-600 bg-gray-700 text-white' : 'border-gray-200 bg-white text-gray-900', 'focus:outline-none focus:ring-1 focus:ring-blue-500')}\r\n                            />\r\n                          </div>\r\n                          <div>\r\n                            <label className=\"block text-sm font-medium mb-1\">Tipo de Direccin</label>\r\n                            <select\r\n                              value={row.address?.addressType || ''}\r\n                              onChange={(e) => handleMealFormFieldChange(idx, 'address.addressType', e.target.value)}\r\n                              className={classNames('w-full p-2 rounded-md border text-sm', theme === 'dark' ? 'border-gray-600 bg-gray-700 text-white' : 'border-gray-200 bg-white text-gray-900', 'focus:outline-none focus:ring-1 focus:ring-blue-500')}\r\n                            >\r\n                              <option value=\"\">Seleccione</option>\r\n                              <option value=\"house\">Casa/Apto</option>\r\n                              <option value=\"school\">Colegio/Oficina</option>\r\n                              <option value=\"complex\">Conjunto</option>\r\n                              <option value=\"shop\">Tienda/Local</option>\r\n                            </select>\r\n                          </div>\r\n                          {row.address?.addressType === 'shop' && (\r\n                            <div>\r\n                              <label className=\"block text-sm font-medium mb-1\">Nombre del Local</label>\r\n                              <input\r\n                                type=\"text\"\r\n                                value={row.address?.localName || ''}\r\n                                onChange={(e) => handleMealFormFieldChange(idx, 'address.localName', e.target.value)}\r\n                                className={classNames('w-full p-2 rounded-md border text-sm', theme === 'dark' ? 'border-gray-600 bg-gray-700 text-white' : 'border-gray-200 bg-white text-gray-900', 'focus:outline-none focus:ring-1 focus:ring-blue-500')}\r\n                              />\r\n                            </div>\r\n                          )}\r\n                          {row.address?.addressType === 'school' && (\r\n                            <div>\r\n                              <label className=\"block text-sm font-medium mb-1\">Nombre del destinatario</label>\r\n                              <input\r\n                                type=\"text\"\r\n                                value={row.address?.recipientName || ''}\r\n                                onChange={(e) => handleMealFormFieldChange(idx, 'address.recipientName', e.target.value)}\r\n                                className={classNames('w-full p-2 rounded-md border text-sm', theme === 'dark' ? 'border-gray-600 bg-gray-700 text-white' : 'border-gray-200 bg-white text-gray-900', 'focus:outline-none focus:ring-1 focus:ring-blue-500')}\r\n                              />\r\n                            </div>\r\n                          )}\r\n                          {row.address?.addressType === 'complex' && (\r\n                            <div>\r\n                              <label className=\"block text-sm font-medium mb-1\">Detalles (Torre/Apto)</label>\r\n                              <input\r\n                                type=\"text\"\r\n                                value={row.address?.unitDetails || ''}\r\n                                onChange={(e) => handleMealFormFieldChange(idx, 'address.unitDetails', e.target.value)}\r\n                                className={classNames('w-full p-2 rounded-md border text-sm', theme === 'dark' ? 'border-gray-600 bg-gray-700 text-white' : 'border-gray-200 bg-white text-gray-900', 'focus:outline-none focus:ring-1 focus:ring-blue-500')}\r\n                              />\r\n                            </div>\r\n                          )}\r\n                          <div className=\"sm:col-span-2\">\r\n                            <label className=\"block text-sm font-medium mb-1\">Notas</label>\r\n                            <input\r\n                              type=\"text\"\r\n                              value={row.notes || ''}\r\n                              onChange={(e) => handleMealFormFieldChange(idx, 'notes', e.target.value)}\r\n                              className={classNames('w-full p-2 rounded-md border text-sm', theme === 'dark' ? 'border-gray-600 bg-gray-700 text-white' : 'border-gray-200 bg-white text-gray-900', 'focus:outline-none focus:ring-1 focus:ring-blue-500')}\r\n                            />\r\n                          </div>\r\n                        </div>\r\n                      )}\r\n                    </div>\r\n                  ));\r\n                })()}\r\n\r\n                {/* Campos de la orden principal */}\r\n                <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-4 mt-6\">\r\n                  <div>\r\n                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">Total</label>\r\n                    <input\r\n                      type=\"number\"\r\n                      value={editForm.total || 0}\r\n                      onChange={(e) => handleEditFormFieldChange('total', Number(e.target.value))}\r\n                      className={classNames('w-full p-2 rounded-md border text-sm', theme === 'dark' ? 'border-gray-600 bg-gray-700 text-white' : 'border-gray-200 bg-white text-gray-900', 'focus:outline-none focus:ring-1 focus:ring-blue-500')}\r\n                    />\r\n                  </div>\r\n                  <div>\r\n                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">Estado</label>\r\n                    <select\r\n                      value={editForm.status || 'Pendiente'}\r\n                      onChange={(e) => handleEditFormFieldChange('status', e.target.value)}\r\n                      className={classNames('w-full p-2 rounded-md border text-sm', theme === 'dark' ? 'border-gray-600 bg-gray-700 text-white' : 'border-gray-200 bg-white text-gray-900', 'focus:outline-none focus:ring-1 focus:ring-blue-500')}\r\n                    >\r\n                      <option value=\"Pendiente\">Pendiente</option>\r\n                      <option value=\"En Preparacin\">En Preparacin</option>\r\n                      <option value=\"En Camino\">En Camino</option>\r\n                      <option value=\"Entregado\">Entregado</option>\r\n                      <option value=\"Cancelado\">Cancelado</option>\r\n                    </select>\r\n                  </div>\r\n                  <div>\r\n                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">Mtodo de Pago</label>\r\n                    <OptionSelector\r\n                      title=\"Mtodo de Pago\"\r\n                      emoji=\"\"\r\n                      options={paymentMethods}\r\n                      selected={paymentMethods.find((m) => m.name === editForm.payment) || null}\r\n                      multiple={false}\r\n                      onImmediateSelect={(v) => handleEditFormFieldChange('payment', v?.name || '')}\r\n                    />\r\n                  </div>\r\n                  <div>\r\n                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">Domiciliario</label>\r\n                    <input\r\n                      type=\"text\"\r\n                      value={editForm.deliveryPerson || 'Sin asignar'}\r\n                      onChange={(e) => handleEditFormFieldChange('deliveryPerson', e.target.value)}\r\n                      className={classNames('w-full p-2 rounded-md border text-sm', theme === 'dark' ? 'border-gray-600 bg-gray-700 text-white' : 'border-gray-200 bg-white text-gray-900', 'focus:outline-none focus:ring-1 focus:ring-blue-500')}\r\n                    />\r\n                  </div>\r\n                </div>\r\n                <div className=\"mt-6 flex justify-end gap-2\">\r\n                  <button onClick={() => setEditingOrder(null)} className={classNames('px-4 py-2 rounded-md text-sm font-medium', theme === 'dark' ? 'bg-gray-600 hover:bg-gray-700 text-gray-200' : 'bg-gray-200 hover:bg-gray-300 text-gray-900')}>\r\n                    Cancelar\r\n                  </button>\r\n                  <button onClick={handleSaveEdit} disabled={isLoading} className={classNames('px-4 py-2 rounded-md text-sm font-medium', isLoading ? 'bg-gray-400 cursor-not-allowed' : theme === 'dark' ? 'bg-blue-600 hover:bg-blue-700 text-white' : 'bg-blue-500 hover:bg-blue-600 text-white')}>\r\n                    {isLoading ? 'Guardando...' : 'Guardar Cambios'}\r\n                  </button>\r\n                </div>\r\n              </Dialog.Panel>\r\n            </Transition.Child>\r\n          </div>\r\n        </Dialog>\r\n      </Transition>\r\n\r\n\r\n      {/* Dilogo para confirmar eliminacin de todos los pedidos */}\r\n      <Transition show={showConfirmDeleteAll} as={React.Fragment}>\r\n        <Dialog as=\"div\" className=\"relative z-50\" onClose={() => setShowConfirmDeleteAll(false)}>\r\n          <Transition.Child\r\n            as={React.Fragment}\r\n            enter=\"ease-out duration-300\"\r\n            enterFrom=\"opacity-0\"\r\n            enterTo=\"opacity-100\"\r\n            leave=\"ease-in duration-200\"\r\n            leaveFrom=\"opacity-100\"\r\n            leaveTo=\"opacity-0\"\r\n          >\r\n            <div className=\"fixed inset-0 bg-black bg-opacity-50\" />\r\n          </Transition.Child>\r\n          <div className=\"fixed inset-0 flex items-center justify-center p-4\">\r\n            <Transition.Child\r\n              as={React.Fragment}\r\n              enter=\"ease-out duration-300\"\r\n              enterFrom=\"opacity-0 scale-95\"\r\n              enterTo=\"opacity-100 scale-100\"\r\n              leave=\"ease-in duration-200\"\r\n              leaveFrom=\"opacity-100 scale-100\"\r\n              leaveTo=\"opacity-0 scale-95\"\r\n            >\r\n              <Dialog.Panel className={classNames(\r\n                \"w-full max-w-sm p-6 rounded-lg shadow-md text-center\",\r\n                theme === 'dark' ? 'bg-gray-800 text-gray-200' : 'bg-gray-50 text-gray-900'\r\n              )}>\r\n                <Dialog.Title className=\"text-lg font-medium mb-4\">Confirmar Eliminacin Masiva</Dialog.Title>\r\n                <p className=\"mb-4\">\r\n                  Ests a punto de eliminar <span className=\"font-bold text-red-500\">TODOS</span> los pedidos.\r\n                  Esta accin es irreversible. Para confirmar, escribe \"confirmar\" a continuacin:\r\n                </p>\r\n                <input\r\n                  type=\"text\"\r\n                  value={confirmText}\r\n                  onChange={e => setConfirmText(e.target.value)}\r\n                  className={classNames(\r\n                    \"w-full p-2 rounded-md border text-center text-sm\",\r\n                    theme === 'dark' ? 'border-gray-600 bg-gray-700 text-white' : 'border-gray-200 bg-white text-gray-900',\r\n                    \"focus:outline-none focus:ring-1 focus:ring-red-500\"\r\n                  )}\r\n                  placeholder=\"escribe 'confirmar'\"\r\n                />\r\n                <div className=\"mt-6 flex justify-center gap-2\">\r\n                  <button\r\n                    onClick={() => { setShowConfirmDeleteAll(false); setConfirmText(''); }}\r\n                    className={classNames(\r\n                      \"px-4 py-2 rounded-md text-sm font-medium\",\r\n                      theme === 'dark' ? 'bg-gray-600 hover:bg-gray-700 text-gray-200' : 'bg-gray-200 hover:bg-gray-300 text-gray-900'\r\n                    )}\r\n                  >\r\n                    Cancelar\r\n                  </button>\r\n                  <button\r\n                    onClick={handleDeleteAllOrders}\r\n                    disabled={isLoading || confirmText.toLowerCase() !== 'confirmar'}\r\n                    className={classNames(\r\n                      \"px-4 py-2 rounded-md text-sm font-medium\",\r\n                      isLoading || confirmText.toLowerCase() !== 'confirmar' ? 'bg-gray-400 cursor-not-allowed' : 'bg-red-600 hover:bg-red-700 text-white'\r\n                    )}\r\n                  >\r\n                    {isLoading ? 'Eliminando...' : 'Eliminar Todos'}\r\n                  </button>\r\n                </div>\r\n              </Dialog.Panel>\r\n            </Transition.Child>\r\n          </div>\r\n        </Dialog>\r\n      </Transition>\r\n\r\n      {/* Dilogo para generar nueva orden */}\r\n      <Transition show={showAddOrderModal} as={React.Fragment}>\r\n        <Dialog as=\"div\" className=\"relative z-50\" onClose={() => setShowAddOrderModal(false)}>\r\n          <Transition.Child\r\n            as={React.Fragment}\r\n            enter=\"ease-out duration-300\"\r\n            enterFrom=\"opacity-0\"\r\n            enterTo=\"opacity-100\"\r\n            leave=\"ease-in duration-200\"\r\n            leaveFrom=\"opacity-100\"\r\n            leaveTo=\"opacity-0\"\r\n          >\r\n            <div className=\"fixed inset-0 bg-black bg-opacity-50\" />\r\n          </Transition.Child>\r\n          <div className=\"fixed inset-0 flex items-center justify-center p-4\">\r\n            <Transition.Child\r\n              as={React.Fragment}\r\n              enter=\"ease-out duration-300\"\r\n              enterFrom=\"opacity-0 scale-95\"\r\n              enterTo=\"opacity-100 scale-100\"\r\n              leave=\"ease-in duration-200\"\r\n              leaveFrom=\"opacity-100 scale-100\"\r\n              leaveTo=\"opacity-0 scale-95\"\r\n            >\r\n              <Dialog.Panel className={classNames(\r\n                \"w-full max-w-2xl p-6 rounded-lg shadow-xl max-h-[80vh] overflow-y-auto\",\r\n                theme === 'dark' ? 'bg-gray-800 text-gray-200' : 'bg-gray-50 text-gray-900'\r\n              )}>\r\n                <Dialog.Title className=\"text-lg font-medium mb-4 flex justify-between items-center\">\r\n                  Generar Nueva Orden\r\n                  <button\r\n                    onClick={() => setShowAddOrderModal(false)}\r\n                    className=\"text-gray-500 hover:text-gray-400\"\r\n                    aria-label=\"Cerrar formulario de nueva orden\"\r\n                  >\r\n                    <XMarkIcon className=\"w-5 h-5\" />\r\n                  </button>\r\n                </Dialog.Title>\r\n                {newOrderForm.meals.map((meal, mealIndex) => (\r\n                  <div key={mealIndex} className=\"mb-6 p-4 border rounded-md border-gray-200 dark:border-gray-600\">\r\n                    <h3 className=\"font-medium mb-2\">Bandeja {mealIndex + 1}</h3>\r\n<div className=\"grid grid-cols-1 sm:grid-cols-2 gap-4\">\r\n  <div>\r\n    <label className=\"block text-sm font-medium mb-1\">Sopa o reemplazo</label>\r\n    <OptionSelector\r\n      title=\"Sopa\"\r\n      emoji=\"\"\r\n      options={soups}\r\n      selected={typeof meal.soup === 'string' ? soups.find(s => s.name === meal.soup) : meal.soup}\r\n      multiple={false}\r\n      onImmediateSelect={(v) => handleNewOrderMealFormFieldChange(mealIndex, 'soup', v)}\r\n    />\r\n  </div>\r\n\r\n  <div>\r\n    <label className=\"block text-sm font-medium mb-1\">Principio</label>\r\n    <OptionSelector\r\n      title=\"Principio\"\r\n      emoji=\"\"\r\n      options={principles}\r\n      selected={Array.isArray(meal.principle) ? meal.principle : []}\r\n      multiple={true}\r\n      showConfirmButton={true}\r\n      onImmediateSelect={(selection) => handleNewOrderMealFormFieldChange(mealIndex, 'principle', selection)}\r\n      onConfirm={({ selection }) => handleNewOrderMealFormFieldChange(mealIndex, 'principle', selection)}\r\n    />\r\n  </div>\r\n\r\n  <div>\r\n    <label className=\"block text-sm font-medium mb-1\">Protena</label>\r\n    <OptionSelector\r\n      title=\"Protena\"\r\n      emoji=\"\"\r\n      options={menuProteins}\r\n      selected={typeof meal.protein === 'string' ? menuProteins.find(p => p.name === meal.protein) : meal.protein}\r\n      multiple={false}\r\n      onImmediateSelect={(v) => handleNewOrderMealFormFieldChange(mealIndex, 'protein', v)}\r\n    />\r\n  </div>\r\n\r\n  <div>\r\n    <label className=\"block text-sm font-medium mb-1\">Bebida</label>\r\n    <OptionSelector\r\n      title=\"Bebida\"\r\n      emoji=\"\"\r\n      options={drinks}\r\n      selected={typeof meal.drink === 'string' ? drinks.find(d => d.name === meal.drink) : meal.drink}\r\n      multiple={false}\r\n      onImmediateSelect={(v) => handleNewOrderMealFormFieldChange(mealIndex, 'drink', v)}\r\n    />\r\n  </div>\r\n\r\n  <div className=\"sm:col-span-2\">\r\n    <label className=\"block text-sm font-medium mb-1\">Acompaamientos</label>\r\n    <OptionSelector\r\n      title=\"Acompaamientos\"\r\n      emoji=\"\"\r\n      options={sides}\r\n      selected={Array.isArray(meal.sides) ? meal.sides : []}\r\n      multiple={true}\r\n      onImmediateSelect={(selection) => handleNewOrderMealFormFieldChange(mealIndex, 'sides', selection)}\r\n    />\r\n  </div>\r\n\r\n  <div className=\"sm:col-span-2\">\r\n    <label className=\"block text-sm font-medium mb-1\">Adiciones</label>\r\n    <OptionSelector\r\n      title=\"Adiciones\"\r\n      emoji=\"\"\r\n      options={additions}\r\n      selected={Array.isArray(meal.additions) ? meal.additions : []}\r\n      multiple={true}\r\nonImmediateSelect={(sel) =>\r\n  handleNewOrderMealFormFieldChange(\r\n    mealIndex,\r\n    'additions',\r\n    sel.map(a => ({\r\n      id: a.id,\r\n      name: a.name,\r\n      price: a.price || 0,\r\n      protein: a.protein || '',\r\n      replacement: a.replacement || '',\r\n      quantity: a.quantity || 1\r\n    }))\r\n  )\r\n}\r\n\r\n    />\r\n  </div>\r\n\r\n  {/* Campos operativos */}\r\n  <div>\r\n    <label className=\"block text-sm font-medium mb-1\">Cubiertos</label>\r\n    <input\r\n      type=\"checkbox\"\r\n      checked={!!meal.cutlery}\r\n      onChange={e => handleNewOrderMealFormFieldChange(mealIndex, 'cutlery', e.target.checked)}\r\n      className=\"h-4 w-4\"\r\n    />\r\n  </div>\r\n\r\n  <div>\r\n    <label className=\"block text-sm font-medium mb-1\">Hora de Entrega</label>\r\n    <input\r\n      type=\"text\"\r\n      value={typeof meal.time === 'string' ? meal.time : (meal.time?.name || '')}\r\n      onChange={e => handleNewOrderMealFormFieldChange(mealIndex, 'time', e.target.value)}\r\n      className={classNames(\r\n        \"w-full p-2 rounded-md border text-sm\",\r\n        theme === 'dark' ? 'border-gray-600 bg-gray-700 text-white' : 'border-gray-200 bg-white text-gray-900',\r\n        \"focus:outline-none focus:ring-1 focus:ring-blue-500\"\r\n      )}\r\n    />\r\n  </div>\r\n\r\n  <div className=\"sm:col-span-2\">\r\n    <label className=\"block text-sm font-medium mb-1\">Direccin</label>\r\n    <input\r\n      type=\"text\"\r\n      value={meal.address?.address || ''}\r\n      onChange={e => handleNewOrderMealFormFieldChange(mealIndex, 'address.address', e.target.value)}\r\n      className={classNames(\r\n        \"w-full p-2 rounded-md border text-sm\",\r\n        theme === 'dark' ? 'border-gray-600 bg-gray-700 text-white' : 'border-gray-200 bg-white text-gray-900',\r\n        \"focus:outline-none focus:ring-1 focus:ring-blue-500\"\r\n      )}\r\n    />\r\n  </div>\r\n\r\n  <div>\r\n    <label className=\"block text-sm font-medium mb-1\">Telfono</label>\r\n    <input\r\n      type=\"text\"\r\n      value={meal.address?.phoneNumber || ''}\r\n      onChange={e => handleNewOrderMealFormFieldChange(mealIndex, 'address.phoneNumber', e.target.value)}\r\n      className={classNames(\r\n        \"w-full p-2 rounded-md border text-sm\",\r\n        theme === 'dark' ? 'border-gray-600 bg-gray-700 text-white' : 'border-gray-200 bg-white text-gray-900',\r\n        \"focus:outline-none focus:ring-1 focus:ring-blue-500\"\r\n      )}\r\n    />\r\n  </div>\r\n\r\n  <div>\r\n    <label className=\"block text-sm font-medium mb-1\">Tipo de Direccin</label>\r\n    <select\r\n      value={meal.address?.addressType || ''}\r\n      onChange={e => handleNewOrderMealFormFieldChange(mealIndex, 'address.addressType', e.target.value)}\r\n      className={classNames(\r\n        \"w-full p-2 rounded-md border text-sm\",\r\n        theme === 'dark' ? 'border-gray-600 bg-gray-700 text-white' : 'border-gray-200 bg-white text-gray-900',\r\n        \"focus:outline-none focus:ring-1 focus:ring-blue-500\"\r\n      )}\r\n    >\r\n      <option value=\"\">Seleccione</option>\r\n      <option value=\"house\">Casa/Apto</option>\r\n      <option value=\"school\">Colegio/Oficina</option>\r\n      <option value=\"complex\">Conjunto</option>\r\n      <option value=\"shop\">Tienda/Local</option>\r\n    </select>\r\n  </div>\r\n\r\n  {meal.address?.addressType === 'shop' && (\r\n    <div>\r\n      <label className=\"block text-sm font-medium mb-1\">Nombre del Local</label>\r\n      <input\r\n        type=\"text\"\r\n        value={meal.address?.localName || ''}\r\n        onChange={e => handleNewOrderMealFormFieldChange(mealIndex, 'address.localName', e.target.value)}\r\n        className={classNames(\r\n          \"w-full p-2 rounded-md border text-sm\",\r\n          theme === 'dark' ? 'border-gray-600 bg-gray-700 text-white' : 'border-gray-200 bg-white text-gray-900',\r\n          \"focus:outline-none focus:ring-1 focus:ring-blue-500\"\r\n        )}\r\n      />\r\n    </div>\r\n  )}\r\n\r\n  {meal.address?.addressType === 'school' && (\r\n    <div>\r\n      <label className=\"block text-sm font-medium mb-1\">Nombre del destinatario</label>\r\n      <input\r\n        type=\"text\"\r\n        value={meal.address?.recipientName || ''}\r\n        onChange={e => handleNewOrderMealFormFieldChange(mealIndex, 'address.recipientName', e.target.value)}\r\n        className={classNames(\r\n          \"w-full p-2 rounded-md border text-sm\",\r\n          theme === 'dark' ? 'border-gray-600 bg-gray-700 text-white' : 'border-gray-200 bg-white text-gray-900',\r\n          \"focus:outline-none focus:ring-1 focus:ring-blue-500\"\r\n        )}\r\n      />\r\n    </div>\r\n  )}\r\n\r\n  {meal.address?.addressType === 'complex' && (\r\n    <div>\r\n      <label className=\"block text-sm font-medium mb-1\">Detalles (Torre/Apto)</label>\r\n      <input\r\n        type=\"text\"\r\n        value={meal.address?.unitDetails || ''}\r\n        onChange={e => handleNewOrderMealFormFieldChange(mealIndex, 'address.unitDetails', e.target.value)}\r\n        className={classNames(\r\n          \"w-full p-2 rounded-md border text-sm\",\r\n          theme === 'dark' ? 'border-gray-600 bg-gray-700 text-white' : 'border-gray-200 bg-white text-gray-900',\r\n          \"focus:outline-none focus:ring-1 focus:ring-blue-500\"\r\n        )}\r\n      />\r\n    </div>\r\n  )}\r\n\r\n  <div className=\"sm:col-span-2\">\r\n    <label className=\"block text-sm font-medium mb-1\">Notas</label>\r\n    <input\r\n      type=\"text\"\r\n      value={meal.notes || ''}\r\n      onChange={e => handleNewOrderMealFormFieldChange(mealIndex, 'notes', e.target.value)}\r\n      className={classNames(\r\n        \"w-full p-2 rounded-md border text-sm\",\r\n        theme === 'dark' ? 'border-gray-600 bg-gray-700 text-white' : 'border-gray-200 bg-white text-gray-900',\r\n        \"focus:outline-none focus:ring-1 focus:ring-blue-500\"\r\n      )}\r\n    />\r\n  </div>\r\n</div>\r\n\r\n\r\n                  </div>\r\n                ))}\r\n                {/* Campos de la orden principal */}\r\n                <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-4 mt-6\">\r\n                  <div>\r\n                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">Total</label>\r\n                    <input\r\n                      type=\"number\"\r\n                      value={newOrderForm.total || 0}\r\n                      onChange={e => handleNewOrderFieldChange('total', Number(e.target.value))}\r\n                      className={classNames(\r\n                        \"w-full p-2 rounded-md border text-sm\",\r\n                        theme === 'dark' ? 'border-gray-600 bg-gray-700 text-white' : 'border-gray-200 bg-white text-gray-900',\r\n                        \"focus:outline-none focus:ring-1 focus:ring-blue-500\"\r\n                      )}\r\n                    />\r\n                  </div>\r\n                  <div>\r\n                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">Estado</label>\r\n                    <select\r\n                      value={newOrderForm.status || 'Pendiente'}\r\n                      onChange={e => handleNewOrderFieldChange('status', e.target.value)}\r\n                      className={classNames(\r\n                        \"w-full p-2 rounded-md border text-sm\",\r\n                        theme === 'dark' ? 'border-gray-600 bg-gray-700 text-white' : 'border-gray-200 bg-white text-gray-900',\r\n                        \"focus:outline-none focus:ring-1 focus:ring-blue-500\"\r\n                      )}\r\n                    >\r\n                      <option value=\"Pendiente\">Pendiente</option>\r\n                      <option value=\"En Preparacin\">En Preparacin</option>\r\n                      <option value=\"En Camino\">En Camino</option>\r\n                      <option value=\"Entregado\">Entregado</option>\r\n                      <option value=\"Cancelado\">Cancelado</option>\r\n                    </select>\r\n                  </div>\r\n                  <div>\r\n                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">Mtodo de Pago</label>\r\n                    <select\r\n                      value={newOrderForm.payment || 'Efectivo'}\r\n                      onChange={e => handleNewOrderFieldChange('payment', e.target.value)}\r\n                      className={classNames(\r\n                        \"w-full p-2 rounded-md border text-sm\",\r\n                        theme === 'dark' ? 'border-gray-600 bg-gray-700 text-white' : 'border-gray-200 bg-white text-gray-900',\r\n                        \"focus:outline-none focus:ring-1 focus:ring-blue-500\"\r\n                      )}\r\n                    >\r\n                      <option value=\"Efectivo\">Efectivo</option>\r\n                      <option value=\"Daviplata\">Daviplata</option>\r\n                      <option value=\"Nequi\">Nequi</option>\r\n                    </select>\r\n                  </div>\r\n                  <div>\r\n                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">Domiciliario</label>\r\n                    <input\r\n                      type=\"text\"\r\n                      value={newOrderForm.deliveryPerson || 'Sin asignar'}\r\n                      onChange={e => handleNewOrderFieldChange('deliveryPerson', e.target.value)}\r\n                      className={classNames(\r\n                        \"w-full p-2 rounded-md border text-sm\",\r\n                        theme === 'dark' ? 'border-gray-600 bg-gray-700 text-white' : 'border-gray-200 bg-white text-gray-900',\r\n                        \"focus:outline-none focus:ring-1 focus:ring-blue-500\"\r\n                      )}\r\n                    />\r\n                  </div>\r\n                </div>\r\n                <div className=\"mt-6 flex justify-end gap-2\">\r\n                  <button\r\n                    onClick={() => setShowAddOrderModal(false)}\r\n                    className={classNames(\r\n                      \"px-4 py-2 rounded-md text-sm font-medium\",\r\n                      theme === 'dark' ? 'bg-gray-600 hover:bg-gray-700 text-gray-200' : 'bg-gray-200 hover:bg-gray-300 text-gray-900'\r\n                    )}\r\n                  >\r\n                    Cancelar\r\n                  </button>\r\n                  <button\r\n                    onClick={handleAddOrderSubmit}\r\n                    disabled={isLoading}\r\n                    className={classNames(\r\n                      \"px-4 py-2 rounded-md text-sm font-medium\",\r\n                      isLoading ? 'bg-gray-400 cursor-not-allowed' : theme === 'dark' ? 'bg-blue-600 hover:bg-blue-700 text-white' : 'bg-blue-500 hover:bg-blue-600 text-white'\r\n                    )}\r\n                  >\r\n                    {isLoading ? 'Guardando...' : 'Crear Orden'}\r\n                  </button>\r\n                </div>\r\n              </Dialog.Panel>\r\n            </Transition.Child>\r\n          </div>\r\n        </Dialog>\r\n      </Transition>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default InteraccionesPedidos;","// src/components/Admin/OrderManagement.jsx\r\nimport React, { useState, useEffect, useCallback, useMemo } from 'react';\r\nimport { db } from '../../config/firebase.js';\r\nimport {\r\n  collection,\r\n  onSnapshot,\r\n  updateDoc,\r\n  doc,\r\n  deleteDoc,\r\n  getDocs,\r\n  query,\r\n  where,\r\n  writeBatch,\r\n  addDoc,\r\n  serverTimestamp\r\n} from 'firebase/firestore';\r\nimport { exportToExcel } from './utilities/exportToExcel.js';\r\nimport { exportToPDF } from './utilities/exportToPDF.js';\r\nimport { exportToCSV } from './utilities/exportToCSV.js';\r\nimport { generatePreviewHtml } from './utilities/previewOrders.js';\r\nimport { generateExcelPreviewHtml } from './utilities/previewExcel.js';\r\nimport { cleanText } from './utils.js';\r\nimport TablaPedidos from './TablaPedidos.js';\r\nimport InteraccionesPedidos from './InteraccionesPedidos.js';\r\n\r\nconst OrderManagement = ({ setError, setSuccess, theme }) => {\r\n  const [orders, setOrders] = useState([]);\r\n  const [editingOrder, setEditingOrder] = useState(null);\r\n  const [searchTerm, setSearchTerm] = useState('');\r\n  const [totals, setTotals] = useState({ cash: 0, daviplata: 0, nequi: 0 });\r\n  const [editForm, setEditForm] = useState({ meals: [], total: 0, status: '', payment: '', deliveryPerson: '' });\r\n  const [currentPage, setCurrentPage] = useState(1);\r\n  const [itemsPerPage, setItemsPerPage] = useState(10);\r\n  const [isLoading, setIsLoading] = useState(true);\r\n  const [showConfirmDeleteAll, setShowConfirmDeleteAll] = useState(false);\r\n  const [confirmText, setConfirmText] = useState('');\r\n  const [showMealDetails, setShowMealDetails] = useState(null);\r\n  const [editingDeliveryId, setEditingDeliveryId] = useState(null);\r\n  const [deliveryPersons, setDeliveryPersons] = useState({});\r\n  const [sortBy, setSortBy] = useState('createdAt.seconds');\r\n  const [sortOrder, setSortOrder] = useState('desc');\r\n  const [proteins, setProteins] = useState([]);\r\n  const [newProtein, setNewProtein] = useState({ name: '', quantity: '' });\r\n  const [showProteinModal, setShowProteinModal] = useState(false);\r\n  const [isMenuOpen, setIsMenuOpen] = useState(false);\r\n  const [showAddOrderModal, setShowAddOrderModal] = useState(false);\r\n  const [orderTypeFilter, setOrderTypeFilter] = useState('all');\r\n  const [newOrderForm, setNewOrderForm] = useState({\r\n    meals: [\r\n      {\r\n        soup: '',\r\n        soupReplacement: '',\r\n        principle: [{ name: '' }],\r\n        principleReplacement: '',\r\n        protein: '',\r\n        drink: '',\r\n        cutlery: '',\r\n        sides: [],\r\n        additions: [],\r\n        notes: '',\r\n        address: {\r\n          address: '',\r\n          phoneNumber: '',\r\n          addressType: '',\r\n          localName: '',\r\n          recipientName: ''\r\n        },\r\n        time: '',\r\n        payment: 'Efectivo'\r\n      }\r\n    ],\r\n    total: 0,\r\n    status: 'Pendiente',\r\n    payment: 'Efectivo',\r\n    deliveryPerson: 'Sin asignar',\r\n    type: 'lunch'\r\n  });\r\n\r\n  const totalProteinUnits = useMemo(\r\n    () => proteins.reduce((sum, p) => sum + Number(p.quantity || 0), 0),\r\n    [proteins]\r\n  );\r\n\r\n  const logActivity = useCallback(async (action, details = {}) => {\r\n    try {\r\n      await addDoc(collection(db, 'userActivity'), {\r\n        action,\r\n        timestamp: serverTimestamp(),\r\n        details\r\n      });\r\n    } catch (error) {\r\n      console.error('Error al registrar actividad:', error);\r\n    }\r\n  }, []);\r\n\r\n  const handleExport = (exportFunction, format) => {\r\n    try {\r\n      exportFunction(orders, totals, deliveryPersons, totalProteinUnits, proteins);\r\n      setSuccess(`Exportado correctamente como ${format}.`);\r\n      logActivity(`Export pedidos como ${format}`, { format });\r\n    } catch (error) {\r\n      console.error(`Error al exportar ${format}:`, error);\r\n      setError(`Error al exportar ${format}: ${error.message}`);\r\n    }\r\n  };\r\n\r\n  const fetchOrders = useCallback(() => {\r\n    setIsLoading(true);\r\n\r\n    let latestLunch = [];\r\n    let latestBreakfast = [];\r\n\r\n    const recompute = () => {\r\n      const merged = [...latestLunch, ...latestBreakfast];\r\n\r\n      setOrders(merged);\r\n\r\n      const newTotals = { cash: 0, daviplata: 0, nequi: 0, general: 0 };\r\n      const newDeliveryPersons = {};\r\n\r\n      merged.forEach((order) => {\r\n        if (order.status !== 'Cancelado') {\r\n          const paymentSummary = order.paymentSummary || { Efectivo: 0, Daviplata: 0, Nequi: 0 };\r\n          newTotals.cash += paymentSummary['Efectivo'] || 0;\r\n          newTotals.daviplata += paymentSummary['Daviplata'] || 0;\r\n          newTotals.nequi += paymentSummary['Nequi'] || 0;\r\n          newTotals.general += order.total || 0;\r\n\r\n          const deliveryPerson = order.deliveryPerson || 'Sin asignar';\r\n          if (deliveryPerson !== 'Sin asignar') {\r\n            if (!newDeliveryPersons[deliveryPerson]) {\r\n              newDeliveryPersons[deliveryPerson] = {\r\n                almuerzo: { efectivo: 0, daviplata: 0, nequi: 0, total: 0 },\r\n                desayuno: { efectivo: 0, daviplata: 0, nequi: 0, total: 0 }\r\n              };\r\n            }\r\n            const bucket = order.type === 'breakfast' ? 'desayuno' : 'almuerzo';\r\n            const paymentType = cleanText(order.payment || 'Efectivo').toLowerCase();\r\n            const amount = order.total || 0;\r\n\r\n            if (paymentType === 'efectivo') newDeliveryPersons[deliveryPerson][bucket].efectivo += amount;\r\n            else if (paymentType === 'daviplata') newDeliveryPersons[deliveryPerson][bucket].daviplata += amount;\r\n            else if (paymentType === 'nequi') newDeliveryPersons[deliveryPerson][bucket].nequi += amount;\r\n\r\n            newDeliveryPersons[deliveryPerson][bucket].total += amount;\r\n          }\r\n        }\r\n      });\r\n\r\n      setTotals(newTotals);\r\n      setDeliveryPersons(newDeliveryPersons);\r\n      setIsLoading(false);\r\n    };\r\n\r\n    const unsubLunch = onSnapshot(\r\n      collection(db, 'orders'),\r\n      (snapshot) => {\r\n        latestLunch = snapshot.docs.map((doc) => {\r\n          const data = doc.data();\r\n          const meals =\r\n            Array.isArray(data.meals) && data.meals.length > 0\r\n              ? data.meals\r\n              : [{ address: {}, payment: { name: 'Efectivo' }, time: {} }];\r\n\r\n        return {\r\n            id: doc.id,\r\n            type: 'lunch',\r\n            ...data,\r\n            meals: meals.map((meal) => ({\r\n              ...meal,\r\n              address: meal.address || {},\r\n              payment:\r\n                meal.payment && typeof meal.payment === 'object' && meal.payment.name\r\n                  ? meal.payment\r\n                  : { name: meal.payment || 'Efectivo' },\r\n              time: meal.time || {}\r\n            })),\r\n            payment: data.payment || (meals[0]?.payment?.name || 'Efectivo'),\r\n            paymentSummary: data.paymentSummary || { Efectivo: 0, Daviplata: 0, Nequi: 0 },\r\n            total: data.total || 0,\r\n            deliveryPerson: data.deliveryPerson || 'Sin asignar',\r\n            status: data.status || 'Pendiente'\r\n          };\r\n        });\r\n        recompute();\r\n      },\r\n      (error) => {\r\n        setError(`Error al cargar almuerzos: ${error.message}`);\r\n        setIsLoading(false);\r\n      }\r\n    );\r\n\r\n    const unsubBreakfast = onSnapshot(\r\n      collection(db, 'deliveryBreakfastOrders'),\r\n      (snapshot) => {\r\n        latestBreakfast = snapshot.docs.map((doc) => {\r\n          const data = doc.data();\r\n          return {\r\n            id: doc.id,\r\n            type: 'breakfast',\r\n            ...data,\r\n            payment: data.payment || (data.breakfasts?.[0]?.payment?.name || 'Efectivo'),\r\n            paymentSummary: data.paymentSummary || { Efectivo: 0, Daviplata: 0, Nequi: 0 },\r\n            total: data.total || 0,\r\n            deliveryPerson: data.deliveryPerson || 'Sin asignar',\r\n            status: data.status || 'Pendiente'\r\n          };\r\n        });\r\n        recompute();\r\n      },\r\n      (error) => {\r\n        setError(`Error al cargar desayunos: ${error.message}`);\r\n        setIsLoading(false);\r\n      }\r\n    );\r\n\r\n    return () => {\r\n      unsubLunch();\r\n      unsubBreakfast();\r\n    };\r\n  }, [setError]);\r\n\r\n  const fetchProteins = useCallback(() => {\r\n    const today = new Date().toISOString().split('T')[0];\r\n    const proteinsColRef = query(collection(db, 'dailyProteins'), where('date', '==', today));\r\n    const unsubscribe = onSnapshot(\r\n      proteinsColRef,\r\n      (snapshot) => {\r\n        const proteinsData = snapshot.docs.map((doc) => ({ id: doc.id, ...doc.data() }));\r\n        setProteins(proteinsData);\r\n      },\r\n      (error) => {\r\n        setError(`Error al cargar protenas: ${error.message}`);\r\n      }\r\n    );\r\n    return () => unsubscribe();\r\n  }, [setError]);\r\n\r\n  useEffect(() => {\r\n    const unsubscribeOrders = fetchOrders();\r\n    const unsubscribeProteins = fetchProteins();\r\n    return () => {\r\n      unsubscribeOrders();\r\n      unsubscribeProteins();\r\n    };\r\n  }, [fetchOrders, fetchProteins]);\r\n\r\n  const filteredOrders = useMemo(() => {\r\n    return orders.filter((order) => {\r\n      const lowerSearchTerm = (searchTerm || '').toLowerCase();\r\n\r\n      const addrObj = order.meals?.[0]?.address || order.breakfasts?.[0]?.address || {};\r\n      const address = (addrObj.address || '').toLowerCase();\r\n      const phone = (addrObj.phoneNumber || '').toLowerCase();\r\n\r\n      const timeObj = order.meals?.[0]?.time || order.breakfasts?.[0]?.time;\r\n      const time = (typeof timeObj === 'string' ? timeObj : timeObj?.name || '').toLowerCase();\r\n\r\n      const payment = cleanText(\r\n        order.payment || order.meals?.[0]?.payment?.name || order.breakfasts?.[0]?.payment?.name || ''\r\n      ).toLowerCase();\r\n\r\n      const deliveryPerson = (order.deliveryPerson || '').toLowerCase();\r\n      const status = (order.status || '').toLowerCase();\r\n\r\n      return (\r\n        (orderTypeFilter === 'all' || order.type === orderTypeFilter) &&\r\n        (address.includes(lowerSearchTerm) ||\r\n          phone.includes(lowerSearchTerm) ||\r\n          time.includes(lowerSearchTerm) ||\r\n          payment.includes(lowerSearchTerm) ||\r\n          deliveryPerson.includes(lowerSearchTerm) ||\r\n          status.includes(lowerSearchTerm))\r\n      );\r\n    });\r\n  }, [orders, searchTerm, orderTypeFilter]);\r\n\r\n  // Totales visibles\r\n  const displayedTotals = useMemo(() => {\r\n    const t = { cash: 0, daviplata: 0, nequi: 0, general: 0 };\r\n    filteredOrders.forEach((order) => {\r\n      if (order.status === 'Cancelado') return;\r\n      const ps = order.paymentSummary || { Efectivo: 0, Daviplata: 0, Nequi: 0 };\r\n      t.cash += ps['Efectivo'] || 0;\r\n      t.daviplata += ps['Daviplata'] || 0;\r\n      t.nequi += ps['Nequi'] || 0;\r\n      t.general += order.total || 0;\r\n    });\r\n    return t;\r\n  }, [filteredOrders]);\r\n\r\n  const sortedOrders = useMemo(() => {\r\n    return [...filteredOrders].sort((a, b) => {\r\n      const getValue = (obj, path, currentFilteredOrdersArray) => {\r\n        if (path === 'orderNumber') return obj ? currentFilteredOrdersArray.indexOf(obj) : -1;\r\n\r\n        if (path.startsWith('createdAt')) {\r\n          const ts = obj.createdAt;\r\n          if (ts && typeof ts.toMillis === 'function') return ts.toMillis();\r\n          if (ts instanceof Date) return ts.getTime();\r\n          return ts && ts.seconds ? ts.seconds * 1000 : 0;\r\n        }\r\n\r\n        const readPath = (o, p) =>\r\n          p.split('.').reduce((acc, part) => (acc && acc[part] !== undefined ? acc[part] : undefined), o);\r\n\r\n        let value = readPath(obj, path);\r\n\r\n        if ((value === undefined || value === null || value === '') && path.startsWith('meals.0.')) {\r\n          const altPath = path.replace(/^meals\\.0\\./, 'breakfasts.0.');\r\n          value = readPath(obj, altPath);\r\n        }\r\n\r\n        if (path.endsWith('.time.name') && typeof value !== 'string') {\r\n          value = value?.name || '';\r\n        }\r\n\r\n        return typeof value === 'number' ? value : cleanText(value) || '';\r\n      };\r\n\r\n      const valueA = getValue(a, sortBy, filteredOrders);\r\n      const valueB = getValue(b, sortBy, filteredOrders);\r\n\r\n      if (typeof valueA === 'string' && typeof valueB === 'string') {\r\n        return sortOrder === 'asc' ? valueA.localeCompare(valueB) : valueB.localeCompare(valueA);\r\n      }\r\n      return sortOrder === 'asc' ? valueA - valueB : valueB - valueA;\r\n    });\r\n  }, [filteredOrders, sortBy, sortOrder]);\r\n\r\n  const totalPages = Math.ceil(sortedOrders.length / itemsPerPage);\r\n  const paginatedOrders = useMemo(() => {\r\n    const start = (currentPage - 1) * itemsPerPage;\r\n    const end = start + itemsPerPage;\r\n    return sortedOrders.slice(start, end);\r\n  }, [sortedOrders, currentPage, itemsPerPage]);\r\n\r\n  const handleSort = (key) => {\r\n    if (sortBy === key) {\r\n      setSortOrder(sortOrder === 'asc' ? 'desc' : 'asc');\r\n    } else {\r\n      setSortBy(key);\r\n      setSortOrder('asc');\r\n    }\r\n    setCurrentPage(1);\r\n  };\r\n\r\n  const getSortIcon = (key) => {\r\n    if (sortBy !== key) return null;\r\n    return sortOrder === 'asc' ? (\r\n      <svg className=\"w-4 h-4 inline ml-1\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth=\"2\" d=\"M5 15l7-7 7 7\" />\r\n      </svg>\r\n    ) : (\r\n      <svg className=\"w-4 h-4 inline ml-1\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth=\"2\" d=\"M19 9l-7 7-7-7\" />\r\n      </svg>\r\n    );\r\n  };\r\n\r\n  const handleAddProtein = async () => {\r\n    if (\r\n      !newProtein.name ||\r\n      !newProtein.quantity ||\r\n      isNaN(newProtein.quantity) ||\r\n      Number(newProtein.quantity) <= 0\r\n    ) {\r\n      setError('Por favor, ingrese un nombre de protena vlido y una cantidad mayor a 0.');\r\n      return;\r\n    }\r\n    setIsLoading(true);\r\n    try {\r\n      await addDoc(collection(db, 'dailyProteins'), {\r\n        name: newProtein.name.trim(),\r\n        quantity: Number(newProtein.quantity),\r\n        date: new Date().toISOString().split('T')[0],\r\n        createdAt: new Date()\r\n      });\r\n      setNewProtein({ name: '', quantity: '' });\r\n      setShowProteinModal(false);\r\n      setSuccess('Protena agregada correctamente.');\r\n      logActivity(`Agreg protena: ${newProtein.name} (${newProtein.quantity} unidades)`, {\r\n        proteinName: newProtein.name,\r\n        quantity: Number(newProtein.quantity)\r\n      });\r\n    } catch (error) {\r\n      setError(`Error al agregar protena: ${error.message}`);\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleEditOrder = useCallback((order) => {\r\n    setEditingOrder(order);\r\n\r\n    const defaultAddress = {\r\n      address: '',\r\n      phoneNumber: '',\r\n      addressType: '',\r\n      localName: '',\r\n      recipientName: '',\r\n      unitDetails: ''\r\n    };\r\n\r\n    if (order.type === 'breakfast') {\r\n      const breakfasts =\r\n        Array.isArray(order.breakfasts) && order.breakfasts.length > 0\r\n          ? order.breakfasts.map((b) => ({\r\n              ...b,\r\n              address: b.address || { ...defaultAddress },\r\n              additions: Array.isArray(b.additions) ? b.additions : [],\r\n              cutlery: typeof b.cutlery === 'boolean' ? b.cutlery : !!b.cutlery,\r\n              time: b.time || '',\r\n              notes: b.notes || '',\r\n              type: b.type || null,\r\n              eggs: b.eggs || null,\r\n              broth: b.broth || null,\r\n              riceBread: b.riceBread || null,\r\n              drink: b.drink || null,\r\n              protein: b.protein || null\r\n            }))\r\n          : [\r\n              {\r\n                type: null,\r\n                eggs: null,\r\n                broth: null,\r\n                riceBread: null,\r\n                drink: null,\r\n                protein: null,\r\n                additions: [],\r\n                notes: '',\r\n                cutlery: false,\r\n                time: '',\r\n                address: { ...defaultAddress }\r\n              }\r\n            ];\r\n\r\n      setEditForm({\r\n        id: order.id,\r\n        breakfasts,\r\n        total: order.total || 0,\r\n        status: order.status || 'Pendiente',\r\n        payment: order.payment ? cleanText(order.payment) : 'Efectivo',\r\n        deliveryPerson: order.deliveryPerson || 'Sin asignar',\r\n        type: 'breakfast'\r\n      });\r\n      return;\r\n    }\r\n\r\n    const meals =\r\n      Array.isArray(order.meals) && order.meals.length > 0\r\n        ? order.meals.map((meal) => ({\r\n            ...meal,\r\n            address: meal.address || { ...defaultAddress },\r\n            payment: meal.payment ? cleanText(meal.payment?.name || meal.payment) : 'Efectivo',\r\n            additions: Array.isArray(meal.additions) ? meal.additions : [],\r\n            principle: Array.isArray(meal.principle)\r\n              ? meal.principle\r\n              : meal.principle\r\n              ? [{ name: meal.principle.name || meal.principle }]\r\n              : [],\r\n            cutlery: typeof meal.cutlery === 'boolean' ? meal.cutlery : !!meal.cutlery,\r\n            sides: Array.isArray(meal.sides) ? meal.sides : [],\r\n            soup: meal.soup || '',\r\n            soupReplacement: meal.soupReplacement || '',\r\n            protein: meal.protein || '',\r\n            drink: meal.drink || '',\r\n            time: meal.time || '',\r\n            notes: meal.notes || ''\r\n          }))\r\n        : [\r\n            {\r\n              soup: '',\r\n              soupReplacement: '',\r\n              principle: [{ name: '' }],\r\n              principleReplacement: '',\r\n              protein: '',\r\n              drink: '',\r\n              cutlery: false,\r\n              sides: [],\r\n              additions: [],\r\n              notes: '',\r\n              address: { ...defaultAddress },\r\n              time: '',\r\n              payment: 'Efectivo'\r\n            }\r\n          ];\r\n\r\n    setEditForm({\r\n      id: order.id,\r\n      meals,\r\n      total: order.total || 0,\r\n      status: order.status || 'Pendiente',\r\n      payment: order.payment ? cleanText(order.payment) : 'Efectivo',\r\n      deliveryPerson: order.deliveryPerson || 'Sin asignar',\r\n      type: 'lunch'\r\n    });\r\n  }, []);\r\n\r\n  const handleEditFormFieldChange = (field, value) => {\r\n    setEditForm((prev) => ({ ...prev, [field]: value }));\r\n  };\r\n\r\n  const handleEditOrderMealFormFieldChange = (mealIndex, field, value) => {\r\n    setEditForm((prev) => {\r\n      const newMeals = [...(prev.meals || [])];\r\n      if (!newMeals[mealIndex]) newMeals[mealIndex] = { address: {}, payment: {}, time: {} };\r\n\r\n      if (field.includes('.')) {\r\n        const [parent, child] = field.split('.');\r\n        newMeals[mealIndex] = {\r\n          ...newMeals[mealIndex],\r\n          [parent]: { ...(newMeals[mealIndex][parent] || {}), [child]: value }\r\n        };\r\n      } else if (field === 'sides') {\r\n        if (Array.isArray(value)) {\r\n          newMeals[mealIndex] = { ...newMeals[mealIndex], sides: value };\r\n        } else {\r\n          newMeals[mealIndex] = {\r\n            ...newMeals[mealIndex],\r\n            sides: String(value)\r\n              .split(',')\r\n              .map((s) => ({ name: s.trim() }))\r\n              .filter((s) => s.name)\r\n          };\r\n        }\r\n      } else if (field === 'additions') {\r\n        if (Array.isArray(value)) {\r\n          newMeals[mealIndex] = { ...newMeals[mealIndex], additions: value };\r\n        } else {\r\n          newMeals[mealIndex] = {\r\n            ...newMeals[mealIndex],\r\n            additions: String(value)\r\n              .split(';')\r\n              .map((a) => {\r\n                const [name, proteinOrReplacement = '', quantity = '1'] = a.split(',');\r\n                return {\r\n                  name: name.trim(),\r\n                  [proteinOrReplacement.includes('por') ? 'replacement' : 'protein']: proteinOrReplacement.trim(),\r\n                  quantity: Number(quantity) || 1\r\n                };\r\n              })\r\n              .filter((a) => a.name)\r\n          };\r\n        }\r\n      } else if (field === 'principle') {\r\n        if (Array.isArray(value)) {\r\n          newMeals[mealIndex] = { ...newMeals[mealIndex], principle: value };\r\n        } else {\r\n          newMeals[mealIndex] = {\r\n            ...newMeals[mealIndex],\r\n            principle: String(value)\r\n              .split(',')\r\n              .map((p) => ({ name: p.trim() }))\r\n              .filter((p) => p.name)\r\n          };\r\n        }\r\n      } else {\r\n        newMeals[mealIndex] = { ...newMeals[mealIndex], [field]: value };\r\n      }\r\n\r\n      return { ...prev, meals: newMeals };\r\n    });\r\n  };\r\n\r\n  const handleSaveEdit = async () => {\r\n    if (!editingOrder) return;\r\n    setIsLoading(true);\r\n    try {\r\n      const oldOrder = orders.find((o) => o.id === editingOrder.id);\r\n      const previousState = oldOrder\r\n        ? {\r\n            meals: oldOrder.meals,\r\n            breakfasts: oldOrder.breakfasts,\r\n            total: oldOrder.total,\r\n            status: oldOrder.status,\r\n            payment: oldOrder.payment,\r\n            deliveryPerson: oldOrder.deliveryPerson,\r\n            type: oldOrder.type\r\n          }\r\n        : {};\r\n\r\n      const paymentSummary = {\r\n        Efectivo: editForm.payment === 'Efectivo' ? Number(editForm.total) || 0 : 0,\r\n        Daviplata: editForm.payment === 'Daviplata' ? Number(editForm.total) || 0 : 0,\r\n        Nequi: editForm.payment === 'Nequi' ? Number(editForm.total) || 0 : 0\r\n      };\r\n\r\n      let updateDataBase = {\r\n        total: Number(editForm.total) || 0,\r\n        status: editForm.status || 'Pendiente',\r\n        payment: editForm.payment || 'Efectivo',\r\n        deliveryPerson: editForm.deliveryPerson || 'Sin asignar',\r\n        paymentSummary,\r\n        updatedAt: new Date(),\r\n        type: editForm.type || editingOrder.type || 'lunch'\r\n      };\r\n\r\n      if ((editingOrder.type || editForm.type) === 'breakfast') {\r\n        const updatedBreakfastsForDB = (editForm.breakfasts || []).map((b) => ({\r\n          type: b.type ? { name: (typeof b.type === 'string' ? b.type : b.type.name) || '' } : null,\r\n          eggs: b.eggs ? { name: (typeof b.eggs === 'string' ? b.eggs : b.eggs.name) || '' } : null,\r\n          broth: b.broth ? { name: (typeof b.broth === 'string' ? b.broth : b.broth.name) || '' } : null,\r\n          riceBread: b.riceBread ? { name: (typeof b.riceBread === 'string' ? b.riceBread : b.riceBread.name) || '' } : null,\r\n          drink: b.drink ? { name: (typeof b.drink === 'string' ? b.drink : b.drink.name) || '' } : null,\r\n          protein: b.protein ? { name: (typeof b.protein === 'string' ? b.protein : b.protein.name) || '' } : null,\r\n          additions: Array.isArray(b.additions)\r\n            ? b.additions\r\n                .map((a) => ({ name: a.name || '', quantity: Number(a.quantity) || 1 }))\r\n                .filter((a) => a.name)\r\n            : [],\r\n          notes: b.notes || '',\r\n          cutlery: !!b.cutlery,\r\n          time: b.time ? { name: (typeof b.time === 'string' ? b.time : b.time.name) || '' } : null,\r\n          address: {\r\n            address: b.address?.address || '',\r\n            phoneNumber: b.address?.phoneNumber || '',\r\n            addressType: b.address?.addressType || '',\r\n            localName: b.address?.localName || '',\r\n            recipientName: b.address?.recipientName || '',\r\n            unitDetails: b.address?.unitDetails || ''\r\n          }\r\n        }));\r\n\r\n        updateDataBase = { ...updateDataBase, breakfasts: updatedBreakfastsForDB };\r\n        await updateDoc(doc(db, 'deliveryBreakfastOrders', editingOrder.id), updateDataBase);\r\n\r\n        logActivity(`Edit (desayuno) el pedido ${editingOrder.id}`, {\r\n          orderId: editingOrder.id,\r\n          previousState,\r\n          newState: { ...editForm, breakfasts: updatedBreakfastsForDB }\r\n        });\r\n      } else {\r\n        const updatedMealsForDB = (editForm.meals || []).map((meal) => ({\r\n          soup: meal.soup ? { name: (typeof meal.soup === 'string' ? meal.soup : meal.soup.name) || '' } : null,\r\n          soupReplacement: meal.soupReplacement\r\n            ? { name: (typeof meal.soupReplacement === 'string' ? meal.soupReplacement : meal.soupReplacement.name) || '' }\r\n            : null,\r\n          principle: Array.isArray(meal.principle)\r\n            ? meal.principle\r\n                .map((p) => ({ name: (typeof p === 'string' ? p : p.name) || '' }))\r\n                .filter((p) => p.name)\r\n            : [],\r\n          principleReplacement: meal.principleReplacement\r\n            ? { name: (typeof meal.principleReplacement === 'string' ? meal.principleReplacement : meal.principleReplacement.name) || '' }\r\n            : null,\r\n          protein: meal.protein ? { name: (typeof meal.protein === 'string' ? meal.protein : meal.protein.name) || '' } : null,\r\n          drink: meal.drink ? { name: (typeof meal.drink === 'string' ? meal.drink : meal.drink.name) || '' } : null,\r\n          cutlery: !!meal.cutlery,\r\n          time: meal.time ? { name: (typeof meal.time === 'string' ? meal.time : meal.time.name) || '' } : null,\r\n          payment: meal.payment\r\n            ? { name: (typeof meal.payment === 'string' ? meal.payment : meal.payment.name) || 'Efectivo' }\r\n            : { name: 'Efectivo' },\r\n          sides: Array.isArray(meal.sides)\r\n            ? meal.sides\r\n                .map((s) => ({ name: (typeof s === 'string' ? s : s.name) || '' }))\r\n                .filter((s) => s.name)\r\n            : [],\r\n          additions: Array.isArray(meal.additions)\r\n            ? meal.additions.map((a) => ({\r\n                name: a.name || '',\r\n                protein: a.protein || '',\r\n                replacement: a.replacement || '',\r\n                quantity: Number(a.quantity) || 1\r\n              }))\r\n            : [],\r\n          notes: meal.notes || '',\r\n          address: {\r\n            address: meal.address?.address || '',\r\n            phoneNumber: meal.address?.phoneNumber || '',\r\n            addressType: meal.address?.addressType || '',\r\n            localName: meal.address?.localName || '',\r\n            recipientName: meal.address?.recipientName || '',\r\n            unitDetails: meal.address?.unitDetails || ''\r\n          }\r\n        }));\r\n\r\n        updateDataBase = { ...updateDataBase, meals: updatedMealsForDB };\r\n        await updateDoc(doc(db, 'orders', editingOrder.id), updateDataBase);\r\n\r\n        logActivity(`Edit (almuerzo) el pedido ${editingOrder.id}`, {\r\n          orderId: editingOrder.id,\r\n          previousState,\r\n          newState: { ...editForm, meals: updatedMealsForDB }\r\n        });\r\n      }\r\n\r\n      setEditingOrder(null);\r\n      setSuccess('Pedido actualizado correctamente.');\r\n    } catch (error) {\r\n      setError(`Error al guardar: ${error.message}`);\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleDeleteOrder = async (orderId) => {\r\n    setIsLoading(true);\r\n    try {\r\n      const orderToDelete = orders.find((o) => o.id === orderId);\r\n      await deleteDoc(doc(db, orderToDelete.type === 'breakfast' ? 'deliveryBreakfastOrders' : 'orders', orderId));\r\n      setSuccess('Pedido eliminado correctamente.');\r\n      if (orderToDelete) {\r\n        logActivity(`Elimin el pedido con ID: ${orderId}`, {\r\n          orderId,\r\n          deletedOrderDetails: {\r\n            meals: orderToDelete.meals,\r\n            total: orderToDelete.total,\r\n            status: orderToDelete.status,\r\n            payment: orderToDelete.payment,\r\n            deliveryPerson: orderToDelete.deliveryPerson,\r\n            type: orderToDelete.type\r\n          }\r\n        });\r\n      } else {\r\n        logActivity(`Elimin el pedido con ID: ${orderId} (detalles no disponibles)`);\r\n      }\r\n    } catch (error) {\r\n      setError(`Error al eliminar: ${error.message}`);\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleDeleteAllOrders = async () => {\r\n    if (confirmText.toLowerCase() !== 'confirmar') {\r\n      setError('Por favor, escribe \"confirmar\" para proceder.');\r\n      return;\r\n    }\r\n    setIsLoading(true);\r\n    try {\r\n      const batch = writeBatch(db);\r\n      const ordersSnapshot = await getDocs(collection(db, 'orders'));\r\n      const breakfastOrdersSnapshot = await getDocs(collection(db, 'deliveryBreakfastOrders'));\r\n      ordersSnapshot.forEach((docRef) => batch.delete(docRef.ref));\r\n      breakfastOrdersSnapshot.forEach((docRef) => batch.delete(docRef.ref));\r\n      await batch.commit();\r\n      setShowConfirmDeleteAll(false);\r\n      setConfirmText('');\r\n      setSuccess('Todos los pedidos han sido eliminados.');\r\n      logActivity('Elimin todos los pedidos', { count: ordersSnapshot.size + breakfastOrdersSnapshot.size });\r\n    } catch (error) {\r\n      setError(`Error al eliminar todos los pedidos: ${error.message}`);\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleStatusChange = async (orderId, newStatus) => {\r\n    try {\r\n      const oldOrder = orders.find((o) => o.id === orderId);\r\n      const previousStatus = oldOrder ? oldOrder.status : 'Desconocido';\r\n      const collectionName = oldOrder.type === 'breakfast' ? 'deliveryBreakfastOrders' : 'orders';\r\n\r\n      await updateDoc(doc(db, collectionName, orderId), { status: newStatus, updatedAt: new Date() });\r\n\r\n      if (newStatus === 'Cancelado' && oldOrder && previousStatus !== 'Cancelado') {\r\n        const paymentType = cleanText(oldOrder.payment || 'Efectivo');\r\n        const amount = oldOrder.total || 0;\r\n        const deliveryPerson = cleanText(oldOrder.deliveryPerson || '');\r\n\r\n        setTotals((prev) => {\r\n          const newTotals = { ...prev };\r\n          if (paymentType.toLowerCase() === 'efectivo') {\r\n            newTotals.cash = Math.max(0, newTotals.cash - amount);\r\n          } else if (paymentType.toLowerCase() === 'daviplata') {\r\n            newTotals.daviplata = Math.max(0, newTotals.daviplata - amount);\r\n          } else if (paymentType.toLowerCase() === 'nequi') {\r\n            newTotals.nequi = Math.max(0, newTotals.nequi - amount);\r\n          }\r\n          return newTotals;\r\n        });\r\n\r\n        if (deliveryPerson && deliveryPerson !== 'Sin asignar') {\r\n          setDeliveryPersons((prev) => {\r\n            const newDeliveryPersons = { ...prev };\r\n            if (newDeliveryPersons[deliveryPerson]) {\r\n              const bucket = oldOrder.type === 'breakfast' ? 'desayuno' : 'almuerzo';\r\n              const person = { ...newDeliveryPersons[deliveryPerson] };\r\n              const b = {\r\n                ...(person[bucket] || { efectivo: 0, daviplata: 0, nequi: 0, total: 0 })\r\n              };\r\n\r\n              const pt = paymentType.toLowerCase();\r\n              if (pt === 'efectivo') b.efectivo = Math.max(0, (b.efectivo || 0) - amount);\r\n              else if (pt === 'daviplata') b.daviplata = Math.max(0, (b.daviplata || 0) - amount);\r\n              else if (pt === 'nequi') b.nequi = Math.max(0, (b.nequi || 0) - amount);\r\n              b.total = Math.max(0, (b.total || 0) - amount);\r\n\r\n              person[bucket] = b;\r\n              newDeliveryPersons[deliveryPerson] = person;\r\n\r\n              const remaining = (person.almuerzo?.total || 0) + (person.desayuno?.total || 0);\r\n              if (remaining === 0) delete newDeliveryPersons[deliveryPerson];\r\n            }\r\n            return newDeliveryPersons;\r\n          });\r\n        }\r\n      }\r\n\r\n      setSuccess('Estado actualizado correctamente.');\r\n      logActivity(`Actualiz el estado del pedido ${orderId} a: ${newStatus}`, {\r\n        orderId,\r\n        previousStatus,\r\n        newStatus\r\n      });\r\n    } catch (error) {\r\n      setError(`Error al actualizar estado: ${error.message}`);\r\n    }\r\n  };\r\n\r\n  const handleDeliveryChange = async (orderId, deliveryPerson) => {\r\n    try {\r\n      const oldOrder = orders.find((o) => o.id === orderId);\r\n      const collectionName = oldOrder.type === 'breakfast' ? 'deliveryBreakfastOrders' : 'orders';\r\n      const previousDeliveryPerson = oldOrder ? oldOrder.deliveryPerson : 'Desconocido';\r\n\r\n      await updateDoc(doc(db, collectionName, orderId), {\r\n        deliveryPerson: deliveryPerson || null,\r\n        updatedAt: new Date()\r\n      });\r\n      setEditingDeliveryId(null);\r\n      setSuccess('Domiciliario actualizado correctamente.');\r\n      logActivity(`Asign/Actualiz domiciliario para el pedido ${orderId} a: ${deliveryPerson || 'Sin asignar'}`, {\r\n        orderId,\r\n        previousDeliveryPerson,\r\n        newDeliveryPerson: deliveryPerson || 'Sin asignar'\r\n      });\r\n    } catch (error) {\r\n      setError(`Error al actualizar domiciliario: ${error.message}`);\r\n    }\r\n  };\r\n\r\n  const handleOpenPreview = () => {\r\n    const previewWindow = window.open('', '_blank');\r\n    previewWindow.document.write(generatePreviewHtml(filteredOrders, displayedTotals, deliveryPersons));\r\n    previewWindow.document.close();\r\n    logActivity('Abri la vista previa de pedidos (PDF)', { type: 'PDF Preview' });\r\n  };\r\n\r\n  const handleOpenExcelPreview = () => {\r\n    const previewWindow = window.open('', '_blank');\r\n    previewWindow.document.write(\r\n      generateExcelPreviewHtml(filteredOrders, displayedTotals, deliveryPersons, totalProteinUnits, proteins)\r\n    );\r\n    previewWindow.document.close();\r\n    logActivity('Abri la vista previa de pedidos (Excel)', { type: 'Excel Preview' });\r\n  };\r\n\r\n  const handleNewOrderFieldChange = (field, value) => {\r\n    setNewOrderForm((prev) => ({ ...prev, [field]: value }));\r\n  };\r\n\r\n  const handleNewOrderMealFormFieldChange = (mealIndex, field, value) => {\r\n    setNewOrderForm((prev) => {\r\n      const newMeals = [...prev.meals];\r\n      if (!newMeals[mealIndex]) {\r\n        newMeals[mealIndex] = { address: {}, payment: {}, time: {} };\r\n      }\r\n      if (field.includes('.')) {\r\n        const [parent, child] = field.split('.');\r\n        newMeals[mealIndex] = { ...newMeals[mealIndex], [parent]: { ...newMeals[mealIndex][parent], [child]: value } };\r\n      } else if (field === 'sides') {\r\n        newMeals[mealIndex] = {\r\n          ...newMeals[mealIndex],\r\n          sides: value\r\n            .split(',')\r\n            .map((s) => ({ name: s.trim() }))\r\n            .filter((s) => s.name)\r\n        };\r\n      } else if (field === 'additions') {\r\n        newMeals[mealIndex] = {\r\n          ...newMeals[mealIndex],\r\n          additions: value\r\n            .split(';')\r\n            .map((a) => {\r\n              const [name, proteinOrReplacement = '', quantity = '1'] = a.split(',');\r\n              return {\r\n                name: name.trim(),\r\n                [proteinOrReplacement.includes('por') ? 'replacement' : 'protein']: proteinOrReplacement.trim(),\r\n                quantity: Number(quantity) || 1\r\n              };\r\n            })\r\n            .filter((a) => a.name)\r\n        };\r\n      } else if (field === 'principle') {\r\n        newMeals[mealIndex] = {\r\n          ...newMeals[mealIndex],\r\n          principle: value\r\n            .split(',')\r\n            .map((p) => ({ name: p.trim() }))\r\n            .filter((p) => p.name)\r\n        };\r\n      } else {\r\n        newMeals[mealIndex] = { ...newMeals[mealIndex], [field]: value };\r\n      }\r\n      return { ...prev, meals: newMeals };\r\n    });\r\n  };\r\n\r\n  const handleAddOrderSubmit = async () => {\r\n    setIsLoading(true);\r\n    try {\r\n      const normalizedMeals = newOrderForm.meals.map((meal) => ({\r\n        ...meal,\r\n        soup: meal.soup ? { name: meal.soup } : null,\r\n        soupReplacement: meal.soupReplacement ? { name: meal.soupReplacement } : null,\r\n        principle: Array.isArray(meal.principle)\r\n          ? meal.principle.map((p) => ({ name: p.name || p }))\r\n          : meal.principle\r\n          ? [{ name: meal.principle }]\r\n          : [],\r\n        principleReplacement: meal.principleReplacement ? { name: meal.principleReplacement } : null,\r\n        protein: meal.protein ? { name: meal.protein } : null,\r\n        drink: meal.drink ? { name: meal.drink } : null,\r\n        cutlery: meal.cutlery ? { name: meal.cutlery } : null,\r\n        time: meal.time ? { name: meal.time } : null,\r\n        payment: newOrderForm.payment ? { name: newOrderForm.payment } : { name: 'Efectivo' },\r\n        sides: Array.isArray(meal.sides) ? meal.sides.map((s) => ({ name: s.name || s })) : [],\r\n        additions: Array.isArray(meal.additions)\r\n          ? meal.additions.map((a) => ({\r\n              name: a.name || '',\r\n              protein: a.protein || '',\r\n              replacement: a.replacement || '',\r\n              quantity: a.quantity || 1\r\n            }))\r\n          : []\r\n      }));\r\n\r\n      const paymentSummary = {\r\n        Efectivo: newOrderForm.payment === 'Efectivo' ? Number(newOrderForm.total) || 0 : 0,\r\n        Daviplata: newOrderForm.payment === 'Daviplata' ? Number(newOrderForm.total) || 0 : 0,\r\n        Nequi: newOrderForm.payment === 'Nequi' ? Number(newOrderForm.total) || 0 : 0\r\n      };\r\n\r\n      const orderData = {\r\n        ...newOrderForm,\r\n        meals: normalizedMeals,\r\n        total: Number(newOrderForm.total) || 0,\r\n        status: newOrderForm.status || 'Pendiente',\r\n        payment: newOrderForm.payment || 'Efectivo',\r\n        deliveryPerson: newOrderForm.deliveryPerson || 'Sin asignar',\r\n        paymentSummary,\r\n        createdAt: serverTimestamp(),\r\n        type: newOrderForm.type || 'lunch'\r\n      };\r\n\r\n      const collectionName = newOrderForm.type === 'breakfast' ? 'deliveryBreakfastOrders' : 'orders';\r\n      const docRef = await addDoc(collection(db, collectionName), orderData);\r\n      setSuccess('Orden agregada correctamente.');\r\n      logActivity(`Agreg una nueva orden (Total: $${newOrderForm.total.toLocaleString('es-CO')})`, {\r\n        orderId: docRef.id,\r\n        newOrderDetails: { ...newOrderForm, meals: normalizedMeals }\r\n      });\r\n      setShowAddOrderModal(false);\r\n      setNewOrderForm({\r\n        meals: [\r\n          {\r\n            soup: '',\r\n            soupReplacement: '',\r\n            principle: [{ name: '' }],\r\n            principleReplacement: '',\r\n            protein: '',\r\n            drink: '',\r\n            cutlery: '',\r\n            sides: [],\r\n            additions: [],\r\n            notes: '',\r\n            address: {\r\n              address: '',\r\n              phoneNumber: '',\r\n              addressType: '',\r\n              localName: '',\r\n              recipientName: ''\r\n            },\r\n            time: '',\r\n            payment: 'Efectivo'\r\n          }\r\n        ],\r\n        total: 0,\r\n        status: 'Pendiente',\r\n        payment: 'Efectivo',\r\n        deliveryPerson: 'Sin asignar',\r\n        type: 'lunch'\r\n      });\r\n    } catch (error) {\r\n      setError(`Error al agregar orden: ${error.message}`);\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  // Compat para el datalist de domiciliarios en TablaPedidos\r\n  const deliveryPersonsCompat = useMemo(() => {\r\n    const r = {};\r\n    for (const [person, data] of Object.entries(deliveryPersons || {})) {\r\n      const cash = (data?.almuerzo?.efectivo || 0) + (data?.desayuno?.efectivo || 0);\r\n      const daviplata = (data?.almuerzo?.daviplata || 0) + (data?.desayuno?.daviplata || 0);\r\n      const nequi = (data?.almuerzo?.nequi || 0) + (data?.desayuno?.nequi || 0);\r\n      const total = (data?.almuerzo?.total || 0) + (data?.desayuno?.total || 0);\r\n      r[person] = { cash, daviplata, nequi, total };\r\n    }\r\n    return r;\r\n  }, [deliveryPersons]);\r\n\r\n  const uniqueDeliveryPersons = useMemo(() => Object.keys(deliveryPersons || {}), [deliveryPersons]);\r\n\r\n  return (\r\n    <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6\">\r\n      <InteraccionesPedidos\r\n        theme={theme}\r\n        showProteinModal={showProteinModal}\r\n        setShowProteinModal={setShowProteinModal}\r\n        newProtein={newProtein}\r\n        setNewProtein={setNewProtein}\r\n        handleAddProtein={handleAddProtein}\r\n        proteins={proteins}\r\n        totalProteinUnits={totalProteinUnits}\r\n        isLoading={isLoading}\r\n        showMealDetails={showMealDetails}\r\n        setShowMealDetails={setShowMealDetails}\r\n        editingOrder={editingOrder}\r\n        setEditingOrder={setEditingOrder}\r\n        editForm={editForm}\r\n        handleMealFormFieldChange={handleEditOrderMealFormFieldChange}\r\n        handleEditFormFieldChange={handleEditFormFieldChange}\r\n        handleSaveEdit={handleSaveEdit}\r\n        showConfirmDeleteAll={showConfirmDeleteAll}\r\n        setShowConfirmDeleteAll={setShowConfirmDeleteAll}\r\n        confirmText={confirmText}\r\n        setConfirmText={setConfirmText}\r\n        handleDeleteAllOrders={handleDeleteAllOrders}\r\n        setError={setError}\r\n        setSuccess={setSuccess}\r\n        showAddOrderModal={showAddOrderModal}\r\n        setShowAddOrderModal={setShowAddOrderModal}\r\n        newOrderForm={newOrderForm}\r\n        handleNewOrderMealFormFieldChange={handleNewOrderMealFormFieldChange}\r\n        handleNewOrderFieldChange={handleNewOrderFieldChange}\r\n        handleAddOrderSubmit={handleAddOrderSubmit}\r\n        uniqueDeliveryPersons={uniqueDeliveryPersons}\r\n      />\r\n\r\n      <TablaPedidos\r\n        theme={theme}\r\n        orders={orders}\r\n        searchTerm={searchTerm}\r\n        setSearchTerm={setSearchTerm}\r\n        totals={displayedTotals}\r\n        isLoading={isLoading}\r\n        paginatedOrders={paginatedOrders}\r\n        currentPage={currentPage}\r\n        totalPages={totalPages}\r\n        setCurrentPage={setCurrentPage}\r\n        itemsPerPage={itemsPerPage}\r\n        setItemsPerPage={setItemsPerPage}\r\n        deliveryPersons={deliveryPersonsCompat}\r\n        handleEditOrder={handleEditOrder}\r\n        handleDeleteOrder={handleDeleteOrder}\r\n        handleStatusChange={handleStatusChange}\r\n        handleSort={handleSort}\r\n        getSortIcon={getSortIcon}\r\n        setShowMealDetails={setShowMealDetails}\r\n        editingDeliveryId={editingDeliveryId}\r\n        setEditingDeliveryId={setEditingDeliveryId}\r\n        editForm={editForm}\r\n        setEditForm={setEditForm}\r\n        handleDeliveryChange={handleDeliveryChange}\r\n        sortOrder={sortOrder}\r\n        showProteinModal={showProteinModal}\r\n        setShowProteinModal={setShowProteinModal}\r\n        isMenuOpen={isMenuOpen}\r\n        setIsMenuOpen={setIsMenuOpen}\r\n        handleOpenPreview={handleOpenPreview}\r\n        handleOpenExcelPreview={handleOpenExcelPreview}\r\n        handleExport={handleExport}\r\n        handleDeleteAllOrders={handleDeleteAllOrders}\r\n        setShowConfirmDeleteAll={setShowConfirmDeleteAll}\r\n        exportToExcel={exportToExcel}\r\n        exportToPDF={exportToPDF}\r\n        exportToCSV={exportToCSV}\r\n        setShowAddOrderModal={setShowAddOrderModal}\r\n        orderTypeFilter={orderTypeFilter}\r\n        setOrderTypeFilter={setOrderTypeFilter}\r\n        uniqueDeliveryPersons={uniqueDeliveryPersons}\r\n      />\r\n\r\n      {/*  Se elimin el bloque de \"Resumen por Domiciliarios\" aqu para evitar duplicados.\r\n          Ahora el resumen aparece SOLO dentro de TablaPedidos. */}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default OrderManagement;\r\n","//src/components/Admin/utilities/previewOrders.js\r\nexport const generatePreviewHtml = (orders, totals, deliveryPersons) => {\r\n  let mealCounter = 0;\r\n  const pedidosBody = orders.flatMap((order) => {\r\n    if (!order || !Array.isArray(order.meals) || order.meals.length === 0) return [];\r\n    return order.meals.filter(meal => meal).map((meal) => {\r\n      mealCounter += 1;\r\n      return [\r\n        mealCounter,\r\n        meal?.address?.address || '',\r\n        meal?.address?.phoneNumber || '',\r\n        `$${order.total?.toLocaleString('es-CO') || '0'}`,\r\n        order?.deliveryPerson || ''\r\n      ];\r\n    });\r\n  });\r\n\r\n  if (pedidosBody.length === 0) pedidosBody.push(Array(5).fill('-'));\r\n\r\n  const deliveryBody = Object.entries(deliveryPersons).map(([name, data]) => [\r\n    name || '',\r\n    `$${data.cash?.toLocaleString('es-CO') || '0'}`,\r\n    `$${data.daviplata?.toLocaleString('es-CO') || '0'}`,\r\n    `$${data.nequi?.toLocaleString('es-CO') || '0'}`,\r\n    `$${data.total?.toLocaleString('es-CO') || '0'}`\r\n  ]);\r\n\r\n  const now = new Date();\r\n  const dateStr = now.toLocaleDateString('es-CO');\r\n  const timeStr = now.toLocaleTimeString('es-CO', { hour: '2-digit', minute: '2-digit', hour12: true });\r\n\r\n  return `\r\n    <html>\r\n      <head>\r\n        <title>Previsualizacin de Pedidos</title>\r\n        <style>\r\n          body { margin: 0; padding: 20px; font-family: Arial, sans-serif; }\r\n          h1 { text-align: center; font-size: 24px; }\r\n          p.date { text-align: center; font-size: 12px; }\r\n          table { width: 100%; border-collapse: collapse; margin-top: 20px; }\r\n          th, td { padding: 8px; border: 1px solid black; }\r\n          th { background-color: #0066cc; color: white; font-weight: bold; }\r\n          td { text-align: left; }\r\n          td:nth-child(4) { text-align: right; }\r\n          tr:nth-child(even) { background-color: #f5f5f5; }\r\n          .totals-table { width: 50%; }\r\n          .delivery-table th:nth-child(n+2), .delivery-table td:nth-child(n+2) { text-align: right; }\r\n          .button-container { margin-top: 20px; text-align: center; }\r\n          .button { padding: 10px 20px; background-color: #0066cc; color: white; border: none; border-radius: 5px; cursor: pointer; margin: 5px; }\r\n          .button.print { background-color: #28a745; }\r\n          @media print {\r\n              .button-container { display: none; }\r\n          }\r\n        </style>\r\n      </head>\r\n      <body>\r\n        <h1>Gestin de Pedidos</h1>\r\n        <p class=\"date\">Fecha: ${dateStr} ${timeStr}</p>\r\n        <table>\r\n          <thead>\r\n            <tr>\r\n              <th>N</th>\r\n              <th>Direccin</th>\r\n              <th>Telfono</th>\r\n              <th>Total</th>\r\n              <th>Domiciliario</th>\r\n            </tr>\r\n          </thead>\r\n          <tbody>\r\n            ${pedidosBody.map(row => `\r\n              <tr>\r\n                <td>${row[0]}</td>\r\n                <td>${row[1]}</td>\r\n                <td>${row[2]}</td>\r\n                <td>${row[3]}</td>\r\n                <td>${row[4]}</td>\r\n              </tr>\r\n            `).join('')}\r\n          </tbody>\r\n        </table>\r\n        <h2 style=\"margin-top: 20px; font-size: 18px;\">Resumen de Totales</h2>\r\n        <table class=\"totals-table\">\r\n          <tbody>\r\n            <tr><td style=\"padding: 8px;\">Total Efectivo</td><td style=\"padding: 8px; text-align: right;\">${pedidosBody.length > 0 ? `$${totals.cash?.toLocaleString('es-CO') || '0'}` : '$0'}</td></tr>\r\n            <tr><td style=\"padding: 8px;\">Total Daviplata</td><td style=\"padding: 8px; text-align: right;\">${pedidosBody.length > 0 ? `$${totals.daviplata?.toLocaleString('es-CO') || '0'}` : '$0'}</td></tr>\r\n            <tr><td style=\"padding: 8px;\">Total Nequi</td><td style=\"padding: 8px; text-align: right;\">${pedidosBody.length > 0 ? `$${totals.nequi?.toLocaleString('es-CO') || '0'}` : '$0'}</td></tr>\r\n            <tr><td style=\"padding: 8px;\">Total General</td><td style=\"padding: 8px; text-align: right;\">${pedidosBody.length > 0 ? `$${(totals.cash + totals.daviplata + totals.nequi || 0).toLocaleString('es-CO')}` : '$0'}</td></tr>\r\n          </tbody>\r\n        </table>\r\n        <h2 style=\"margin-top: 20px; font-size: 18px;\">Resumen por Domiciliarios</h2>\r\n        <table class=\"delivery-table\">\r\n          <thead>\r\n            <tr>\r\n              <th>Domiciliario</th>\r\n              <th>Efectivo</th>\r\n              <th>Daviplata</th>\r\n              <th>Nequi</th>\r\n              <th>Total</th>\r\n            </tr>\r\n          </thead>\r\n          <tbody>\r\n            ${deliveryBody.map(row => `\r\n              <tr>\r\n                <td>${row[0]}</td>\r\n                <td>${row[1]}</td>\r\n                <td>${row[2]}</td>\r\n                <td>${row[3]}</td>\r\n                <td>${row[4]}</td>\r\n              </tr>\r\n            `).join('')}\r\n          </tbody>\r\n        </table>\r\n        <div class=\"button-container\">\r\n          <button class=\"button print\" onclick=\"window.print()\">Imprimir</button>\r\n          <button class=\"button\" onclick=\"window.close()\">Cerrar Previsualizacin</button>\r\n        </div>\r\n      </body>\r\n    </html>\r\n  `;\r\n};","//src/components/Admin/utilities/previewExcel.js\r\nexport const generateExcelPreviewHtml = (orders, totals, deliveryPersons, totalProteinUnits = 0, proteins = []) => {\r\n  let mealCounter = 0;\r\n  const pedidosBody = orders.map((order) => {\r\n    mealCounter += 1;\r\n    const meal = order.meals?.[0] || {};\r\n    const payment = order.payment?.name || order.payment || meal?.payment?.name || meal?.payment || 'Efectivo';\r\n\r\n    return [\r\n      mealCounter,\r\n      meal?.address?.address || '',\r\n      meal?.address?.phoneNumber || '',\r\n      `$${order.total?.toLocaleString('es-CO') || '0'}`,\r\n      payment,\r\n      order?.deliveryPerson || ''\r\n    ];\r\n  });\r\n\r\n  if (pedidosBody.length === 0) pedidosBody.push(Array(6).fill('-'));\r\n\r\n  const deliveryBody = Object.entries(deliveryPersons).map(([name, data]) => [\r\n    name || '',\r\n    `$${data.cash?.toLocaleString('es-CO') || '0'}`,\r\n    `$${data.daviplata?.toLocaleString('es-CO') || '0'}`,\r\n    `$${data.nequi?.toLocaleString('es-CO') || '0'}`,\r\n    `$${data.total?.toLocaleString('es-CO') || '0'}`\r\n  ]);\r\n\r\n  const proteinsBody = proteins.length === 0\r\n    ? [['-', '-']]\r\n    : proteins.map((protein, index) => {\r\n        const isPenultimate = index === proteins.length - 2;\r\n        const isLast = index === proteins.length - 1;\r\n        return [\r\n          protein.name || 'Sin nombre',\r\n          protein.quantity?.toLocaleString('es-CO') || '0',\r\n          isPenultimate ? 'TOTAL PROTENAS:' : isLast ? 'Fecha actual:' : '',\r\n          isPenultimate ? totalProteinUnits.toLocaleString('es-CO') : isLast ? new Date().toLocaleDateString('es-CO', { day: '2-digit', month: '2-digit', year: 'numeric' }) : ''\r\n        ];\r\n      });\r\n\r\n  // Se calculan los totales de forma precisa\r\n  const calculatedTotals = {\r\n    cash: totals.cash || 0,\r\n    daviplata: totals.daviplata || 0,\r\n    nequi: totals.nequi || 0\r\n  };\r\n  const totalGeneral = calculatedTotals.cash + calculatedTotals.daviplata + calculatedTotals.nequi;\r\n\r\n  return `\r\n    <html>\r\n      <head>\r\n        <title>Previsualizacin de Excel</title>\r\n        <style>\r\n          body { margin: 0; padding: 20px; font-family: Arial, sans-serif; }\r\n          h1 { text-align: center; font-size: 24px; }\r\n          table { width: 100%; border-collapse: collapse; }\r\n          th, td { padding: 8px; border: 1px solid black; }\r\n          th { background-color: #0066cc; color: white; font-weight: bold; text-align: center; font-size: 16px; }\r\n          td { text-align: left; vertical-align: middle; }\r\n          td:nth-child(4), td:nth-child(6) { text-align: right; }\r\n          tr:nth-child(even) { background-color: #f5f5f5; }\r\n          .totals-table { width: 50%; margin-left: auto; margin-right: auto; }\r\n\r\n          .proteins-container { width: auto; margin: 0 auto; max-width: 700px; }\r\n          .proteins-table {\r\n            border-collapse: collapse;\r\n            font-size: 14px;\r\n            width: 100%;\r\n            max-width: 700px;\r\n          }\r\n          .proteins-table th, .proteins-table td {\r\n            padding: 6px 12px;\r\n            border: 1px solid black;\r\n            white-space: nowrap;\r\n          }\r\n          .proteins-table th:nth-child(1), .proteins-table td:nth-child(1) { width: 160px; text-align: left; }\r\n          .proteins-table th:nth-child(2), .proteins-table td:nth-child(2) { width: 80px; text-align: right; }\r\n          .proteins-table th:nth-child(3), .proteins-table td:nth-child(3) { width: 220px; text-align: left; }\r\n\r\n          .delivery-table th { background-color: #0066cc; color: white; font-weight: bold; text-align: center; font-size: 16px; }\r\n          .delivery-table .green-header th { background-color: #28a745; }\r\n          .delivery-table td:nth-child(n+2) { text-align: right; }\r\n\r\n          .spacer { height: 16px; }\r\n          .button-container { margin-top: 20px; text-align: center; }\r\n          .button { padding: 10px 20px; background-color: #0066cc; color: white; border: none; border-radius: 5px; cursor: pointer; margin: 5px; }\r\n          .button.print { background-color: #28a745; }\r\n          @media print { .button-container { display: none; } }\r\n        </style>\r\n      </head>\r\n      <body>\r\n        <h1>Gestin de Pedidos</h1>\r\n        <div class=\"spacer\"></div>\r\n\r\n        <div class=\"proteins-container\">\r\n          <table class=\"proteins-table\" aria-label=\"Resumen de protenas\">\r\n            <thead>\r\n              <tr>\r\n                <th style=\"background-color: #0066cc; color: white; border: 1px solid black;\">Protena</th>\r\n                <th style=\"background-color: #0066cc; color: white; border: 1px solid black;\">Unidades</th>\r\n                <th style=\"background-color: #0066cc; color: white; border: 1px solid black;\"></th>\r\n              </tr>\r\n            </thead>\r\n            <tbody>\r\n              ${proteinsBody.map((row, index) => {\r\n                const thirdColumn = row[2] ? `\r\n                  <td style=\"padding: 0;\">\r\n                    <div style=\"display: flex; width: 100%; height: 100%;\">\r\n                      <div style=\"flex: 1; padding: 6px 12px; font-weight: bold; display: flex; align-items: center;\">${row[2]}</div>\r\n                      <div style=\"width: 1px; background-color: black;\"></div>\r\n                      <div style=\"flex: 1; padding: 6px 12px; display: flex; justify-content: flex-end; align-items: center; font-weight: ${row[2] === 'TOTAL PROTENAS:' ? 'bold' : 'normal'};\">${row[3]}</div>\r\n                    </div>\r\n                  </td>\r\n                ` : '<td style=\"border: none; background-color: white;\"></td>';\r\n\r\n                return `\r\n                  <tr>\r\n                    <td title=\"${row[0]}\">${row[0]}</td>\r\n                    <td style=\"text-align: right;\">${row[1]}</td>\r\n                    ${thirdColumn}\r\n                  </tr>\r\n                `;\r\n              }).join('')}\r\n            </tbody>\r\n          </table>\r\n        </div>\r\n\r\n        <div class=\"spacer\"></div><div class=\"spacer\"></div>\r\n\r\n        <table>\r\n          <thead>\r\n            <tr>\r\n              <th>N</th>\r\n              <th>Direccin</th>\r\n              <th>Telfono</th>\r\n              <th>Total</th>\r\n              <th>Mtodo de Pago</th>\r\n              <th>Domiciliario</th>\r\n            </tr>\r\n          </thead>\r\n          <tbody>\r\n            ${pedidosBody.map(row => `\r\n              <tr>\r\n                <td>${row[0]}</td>\r\n                <td>${row[1]}</td>\r\n                <td>${row[2]}</td>\r\n                <td>${row[3]}</td>\r\n                <td>${row[4]}</td>\r\n                <td>${row[5]}</td>\r\n              </tr>\r\n            `).join('')}\r\n          </tbody>\r\n        </table>\r\n\r\n        <div class=\"spacer\"></div><div class=\"spacer\"></div>\r\n\r\n        <table class=\"totals-table\">\r\n          <thead>\r\n            <tr><th colspan=\"2\">Resumen de Totales</th></tr>\r\n          </thead>\r\n          <tbody>\r\n            <tr><td>Total Efectivo</td><td style=\"text-align: right;\">$${calculatedTotals.cash.toLocaleString('es-CO')}</td></tr>\r\n            <tr><td>Total Daviplata</td><td style=\"text-align: right;\">$${calculatedTotals.daviplata.toLocaleString('es-CO')}</td></tr>\r\n            <tr><td>Total Nequi</td><td style=\"text-align: right;\">$${calculatedTotals.nequi.toLocaleString('es-CO')}</td></tr>\r\n            <tr><td>Total General</td><td style=\"text-align: right;\">$${totalGeneral.toLocaleString('es-CO')}</td></tr>\r\n          </tbody>\r\n        </table>\r\n\r\n        <div class=\"spacer\"></div><div class=\"spacer\"></div>\r\n\r\n        <table class=\"delivery-table\">\r\n          <thead>\r\n            <tr><th colspan=\"5\">Resumen por Domiciliarios</th></tr>\r\n            <tr class=\"green-header\">\r\n              <th>Domiciliario</th>\r\n              <th>Efectivo</th>\r\n              <th>Daviplata</th>\r\n              <th>Nequi</th>\r\n              <th>Total</th>\r\n            </tr>\r\n          </thead>\r\n          <tbody>\r\n            ${deliveryBody.map(row => `\r\n              <tr>\r\n                <td>${row[0]}</td>\r\n                <td>${row[1]}</td>\r\n                <td>${row[2]}</td>\r\n                <td>${row[3]}</td>\r\n                <td>${row[4]}</td>\r\n              </tr>\r\n            `).join('')}\r\n          </tbody>\r\n        </table>\r\n\r\n        <div class=\"button-container\">\r\n          <button class=\"button print\" onclick=\"window.print()\">Imprimir</button>\r\n          <button class=\"button\" onclick=\"window.close()\">Cerrar Previsualizacin</button>\r\n          <button class=\"button\" onclick=\"window.opener.postMessage('downloadExcel', '*')\">Descargar Excel</button>\r\n        </div>\r\n      </body>\r\n    </html>\r\n  `;\r\n};","// src/utils/classNames.js\r\nexport function classNames(...classes) {\r\n  return classes.filter(Boolean).join(' ');\r\n}"],"names":["toInt","v","n","Math","floor","Number","isFinite","normKey","s","toString","trim","toLowerCase","buildMethodOptions","catalogMethods","Array","isArray","length","names","map","m","name","label","filter","Boolean","from","Set","PaymentSplitEditor","_ref","theme","total","value","onChange","disabled","methods","useMemo","rows","setRows","useState","sanitized","r","_r$method","method","amount","note","useEffect","_r$method2","sum","reduce","acc","diff","ok","emit","next","handleChange","idx","key","val","i","_jsxs","className","classNames","children","_jsx","type","onClick","fill5050","half","rest","split3","a","b","c","setAllTo","e","target","min","step","placeholder","_","removeRow","addRow","unused","find","some","max","toLocaleString","abs","norm","normalizePaymentMethodKey","methodLike","raw","title","payment","t","includes","pickMethodLabel","extractOrderPayments","order","_order$meals$0$paymen","_order$meals","_order$meals$","_order$meals2","_order$meals2$","_order$breakfasts$0$p","_order$breakfasts","_order$breakfasts$","_order$breakfasts2","_order$breakfasts2$","_order$paymentMethod","payments","p","methodKey","rawLabel","legacySources","meals","paymentMethod","breakfasts","summarizePayments","paymentsRows","arguments","undefined","agg","asText","cash","push","nequi","daviplata","other","join","defaultPaymentsForOrder","sumPaymentsByMethod","orders","out","amt","isSalonOrder","_order$breakfasts5","_order$breakfasts5$","__collection","orderType","isCashSettled","_order$settlement","settlement","status","liquidated","cashSettled","settledAt","calcMethodTotalsAll","tableOrders","breakfastOrders","nequiTotal","daviplataTotal","cashSalon","cashClientesSettled","cashClientesPendiente","accumulate","list","o","davi","cashCaja","exportToExcel","async","totals","deliveryPersons","totalProteinUnits","proteins","_proteins","_proteins2","_proteins3","_proteins4","workbook","ExcelJS","worksheet","addWorksheet","cleanText","text","replace","String","applyThinBorder","cell","border","top","style","color","argb","left","bottom","right","proteinHeaderRow","lastRow","number","mergeCells","ourHeader","getCell","font","bold","fill","pattern","fgColor","alignment","horizontal","getRow","values","eachCell","colNumber","proteinData","quantity","extra","extraValue","slice","Date","getDate","padStart","getMonth","getFullYear","forEach","protein","index","numFmt","mealCounter","pedidos","_meal$payment","_meal$address","_meal$address2","meal","paymentValue","console","warn","id","N","Direccin","address","Telfono","phoneNumber","Total","MtodoDePago","Domiciliario","deliveryPerson","columns","width","pedidosHeaderRow","headerRow","pedido","resumenRow","resumenCell","row","resumenDomiciliariosRow","deliveryHeader","Object","entries","_ref2","data","buffer","xlsx","writeBuffer","blob","Blob","link","document","createElement","href","window","URL","createObjectURL","download","toISOString","body","appendChild","click","removeChild","error","alert","message","exportToPDF","_totals$cash","_totals$daviplata","_totals$nequi","doc","jsPDF","logoUrl","addImage","imgError","setFontSize","now","dateStr","toLocaleDateString","timeStr","toLocaleTimeString","hour","minute","hour12","pedidosBody","_order$payment","_order$total","autoTable","startY","head","styles","fontSize","cellPadding","overflow","headStyles","fillColor","textColor","fontStyle","lineWidth","lineColor","alternateRowStyles","columnStyles","cellWidth","halign","tableLineColor","tableLineWidth","didDrawPage","pageNumber","finalY","lastAutoTable","deliveryY","deliveryBody","_data$cash","_data$daviplata","_data$nequi","_data$total","save","split","exportToCSV","setSuccess","orderRows","flatMap","_meal$soup","_meal$principle","_meal$protein","_meal$drink","_meal$cutlery","_meal$sides","_meal$additions","_meal$time","_meal$address3","_meal$address4","_meal$address5","_meal$address6","soup","principle","drink","cutlery","sides","additions","replacement","notes","time","addressType","localName","recipientName","unitDetails","createdAt","seconds","updatedAt","totalsRows","deliveryRows","csvContent","url","revokeObjectURL","getAddressDisplay","display","sumPaymentsByDeliveryAndType","fallbackBuilder","ensureBucket","person","bucket","bump","obj","paymentsRowsFromOrder","fb","byType","byTotal","money","searchTerm","setSearchTerm","isLoading","paginatedOrders","currentPage","totalPages","setCurrentPage","itemsPerPage","setItemsPerPage","handleEditOrder","handleDeleteOrder","handleStatusChange","handleSort","getSortIcon","setShowMealDetails","editingDeliveryId","setEditingDeliveryId","editForm","setEditForm","handleDeliveryChange","sortOrder","showProteinModal","setShowProteinModal","isMenuOpen","setIsMenuOpen","handleOpenPreview","handleOpenExcelPreview","handleExport","handleDeleteAllOrders","setShowConfirmDeleteAll","setShowAddOrderModal","orderTypeFilter","setOrderTypeFilter","uniqueDeliveryPersons","currentDate","weekday","month","day","menuRef","useRef","deliveryDraft","setDeliveryDraft","lastAssignedRef","handleClickOutside","event","current","contains","addEventListener","removeEventListener","editingPaymentsOrder","setEditingPaymentsOrder","EXTRA_COLLECTIONS","findExistingOrderRef","Error","preferred","collectionName","guess","resolveCollectionName","orderedBase","candidates","indexOf","col","ref","db","getDoc","exists","totalsDisplay","resumen","resumenPersons","keys","sort","localeCompare","_Fragment","PlusIcon","EllipsisVerticalIcon","ArrowDownTrayIcon","colSpan","_order$meals2$$paymen","_order$breakfasts2$$p","_order$meals3","_order$meals3$","_order$breakfasts3","_order$breakfasts3$","_order$meals4","_order$meals4$","_order$meals4$$addres","_order$breakfasts4","_order$breakfasts4$","_order$breakfasts4$$a","displayNumber","addressDisplay","rawLegacy","paymentDisplay","statusClass","timeValue","displayTime","InformationCircleIcon","onKeyDown","valueToSave","onBlur","autoFocus","initial","PencilIcon","TrashIcon","prev","ChevronLeftIcon","ChevronRightIcon","buckets","lunch","breakfast","overall","handleSettle","log","payload","_p$method","updateDoc","code","msg","savePaymentsForOrder","normalizeName","byName","ensureAddress","_addr$address","_addr$phoneNumber","_ref3","_addr$addressType","_ref4","_addr$localName","_ref5","_addr$unitDetails","_ref6","_addr$recipientName","addr","fallback","_ref7","newProtein","setNewProtein","handleAddProtein","showMealDetails","editingOrder","setEditingOrder","handleMealFormFieldChange","handleEditFormFieldChange","handleSaveEdit","showConfirmDeleteAll","confirmText","setConfirmText","setError","showAddOrderModal","newOrderForm","handleNewOrderMealFormFieldChange","handleNewOrderFieldChange","handleAddOrderSubmit","soups","setSoups","soupReplacements","setSoupReplacements","principles","setPrinciples","menuProteins","setMenuProteins","drinks","setDrinks","setSides","setAdditions","paymentMethods","setPaymentMethods","breakfastEggs","setBreakfastEggs","breakfastBroths","setBreakfastBroths","breakfastRiceBread","setBreakfastRiceBread","breakfastDrinks","setBreakfastDrinks","breakfastAdditions","setBreakfastAdditions","breakfastTypes","setBreakfastTypes","breakfastProteins","setBreakfastProteins","editingProtein","setEditingProtein","mapSetter","listen","onSnapshot","collection","snap","docs","d","unsubs","u","handleBreakfastFormFieldChange","field","parent","child","handleBreakfastImmediate","hydratedOrderIdRef","React","fallbackAddress","computedTotal","calculateTotal","_b$time","broth","eggs","riceBread","full","_m$soupReplacement","_m$principleReplaceme","_m$time","arr","soupReplacement","principleReplacement","_ref8","_a$price","price","computed","mealsForDetails","calculateBreakfastPrice","Transition","show","as","Dialog","onClose","Child","enter","enterFrom","enterTo","leave","leaveFrom","leaveTo","Panel","Title","XMarkIcon","handleCancelEditProtein","isNaN","handleEditProtein","deleteDoc","proteinId","handleDeleteProtein","BreakfastOrderSummary","items","user","role","showSaveButton","OrderSummary","isTableOrder","isWaiterView","_row$time","_row$address","_row$address2","_row$address3","_row$address4","_row$address5","_row$address6","_row$address7","_row$address8","_row$address9","_row$time2","_row$address0","_row$address1","_row$address10","_row$address11","_row$address12","_row$address13","_row$address14","_row$address15","_row$address16","OptionSelector","emoji","options","selected","multiple","onImmediateSelect","sel","checked","showConfirmButton","selection","onConfirm","_ref9","mealIndex","_meal$address7","_meal$address8","_meal$address9","_ref0","setOrders","setTotals","setIsLoading","setDeliveryPersons","sortBy","setSortBy","setSortOrder","setProteins","setNewOrderForm","logActivity","useCallback","action","details","addDoc","timestamp","serverTimestamp","fetchOrders","latestLunch","latestBreakfast","recompute","merged","newTotals","general","newDeliveryPersons","paymentSummary","Efectivo","Daviplata","Nequi","almuerzo","efectivo","desayuno","paymentType","unsubLunch","snapshot","_meals$","_meals$$payment","unsubBreakfast","_data$breakfasts","_data$breakfasts$","_data$breakfasts$$pay","fetchProteins","today","proteinsColRef","query","where","unsubscribe","proteinsData","unsubscribeOrders","unsubscribeProteins","filteredOrders","_order$meals3$$paymen","_order$breakfasts3$$p","lowerSearchTerm","addrObj","phone","timeObj","displayedTotals","ps","sortedOrders","getValue","path","currentFilteredOrdersArray","startsWith","ts","toMillis","getTime","readPath","part","_value","endsWith","valueA","valueB","ceil","start","end","defaultAddress","batch","writeBatch","ordersSnapshot","getDocs","breakfastOrdersSnapshot","docRef","delete","commit","count","size","deliveryPersonsCompat","_data$almuerzo","_data$desayuno","_data$almuerzo2","_data$desayuno2","_data$almuerzo3","_data$desayuno3","_data$almuerzo4","_data$desayuno4","InteraccionesPedidos","date","proteinName","handleEditOrderMealFormFieldChange","newMeals","proteinOrReplacement","oldOrder","previousState","updateDataBase","updatedBreakfastsForDB","_b$address","_b$address2","_b$address3","_b$address4","_b$address5","_b$address6","orderId","newState","updatedMealsForDB","normalizedMeals","orderData","newOrderDetails","TablaPedidos","orderToDelete","deletedOrderDetails","newStatus","previousStatus","_person$almuerzo","_person$desayuno","pt","stroke","viewBox","strokeLinecap","strokeLinejoin","strokeWidth","previousDeliveryPerson","newDeliveryPerson","previewWindow","open","write","generatePreviewHtml","close","proteinsBody","_protein$quantity","isPenultimate","isLast","year","calculatedTotals","totalGeneral","thirdColumn","generateExcelPreviewHtml","exportFunction","format","_len","classes","_key"],"sourceRoot":""}